<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.53" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://mydocs.guoyaxue.top/codenotes/front_end/WebApi.html"><meta property="og:site_name" content="å°uã®å­¦ä¹ ç¬”è®°"><meta property="og:title" content="WebApi"><meta property="og:description" content="WebApi è¿™ä¸ªåªä½œä¸ºä¸€ä¸ªäº†è§£å°±å¯ä»¥äº† Canvas API æ¦‚è¿° å…ƒç´ ç”¨äºç”Ÿæˆå›¾åƒã€‚å®ƒæœ¬èº«å°±åƒä¸€ä¸ªç”»å¸ƒï¼ŒJavaScript é€šè¿‡æ“ä½œå®ƒçš„ APIï¼Œåœ¨ä¸Šé¢ç”Ÿæˆå›¾åƒã€‚å®ƒçš„åº•å±‚æ˜¯ä¸€ä¸ªä¸ªåƒç´ ï¼ŒåŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ªå¯ä»¥ç”¨ JavaScript æ“ä½œçš„ä½å›¾ï¼ˆbitmapï¼‰ã€‚ å®ƒä¸ SVG å›¾åƒçš„åŒºåˆ«åœ¨äºï¼Œæ˜¯è„šæœ¬è°ƒç”¨å„ç§æ–¹æ³•ç”Ÿæˆå›¾åƒï¼ŒSVG åˆ™æ˜¯ä¸€ä¸ª XML æ–‡ä»¶ï¼Œé€š..."><meta property="og:type" content="article"><meta property="og:updated_time" content="2023-08-07T06:20:51.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:tag" content="WebApi"><meta property="article:tag" content="å‰ç«¯"><meta property="article:modified_time" content="2023-08-07T06:20:51.000Z"><link rel="icon" href="/favicon.svg"><script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?ef5d300e271d63833a52446f97a78f7d";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
     </script><title>WebApi | å°uã®å­¦ä¹ ç¬”è®°</title><meta name="description" content="WebApi è¿™ä¸ªåªä½œä¸ºä¸€ä¸ªäº†è§£å°±å¯ä»¥äº† Canvas API æ¦‚è¿° å…ƒç´ ç”¨äºç”Ÿæˆå›¾åƒã€‚å®ƒæœ¬èº«å°±åƒä¸€ä¸ªç”»å¸ƒï¼ŒJavaScript é€šè¿‡æ“ä½œå®ƒçš„ APIï¼Œåœ¨ä¸Šé¢ç”Ÿæˆå›¾åƒã€‚å®ƒçš„åº•å±‚æ˜¯ä¸€ä¸ªä¸ªåƒç´ ï¼ŒåŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ªå¯ä»¥ç”¨ JavaScript æ“ä½œçš„ä½å›¾ï¼ˆbitmapï¼‰ã€‚ å®ƒä¸ SVG å›¾åƒçš„åŒºåˆ«åœ¨äºï¼Œæ˜¯è„šæœ¬è°ƒç”¨å„ç§æ–¹æ³•ç”Ÿæˆå›¾åƒï¼ŒSVG åˆ™æ˜¯ä¸€ä¸ª XML æ–‡ä»¶ï¼Œé€š...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style.e2ddb5bf.css" as="style" /><link rel="stylesheet" href="/assets/style.e2ddb5bf.css" />
    <link rel="modulepreload" href="/assets/app.c5b3201b.js"><link rel="modulepreload" href="/assets/WebApi.html.ef69f478.js"><link rel="modulepreload" href="/assets/_plugin-vue_export-helper.cdc0426e.js"><link rel="modulepreload" href="/assets/WebApi.html.618fecc3.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo" src="/site_logo.png" alt="å°uã®å­¦ä¹ ç¬”è®°"><!----><span class="site-name hide-in-pad">å°uã®å­¦ä¹ ç¬”è®°</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/quicknav/" class="nav-link" aria-label="å¿«é€Ÿå¯¼èˆª"><span class="icon iconfont icon-navigation"></span>å¿«é€Ÿå¯¼èˆª<!----></a></div><div class="nav-item hide-in-mobile"><a href="/blog/" class="nav-link" aria-label="åšå®¢ä¸»é¡µ"><span class="icon iconfont icon-blog"></span>åšå®¢ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a href="/codenotes/" class="nav-link active" aria-label="ä»£ç ç¬”è®°"><span class="icon iconfont icon-code"></span>ä»£ç ç¬”è®°<!----></a></div><div class="nav-item hide-in-mobile"><a href="/projects/" class="nav-link" aria-label="æŠ€æœ¯æ‚è°ˆ"><span class="icon iconfont icon-code"></span>æŠ€æœ¯æ‚è°ˆ<!----></a></div><div class="nav-item hide-in-mobile"><a href="/interview/" class="nav-link" aria-label="é¢è¯•"><span class="icon iconfont icon-code"></span>é¢è¯•<!----></a></div><div class="nav-item hide-in-mobile"><a href="/practice/" class="nav-link" aria-label="é¡¹ç›®å®æˆ˜"><span class="icon iconfont icon-code"></span>é¡¹ç›®å®æˆ˜<!----></a></div></nav><!--[--><!----><!--]--></div><div class="navbar-right"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://gitee.com/lizifan233/mydocs" target="_blank" rel="noopener noreferrer" aria-label="Gitee"><svg xmlns="http://www.w3.org/2000/svg" class="icon gitee-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="gitee icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm242.97-533.34H482.39a23.7 23.7 0 0 0-23.7 23.7l-.03 59.28c0 13.08 10.59 23.7 23.7 23.7h165.96a23.7 23.7 0 0 1 23.7 23.7v11.85a71.1 71.1 0 0 1-71.1 71.1H375.71a23.7 23.7 0 0 1-23.7-23.7V423.11a71.1 71.1 0 0 1 71.1-71.1h331.8a23.7 23.7 0 0 0 23.7-23.7l.06-59.25a23.73 23.73 0 0 0-23.7-23.73H423.11a177.78 177.78 0 0 0-177.78 177.75v331.83c0 13.08 10.62 23.7 23.7 23.7h349.62a159.99 159.99 0 0 0 159.99-159.99V482.33a23.7 23.7 0 0 0-23.7-23.7z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><form class="search-box" role="search"><input type="search" placeholder="æœç´¢æœ¬ç«™" autocomplete="off" spellcheck="false" value><!----></form><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-java"></span><span class="title">Java</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><span class="icon iconfont icon-html"></span><span class="title">å‰ç«¯</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/codenotes/front_end/HTML.html" class="nav-link sidebar-link sidebar-page" aria-label="HTML"><span class="icon iconfont icon-code"></span>HTML<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/codenotes/front_end/WebApi.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="WebApi"><span class="icon iconfont icon-code"></span>WebApi<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#webapi" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="WebApi"><!---->WebApi<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#canvas-api" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Canvas API"><!---->Canvas API<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#æ¦‚è¿°" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ¦‚è¿°"><!---->æ¦‚è¿°<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#canvas-api-ç»˜åˆ¶å›¾å½¢" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Canvas APIï¼šç»˜åˆ¶å›¾å½¢"><!---->Canvas APIï¼šç»˜åˆ¶å›¾å½¢<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#canvas-api-å›¾åƒå¤„ç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Canvas APIï¼šå›¾åƒå¤„ç†"><!---->Canvas APIï¼šå›¾åƒå¤„ç†<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#canvas-å…ƒç´ çš„æ–¹æ³•" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="&lt;canvas&gt; å…ƒç´ çš„æ–¹æ³•"><!---->&lt;canvas&gt; å…ƒç´ çš„æ–¹æ³•<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#canvas-ä½¿ç”¨å®ä¾‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Canvas ä½¿ç”¨å®ä¾‹"><!---->Canvas ä½¿ç”¨å®ä¾‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å‚è€ƒé“¾æ¥"><!---->å‚è€ƒé“¾æ¥<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‰ªè´´æ¿æ“ä½œ-clipboard-api-æ•™ç¨‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å‰ªè´´æ¿æ“ä½œ Clipboard API æ•™ç¨‹"><!---->å‰ªè´´æ¿æ“ä½œ Clipboard API æ•™ç¨‹<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#ç®€ä»‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç®€ä»‹"><!---->ç®€ä»‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#document-execcommand-æ–¹æ³•" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Document.execCommand() æ–¹æ³•"><!---->Document.execCommand() æ–¹æ³•<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å¼‚æ­¥-clipboard-api" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å¼‚æ­¥ Clipboard API"><!---->å¼‚æ­¥ Clipboard API<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#clipboard-å¯¹è±¡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Clipboard å¯¹è±¡"><!---->Clipboard å¯¹è±¡<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#copy-äº‹ä»¶-cut-äº‹ä»¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="copy äº‹ä»¶ï¼Œcut äº‹ä»¶"><!---->copy äº‹ä»¶ï¼Œcut äº‹ä»¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#paste-äº‹ä»¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="paste äº‹ä»¶"><!---->paste äº‹ä»¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å‚è€ƒé“¾æ¥"><!---->å‚è€ƒé“¾æ¥<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#fetch-api-æ•™ç¨‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Fetch API æ•™ç¨‹"><!---->Fetch API æ•™ç¨‹<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#åŸºæœ¬ç”¨æ³•" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åŸºæœ¬ç”¨æ³•"><!---->åŸºæœ¬ç”¨æ³•<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#response-å¯¹è±¡-å¤„ç†-http-å›åº”" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Response å¯¹è±¡ï¼šå¤„ç† HTTP å›åº”"><!---->Response å¯¹è±¡ï¼šå¤„ç† HTTP å›åº”<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#fetch-çš„ç¬¬äºŒä¸ªå‚æ•°-å®šåˆ¶-http-è¯·æ±‚" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="fetch()çš„ç¬¬äºŒä¸ªå‚æ•°ï¼šå®šåˆ¶ HTTP è¯·æ±‚"><!---->fetch()çš„ç¬¬äºŒä¸ªå‚æ•°ï¼šå®šåˆ¶ HTTP è¯·æ±‚<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#fetch-é…ç½®å¯¹è±¡çš„å®Œæ•´-api" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="fetch()é…ç½®å¯¹è±¡çš„å®Œæ•´ API"><!---->fetch()é…ç½®å¯¹è±¡çš„å®Œæ•´ API<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å–æ¶ˆfetch-è¯·æ±‚" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å–æ¶ˆfetch()è¯·æ±‚"><!---->å–æ¶ˆfetch()è¯·æ±‚<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥-2" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å‚è€ƒé“¾æ¥"><!---->å‚è€ƒé“¾æ¥<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#fontface-api" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="FontFace API"><!---->FontFace API<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#geolocation-api" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Geolocation API"><!---->Geolocation API<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#geolocation-å¯¹è±¡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Geolocation å¯¹è±¡"><!---->Geolocation å¯¹è±¡<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#coordinates-å¯¹è±¡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Coordinates å¯¹è±¡"><!---->Coordinates å¯¹è±¡<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥-3" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å‚è€ƒé“¾æ¥"><!---->å‚è€ƒé“¾æ¥<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#intersectionobserver" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="IntersectionObserver"><!---->IntersectionObserver<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#ç®€ä»‹-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç®€ä»‹"><!---->ç®€ä»‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#intersectionobserver-observe" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="IntersectionObserver.observe()"><!---->IntersectionObserver.observe()<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å®ä¾‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å®ä¾‹"><!---->å®ä¾‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥-4" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å‚è€ƒé“¾æ¥"><!---->å‚è€ƒé“¾æ¥<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#intl-relativetimeformat" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Intl.RelativeTimeFormat"><!---->Intl.RelativeTimeFormat<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#åŸºæœ¬ç”¨æ³•-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åŸºæœ¬ç”¨æ³•"><!---->åŸºæœ¬ç”¨æ³•<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#intl-relativetimeformat-prototype-format" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Intl.RelativeTimeFormat.prototype.format()"><!---->Intl.RelativeTimeFormat.prototype.format()<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#intl-relativetimeformat-prototype-formattoparts" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Intl.RelativeTimeFormat.prototype.formatToParts()"><!---->Intl.RelativeTimeFormat.prototype.formatToParts()<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥-5" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å‚è€ƒé“¾æ¥"><!---->å‚è€ƒé“¾æ¥<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#offline-åº”ç”¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Offline åº”ç”¨"><!---->Offline åº”ç”¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#page-lifecycle-api" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Page Lifecycle API"><!---->Page Lifecycle API<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ"><!---->ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å¸¸è§åœºæ™¯" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å¸¸è§åœºæ™¯"><!---->å¸¸è§åœºæ™¯<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#äº‹ä»¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="äº‹ä»¶"><!---->äº‹ä»¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#è·å–å½“å‰é˜¶æ®µ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è·å–å½“å‰é˜¶æ®µ"><!---->è·å–å½“å‰é˜¶æ®µ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#document-wasdiscarded" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="document.wasDiscarded"><!---->document.wasDiscarded<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥-6" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å‚è€ƒé“¾æ¥"><!---->å‚è€ƒé“¾æ¥<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#page-visibility-api" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Page Visibility API"><!---->Page Visibility API<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#ç®€ä»‹-2" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç®€ä»‹"><!---->ç®€ä»‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#document-visibilitystate" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="document.visibilityState"><!---->document.visibilityState<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#document-hidden" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="document.hidden"><!---->document.hidden<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#visibilitychange-äº‹ä»¶-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="visibilitychange äº‹ä»¶"><!---->visibilitychange äº‹ä»¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#é¡µé¢å¸è½½" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="é¡µé¢å¸è½½"><!---->é¡µé¢å¸è½½<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥-7" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å‚è€ƒé“¾æ¥"><!---->å‚è€ƒé“¾æ¥<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#point-lock-api" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Point lock API"><!---->Point lock API<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#server-sent-events" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Server-Sent Events"><!---->Server-Sent Events<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#ç®€ä»‹-3" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç®€ä»‹"><!---->ç®€ä»‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#ä¸-websocket-çš„æ¯”è¾ƒ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä¸ WebSocket çš„æ¯”è¾ƒ"><!---->ä¸ WebSocket çš„æ¯”è¾ƒ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å®¢æˆ·ç«¯-api" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å®¢æˆ·ç«¯ API"><!---->å®¢æˆ·ç«¯ API<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#æœåŠ¡å™¨å®ç°" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æœåŠ¡å™¨å®ç°"><!---->æœåŠ¡å™¨å®ç°<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#node-æœåŠ¡å™¨å®ä¾‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Node æœåŠ¡å™¨å®ä¾‹"><!---->Node æœåŠ¡å™¨å®ä¾‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥-8" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å‚è€ƒé“¾æ¥"><!---->å‚è€ƒé“¾æ¥<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#service-worker" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Service Worker"><!---->Service Worker<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å«ä¹‰" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å«ä¹‰"><!---->å«ä¹‰<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#ä½¿ç”¨æ­¥éª¤" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä½¿ç”¨æ­¥éª¤"><!---->ä½¿ç”¨æ­¥éª¤<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#service-worker-ä¸ç½‘é¡µçš„é€šä¿¡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Service Worker ä¸ç½‘é¡µçš„é€šä¿¡"><!---->Service Worker ä¸ç½‘é¡µçš„é€šä¿¡<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥-9" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å‚è€ƒé“¾æ¥"><!---->å‚è€ƒé“¾æ¥<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#svg-å›¾åƒ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="SVG å›¾åƒ"><!---->SVG å›¾åƒ<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#æ¦‚è¿°-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ¦‚è¿°"><!---->æ¦‚è¿°<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#è¯­æ³•" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è¯­æ³•"><!---->è¯­æ³•<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#javascript-æ“ä½œ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="JavaScript æ“ä½œ"><!---->JavaScript æ“ä½œ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å®ä¾‹-æŠ˜çº¿å›¾" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å®ä¾‹ï¼šæŠ˜çº¿å›¾"><!---->å®ä¾‹ï¼šæŠ˜çº¿å›¾<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥-10" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å‚è€ƒé“¾æ¥"><!---->å‚è€ƒé“¾æ¥<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#web-share-api" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Web Share API"><!---->Web Share API<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#æ¦‚è¿°-2" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ¦‚è¿°"><!---->æ¦‚è¿°<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#æ¥å£ç»†èŠ‚" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ¥å£ç»†èŠ‚"><!---->æ¥å£ç»†èŠ‚<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#åˆ†äº«æ–‡ä»¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åˆ†äº«æ–‡ä»¶"><!---->åˆ†äº«æ–‡ä»¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥-11" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å‚è€ƒé“¾æ¥"><!---->å‚è€ƒé“¾æ¥<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#web-audio-api" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Web Audio API"><!---->Web Audio API<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#åŸºæœ¬ç”¨æ³•-2" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åŸºæœ¬ç”¨æ³•"><!---->åŸºæœ¬ç”¨æ³•<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#context-createbuffer" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="context.createBuffer()"><!---->context.createBuffer()<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#è¿‡æ»¤å™¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è¿‡æ»¤å™¨"><!---->è¿‡æ»¤å™¨<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#web-components" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Web Components"><!---->Web Components<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#æ¦‚è¿°-3" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ¦‚è¿°"><!---->æ¦‚è¿°<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#custom-element" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Custom Element"><!---->Custom Element<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#template-æ ‡ç­¾" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="&lt;template&gt;æ ‡ç­¾"><!---->&lt;template&gt;æ ‡ç­¾<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#shadow-dom" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Shadow DOM"><!---->Shadow DOM<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#html-import" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="HTML Import"><!---->HTML Import<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#polymer-js" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Polymer.js"><!---->Polymer.js<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥-12" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å‚è€ƒé“¾æ¥"><!---->å‚è€ƒé“¾æ¥<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#websocket" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="WebSocket"><!---->WebSocket<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#ç®€ä»‹-5" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç®€ä»‹"><!---->ç®€ä»‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#websocket-æ¡æ‰‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="WebSocket æ¡æ‰‹"><!---->WebSocket æ¡æ‰‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å®¢æˆ·ç«¯çš„ç®€å•ç¤ºä¾‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å®¢æˆ·ç«¯çš„ç®€å•ç¤ºä¾‹"><!---->å®¢æˆ·ç«¯çš„ç®€å•ç¤ºä¾‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å®¢æˆ·ç«¯-api-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å®¢æˆ·ç«¯ API"><!---->å®¢æˆ·ç«¯ API<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#websocket-æœåŠ¡å™¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="WebSocket æœåŠ¡å™¨"><!---->WebSocket æœåŠ¡å™¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥-13" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å‚è€ƒé“¾æ¥"><!---->å‚è€ƒé“¾æ¥<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a href="/codenotes/front_end/ts.html" class="nav-link sidebar-link sidebar-page" aria-label="ä¸€æ–‡ææ‡‚TypeScript"><span class="icon iconfont icon-code"></span>ä¸€æ–‡ææ‡‚TypeScript<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/codenotes/front_end/2023ts.html" class="nav-link sidebar-link sidebar-page" aria-label="éƒ½2023å¹´äº†ä½ è¿˜ä¸å­¦tsï¼Ÿ"><span class="icon iconfont icon-code"></span>éƒ½2023å¹´äº†ä½ è¿˜ä¸å­¦tsï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-write"></span><span class="title">æ¸¡ä¸€å¤§å¸ˆè¯¾ç¬”è®°</span><span class="arrow right"></span></button><!----></section></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-ability"></span><span class="title">ç®—æ³•</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-python"></span><span class="title">python</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-workingDirectory"></span><span class="title">å…¶ä»–æŠ€æœ¯</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-linter"></span><span class="title">é€†å‘</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-linter"></span><span class="title">æ¨èä¹¦ç±</span><span class="arrow right"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><span class="icon iconfont icon-code"></span>WebApi</h1><div class="page-info"><span class="category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><ul class="categories-wrapper"><li><span class="category category7 clickable" role="navigation">WebApi</span></li><li><span class="category category6 clickable" role="navigation">å‰ç«¯</span></li></ul><meta property="articleSection" content="WebApi,å‰ç«¯"></span><span aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><ul class="tags-wrapper"><li><span class="tag tag7 clickable" role="navigation">WebApi</span></li><li><span class="tag tag6 clickable" role="navigation">å‰ç«¯</span></li></ul><meta property="keywords" content="WebApi,å‰ç«¯"></span><span class="reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 124 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT124M"></span><span class="date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-07-20T01:20:29.000Z"></span><span class="words-info" aria-label="å­—æ•°ğŸ” " data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>çº¦ 37113 å­—</span><meta property="wordCount" content="37113"></span><span class="author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="https://gitee.com/lizifan233/mydocs" target="_blank" rel="noopener noreferrer">Xiaou</a></span><span property="author" content="Xiaou"></span></span><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">æ­¤é¡µå†…å®¹</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#webapi" class="router-link-active router-link-exact-active toc-link level2">WebApi</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#canvas-api" class="router-link-active router-link-exact-active toc-link level2">Canvas API</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#æ¦‚è¿°" class="router-link-active router-link-exact-active toc-link level3">æ¦‚è¿°</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#canvas-api-ç»˜åˆ¶å›¾å½¢" class="router-link-active router-link-exact-active toc-link level3">Canvas APIï¼šç»˜åˆ¶å›¾å½¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#canvas-api-å›¾åƒå¤„ç†" class="router-link-active router-link-exact-active toc-link level3">Canvas APIï¼šå›¾åƒå¤„ç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#canvas-å…ƒç´ çš„æ–¹æ³•" class="router-link-active router-link-exact-active toc-link level3">&lt;canvas&gt; å…ƒç´ çš„æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#canvas-ä½¿ç”¨å®ä¾‹" class="router-link-active router-link-exact-active toc-link level3">Canvas ä½¿ç”¨å®ä¾‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥" class="router-link-active router-link-exact-active toc-link level3">å‚è€ƒé“¾æ¥</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‰ªè´´æ¿æ“ä½œ-clipboard-api-æ•™ç¨‹" class="router-link-active router-link-exact-active toc-link level2">å‰ªè´´æ¿æ“ä½œ Clipboard API æ•™ç¨‹</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#ç®€ä»‹" class="router-link-active router-link-exact-active toc-link level3">ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#document-execcommand-æ–¹æ³•" class="router-link-active router-link-exact-active toc-link level3">Document.execCommand() æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å¼‚æ­¥-clipboard-api" class="router-link-active router-link-exact-active toc-link level3">å¼‚æ­¥ Clipboard API</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#clipboard-å¯¹è±¡" class="router-link-active router-link-exact-active toc-link level3">Clipboard å¯¹è±¡</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#copy-äº‹ä»¶-cut-äº‹ä»¶" class="router-link-active router-link-exact-active toc-link level3">copy äº‹ä»¶ï¼Œcut äº‹ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#paste-äº‹ä»¶" class="router-link-active router-link-exact-active toc-link level3">paste äº‹ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥-1" class="router-link-active router-link-exact-active toc-link level3">å‚è€ƒé“¾æ¥</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#fetch-api-æ•™ç¨‹" class="router-link-active router-link-exact-active toc-link level2">Fetch API æ•™ç¨‹</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#åŸºæœ¬ç”¨æ³•" class="router-link-active router-link-exact-active toc-link level3">åŸºæœ¬ç”¨æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#response-å¯¹è±¡-å¤„ç†-http-å›åº”" class="router-link-active router-link-exact-active toc-link level3">Response å¯¹è±¡ï¼šå¤„ç† HTTP å›åº”</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#fetch-çš„ç¬¬äºŒä¸ªå‚æ•°-å®šåˆ¶-http-è¯·æ±‚" class="router-link-active router-link-exact-active toc-link level3">fetch()çš„ç¬¬äºŒä¸ªå‚æ•°ï¼šå®šåˆ¶ HTTP è¯·æ±‚</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#fetch-é…ç½®å¯¹è±¡çš„å®Œæ•´-api" class="router-link-active router-link-exact-active toc-link level3">fetch()é…ç½®å¯¹è±¡çš„å®Œæ•´ API</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å–æ¶ˆfetch-è¯·æ±‚" class="router-link-active router-link-exact-active toc-link level3">å–æ¶ˆfetch()è¯·æ±‚</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥-2" class="router-link-active router-link-exact-active toc-link level3">å‚è€ƒé“¾æ¥</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#fontface-api" class="router-link-active router-link-exact-active toc-link level2">FontFace API</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#geolocation-api" class="router-link-active router-link-exact-active toc-link level2">Geolocation API</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#geolocation-å¯¹è±¡" class="router-link-active router-link-exact-active toc-link level3">Geolocation å¯¹è±¡</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#coordinates-å¯¹è±¡" class="router-link-active router-link-exact-active toc-link level3">Coordinates å¯¹è±¡</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥-3" class="router-link-active router-link-exact-active toc-link level3">å‚è€ƒé“¾æ¥</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#intersectionobserver" class="router-link-active router-link-exact-active toc-link level2">IntersectionObserver</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#ç®€ä»‹-1" class="router-link-active router-link-exact-active toc-link level3">ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#intersectionobserver-observe" class="router-link-active router-link-exact-active toc-link level3">IntersectionObserver.observe()</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å®ä¾‹" class="router-link-active router-link-exact-active toc-link level3">å®ä¾‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥-4" class="router-link-active router-link-exact-active toc-link level3">å‚è€ƒé“¾æ¥</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#intl-relativetimeformat" class="router-link-active router-link-exact-active toc-link level2">Intl.RelativeTimeFormat</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#åŸºæœ¬ç”¨æ³•-1" class="router-link-active router-link-exact-active toc-link level3">åŸºæœ¬ç”¨æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#intl-relativetimeformat-prototype-format" class="router-link-active router-link-exact-active toc-link level3">Intl.RelativeTimeFormat.prototype.format()</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#intl-relativetimeformat-prototype-formattoparts" class="router-link-active router-link-exact-active toc-link level3">Intl.RelativeTimeFormat.prototype.formatToParts()</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥-5" class="router-link-active router-link-exact-active toc-link level3">å‚è€ƒé“¾æ¥</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#offline-åº”ç”¨" class="router-link-active router-link-exact-active toc-link level2">Offline åº”ç”¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#page-lifecycle-api" class="router-link-active router-link-exact-active toc-link level2">Page Lifecycle API</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ" class="router-link-active router-link-exact-active toc-link level3">ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å¸¸è§åœºæ™¯" class="router-link-active router-link-exact-active toc-link level3">å¸¸è§åœºæ™¯</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#äº‹ä»¶" class="router-link-active router-link-exact-active toc-link level3">äº‹ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#è·å–å½“å‰é˜¶æ®µ" class="router-link-active router-link-exact-active toc-link level3">è·å–å½“å‰é˜¶æ®µ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#document-wasdiscarded" class="router-link-active router-link-exact-active toc-link level3">document.wasDiscarded</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥-6" class="router-link-active router-link-exact-active toc-link level3">å‚è€ƒé“¾æ¥</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#page-visibility-api" class="router-link-active router-link-exact-active toc-link level2">Page Visibility API</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#ç®€ä»‹-2" class="router-link-active router-link-exact-active toc-link level3">ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#document-visibilitystate" class="router-link-active router-link-exact-active toc-link level3">document.visibilityState</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#document-hidden" class="router-link-active router-link-exact-active toc-link level3">document.hidden</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#visibilitychange-äº‹ä»¶-1" class="router-link-active router-link-exact-active toc-link level3">visibilitychange äº‹ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#é¡µé¢å¸è½½" class="router-link-active router-link-exact-active toc-link level3">é¡µé¢å¸è½½</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥-7" class="router-link-active router-link-exact-active toc-link level3">å‚è€ƒé“¾æ¥</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#point-lock-api" class="router-link-active router-link-exact-active toc-link level2">Point lock API</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#server-sent-events" class="router-link-active router-link-exact-active toc-link level2">Server-Sent Events</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#ç®€ä»‹-3" class="router-link-active router-link-exact-active toc-link level3">ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#ä¸-websocket-çš„æ¯”è¾ƒ" class="router-link-active router-link-exact-active toc-link level3">ä¸ WebSocket çš„æ¯”è¾ƒ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å®¢æˆ·ç«¯-api" class="router-link-active router-link-exact-active toc-link level3">å®¢æˆ·ç«¯ API</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#æœåŠ¡å™¨å®ç°" class="router-link-active router-link-exact-active toc-link level3">æœåŠ¡å™¨å®ç°</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#node-æœåŠ¡å™¨å®ä¾‹" class="router-link-active router-link-exact-active toc-link level3">Node æœåŠ¡å™¨å®ä¾‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥-8" class="router-link-active router-link-exact-active toc-link level3">å‚è€ƒé“¾æ¥</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#service-worker" class="router-link-active router-link-exact-active toc-link level2">Service Worker</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å«ä¹‰" class="router-link-active router-link-exact-active toc-link level3">å«ä¹‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#ä½¿ç”¨æ­¥éª¤" class="router-link-active router-link-exact-active toc-link level3">ä½¿ç”¨æ­¥éª¤</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#service-worker-ä¸ç½‘é¡µçš„é€šä¿¡" class="router-link-active router-link-exact-active toc-link level3">Service Worker ä¸ç½‘é¡µçš„é€šä¿¡</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥-9" class="router-link-active router-link-exact-active toc-link level3">å‚è€ƒé“¾æ¥</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#svg-å›¾åƒ" class="router-link-active router-link-exact-active toc-link level2">SVG å›¾åƒ</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#æ¦‚è¿°-1" class="router-link-active router-link-exact-active toc-link level3">æ¦‚è¿°</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#è¯­æ³•" class="router-link-active router-link-exact-active toc-link level3">è¯­æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#javascript-æ“ä½œ" class="router-link-active router-link-exact-active toc-link level3">JavaScript æ“ä½œ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å®ä¾‹-æŠ˜çº¿å›¾" class="router-link-active router-link-exact-active toc-link level3">å®ä¾‹ï¼šæŠ˜çº¿å›¾</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥-10" class="router-link-active router-link-exact-active toc-link level3">å‚è€ƒé“¾æ¥</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#web-share-api" class="router-link-active router-link-exact-active toc-link level2">Web Share API</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#æ¦‚è¿°-2" class="router-link-active router-link-exact-active toc-link level3">æ¦‚è¿°</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#æ¥å£ç»†èŠ‚" class="router-link-active router-link-exact-active toc-link level3">æ¥å£ç»†èŠ‚</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#åˆ†äº«æ–‡ä»¶" class="router-link-active router-link-exact-active toc-link level3">åˆ†äº«æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥-11" class="router-link-active router-link-exact-active toc-link level3">å‚è€ƒé“¾æ¥</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#web-audio-api" class="router-link-active router-link-exact-active toc-link level2">Web Audio API</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#åŸºæœ¬ç”¨æ³•-2" class="router-link-active router-link-exact-active toc-link level3">åŸºæœ¬ç”¨æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#context-createbuffer" class="router-link-active router-link-exact-active toc-link level3">context.createBuffer()</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#è¿‡æ»¤å™¨" class="router-link-active router-link-exact-active toc-link level3">è¿‡æ»¤å™¨</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#web-components" class="router-link-active router-link-exact-active toc-link level2">Web Components</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#æ¦‚è¿°-3" class="router-link-active router-link-exact-active toc-link level3">æ¦‚è¿°</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#custom-element" class="router-link-active router-link-exact-active toc-link level3">Custom Element</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#template-æ ‡ç­¾" class="router-link-active router-link-exact-active toc-link level3">&lt;template&gt;æ ‡ç­¾</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#shadow-dom" class="router-link-active router-link-exact-active toc-link level3">Shadow DOM</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#html-import" class="router-link-active router-link-exact-active toc-link level3">HTML Import</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#polymer-js" class="router-link-active router-link-exact-active toc-link level3">Polymer.js</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥-12" class="router-link-active router-link-exact-active toc-link level3">å‚è€ƒé“¾æ¥</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#websocket" class="router-link-active router-link-exact-active toc-link level2">WebSocket</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#ç®€ä»‹-5" class="router-link-active router-link-exact-active toc-link level3">ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#websocket-æ¡æ‰‹" class="router-link-active router-link-exact-active toc-link level3">WebSocket æ¡æ‰‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å®¢æˆ·ç«¯çš„ç®€å•ç¤ºä¾‹" class="router-link-active router-link-exact-active toc-link level3">å®¢æˆ·ç«¯çš„ç®€å•ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å®¢æˆ·ç«¯-api-1" class="router-link-active router-link-exact-active toc-link level3">å®¢æˆ·ç«¯ API</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#websocket-æœåŠ¡å™¨" class="router-link-active router-link-exact-active toc-link level3">WebSocket æœåŠ¡å™¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/codenotes/front_end/WebApi.html#å‚è€ƒé“¾æ¥-13" class="router-link-active router-link-exact-active toc-link level3">å‚è€ƒé“¾æ¥</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h2 id="webapi" tabindex="-1"><a class="header-anchor" href="#webapi" aria-hidden="true">#</a> WebApi</h2><p>è¿™ä¸ªåªä½œä¸ºä¸€ä¸ªäº†è§£å°±å¯ä»¥äº†</p><h2 id="canvas-api" tabindex="-1"><a class="header-anchor" href="#canvas-api" aria-hidden="true">#</a> Canvas API</h2><h3 id="æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#æ¦‚è¿°" aria-hidden="true">#</a> æ¦‚è¿°</h3><p><code>&lt;canvas&gt;</code>å…ƒç´ ç”¨äºç”Ÿæˆå›¾åƒã€‚å®ƒæœ¬èº«å°±åƒä¸€ä¸ªç”»å¸ƒï¼ŒJavaScript é€šè¿‡æ“ä½œå®ƒçš„ APIï¼Œåœ¨ä¸Šé¢ç”Ÿæˆå›¾åƒã€‚å®ƒçš„åº•å±‚æ˜¯ä¸€ä¸ªä¸ªåƒç´ ï¼ŒåŸºæœ¬ä¸Š<code>&lt;canvas&gt;</code>æ˜¯ä¸€ä¸ªå¯ä»¥ç”¨ JavaScript æ“ä½œçš„ä½å›¾ï¼ˆbitmapï¼‰ã€‚</p><p>å®ƒä¸ SVG å›¾åƒçš„åŒºåˆ«åœ¨äºï¼Œ<code>&lt;canvas&gt;</code>æ˜¯è„šæœ¬è°ƒç”¨å„ç§æ–¹æ³•ç”Ÿæˆå›¾åƒï¼ŒSVG åˆ™æ˜¯ä¸€ä¸ª XML æ–‡ä»¶ï¼Œé€šè¿‡å„ç§å­å…ƒç´ ç”Ÿæˆå›¾åƒã€‚</p><p>ä½¿ç”¨ Canvas API ä¹‹å‰ï¼Œéœ€è¦åœ¨ç½‘é¡µé‡Œé¢æ–°å»ºä¸€ä¸ª<code>&lt;canvas&gt;</code>å…ƒç´ ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myCanvas<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>400<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>250<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ Canvas
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœæµè§ˆå™¨ä¸æ”¯æŒè¿™ä¸ª APIï¼Œå°±ä¼šæ˜¾ç¤º<code>&lt;canvas&gt;</code>æ ‡ç­¾ä¸­é—´çš„æ–‡å­—ï¼šâ€œæ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ Canvasâ€ã€‚</p><p>æ¯ä¸ª<code>&lt;canvas&gt;</code>å…ƒç´ éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„<code>CanvasRenderingContext2D</code>å¯¹è±¡ï¼ˆä¸Šä¸‹æ–‡å¯¹è±¡ï¼‰ã€‚Canvas API å°±å®šä¹‰åœ¨è¿™ä¸ªå¯¹è±¡ä¸Šé¢ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>&lt;canvas&gt;</code>å…ƒç´ èŠ‚ç‚¹å¯¹è±¡çš„<code>getContext()</code>æ–¹æ³•ï¼Œè¿”å›çš„å°±æ˜¯<code>CanvasRenderingContext2D</code>å¯¹è±¡ã€‚</p><p>æ³¨æ„ï¼ŒCanvas API éœ€è¦<code>getContext</code>æ–¹æ³•æŒ‡å®šå‚æ•°<code>2d</code>ï¼Œè¡¨ç¤ºè¯¥<code>&lt;canvas&gt;</code>èŠ‚ç‚¹ç”Ÿæˆ 2D çš„å¹³é¢å›¾åƒã€‚å¦‚æœå‚æ•°æ˜¯<code>webgl</code>ï¼Œå°±è¡¨ç¤ºç”¨äºç”Ÿæˆ 3D çš„ç«‹ä½“å›¾æ¡ˆï¼Œè¿™éƒ¨åˆ†å±äº WebGL APIã€‚</p><p>æŒ‰ç…§ç”¨é€”ï¼ŒCanvas API åˆ†æˆä¸¤å¤§éƒ¨åˆ†ï¼šç»˜åˆ¶å›¾å½¢å’Œå›¾åƒå¤„ç†ã€‚</p><h3 id="canvas-api-ç»˜åˆ¶å›¾å½¢" tabindex="-1"><a class="header-anchor" href="#canvas-api-ç»˜åˆ¶å›¾å½¢" aria-hidden="true">#</a> Canvas APIï¼šç»˜åˆ¶å›¾å½¢</h3><p>Canvas ç”»å¸ƒæä¾›äº†ä¸€ä¸ªä½œå›¾çš„å¹³é¢ç©ºé—´ï¼Œè¯¥ç©ºé—´çš„æ¯ä¸ªç‚¹éƒ½æœ‰è‡ªå·±çš„åæ ‡ã€‚åŸç‚¹<code>(0, 0)</code>ä½äºå›¾åƒå·¦ä¸Šè§’ï¼Œ<code>x</code>è½´çš„æ­£å‘æ˜¯åŸç‚¹å‘å³ï¼Œ<code>y</code>è½´çš„æ­£å‘æ˜¯åŸç‚¹å‘ä¸‹ã€‚</p><h4 id="è·¯å¾„" tabindex="-1"><a class="header-anchor" href="#è·¯å¾„" aria-hidden="true">#</a> è·¯å¾„</h4><p>ä»¥ä¸‹æ–¹æ³•å’Œå±æ€§ç”¨æ¥ç»˜åˆ¶è·¯å¾„ã€‚</p><ul><li><code>CanvasRenderingContext2D.beginPath()</code>ï¼šå¼€å§‹ç»˜åˆ¶è·¯å¾„ã€‚</li><li><code>CanvasRenderingContext2D.closePath()</code>ï¼šç»“æŸè·¯å¾„ï¼Œè¿”å›åˆ°å½“å‰è·¯å¾„çš„èµ·å§‹ç‚¹ï¼Œä¼šä»å½“å‰ç‚¹åˆ°èµ·å§‹ç‚¹ç»˜åˆ¶ä¸€æ¡ç›´çº¿ã€‚å¦‚æœå›¾å½¢å·²ç»å°é—­ï¼Œæˆ–è€…åªæœ‰ä¸€ä¸ªç‚¹ï¼Œé‚£ä¹ˆæ­¤æ–¹æ³•ä¸ä¼šäº§ç”Ÿä»»ä½•æ•ˆæœã€‚</li><li><code>CanvasRenderingContext2D.moveTo()</code>ï¼šè®¾ç½®è·¯å¾„çš„èµ·ç‚¹ï¼Œå³å°†ä¸€ä¸ªæ–°è·¯å¾„çš„èµ·å§‹ç‚¹ç§»åŠ¨åˆ°<code>(xï¼Œy)</code>åæ ‡ã€‚</li><li><code>CanvasRenderingContext2D.lineTo()</code>ï¼šä½¿ç”¨ç›´çº¿ä»å½“å‰ç‚¹è¿æ¥åˆ°<code>(x, y)</code>åæ ‡ã€‚</li><li><code>CanvasRenderingContext2D.fill()</code>ï¼šåœ¨è·¯å¾„å†…éƒ¨å¡«å……é¢œè‰²ï¼ˆé»˜è®¤ä¸ºé»‘è‰²ï¼‰ã€‚</li><li><code>CanvasRenderingContext2D.stroke()</code>ï¼šè·¯å¾„çº¿æ¡ç€è‰²ï¼ˆé»˜è®¤ä¸ºé»‘è‰²ï¼‰ã€‚</li><li><code>CanvasRenderingContext2D.fillStyle</code>ï¼šæŒ‡å®šè·¯å¾„å¡«å……çš„é¢œè‰²å’Œæ ·å¼ï¼ˆé»˜è®¤ä¸ºé»‘è‰²ï¼‰ã€‚</li><li><code>CanvasRenderingContext2D.strokeStyle</code>ï¼šæŒ‡å®šè·¯å¾„çº¿æ¡çš„é¢œè‰²å’Œæ ·å¼ï¼ˆé»˜è®¤ä¸ºé»‘è‰²ï¼‰ã€‚</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç åªæ˜¯ç¡®å®šäº†è·¯å¾„çš„å½¢çŠ¶ï¼Œç”»å¸ƒä¸Šè¿˜çœ‹ä¸å‡ºæ¥ï¼Œå› ä¸ºæ²¡æœ‰é¢œè‰²ã€‚æ‰€ä»¥è¿˜éœ€è¦ç€è‰²ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// æˆ–è€…</span>
ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•éƒ½å¯ä»¥ä½¿å¾—è·¯å¾„å¯è§ã€‚<code>fill()</code>åœ¨è·¯å¾„å†…éƒ¨å¡«å……é¢œè‰²ï¼Œä½¿ä¹‹å˜æˆä¸€ä¸ªå®å¿ƒçš„å›¾å½¢ï¼›<code>stroke()</code>åªå¯¹è·¯å¾„çº¿æ¡ç€è‰²ã€‚</p><p>è¿™ä¸¤ä¸ªæ–¹æ³•é»˜è®¤éƒ½æ˜¯ä½¿ç”¨é»‘è‰²ï¼Œå¯ä»¥ä½¿ç”¨<code>fillStyle</code>å’Œ<code>strokeStyle</code>å±æ€§æŒ‡å®šå…¶ä»–é¢œè‰²ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&#39;red&#39;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// æˆ–è€…</span>
ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">&#39;red&#39;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç å°†å¡«å……å’Œçº¿æ¡çš„é¢œè‰²æŒ‡å®šä¸ºçº¢è‰²ã€‚</p><h4 id="çº¿å‹" tabindex="-1"><a class="header-anchor" href="#çº¿å‹" aria-hidden="true">#</a> çº¿å‹</h4><p>ä»¥ä¸‹çš„æ–¹æ³•å’Œå±æ€§æ§åˆ¶çº¿æ¡çš„è§†è§‰ç‰¹å¾ã€‚</p><ul><li><code>CanvasRenderingContext2D.lineWidth</code>ï¼šæŒ‡å®šçº¿æ¡çš„å®½åº¦ï¼Œé»˜è®¤ä¸º1.0ã€‚</li><li><code>CanvasRenderingContext2D.lineCap</code>ï¼šæŒ‡å®šçº¿æ¡æœ«ç«¯çš„æ ·å¼ï¼Œæœ‰ä¸‰ä¸ªå¯èƒ½çš„å€¼ï¼š<code>butt</code>ï¼ˆé»˜è®¤å€¼ï¼Œæœ«ç«¯ä¸ºçŸ©å½¢ï¼‰ã€<code>round</code>ï¼ˆæœ«ç«¯ä¸ºåœ†å½¢ï¼‰ã€<code>square</code>ï¼ˆæœ«ç«¯ä¸ºçªå‡ºçš„çŸ©å½¢ï¼ŒçŸ©å½¢å®½åº¦ä¸å˜ï¼Œé«˜åº¦ä¸ºçº¿æ¡å®½åº¦çš„ä¸€åŠï¼‰ã€‚</li><li><code>CanvasRenderingContext2D.lineJoin</code>ï¼šæŒ‡å®šçº¿æ®µäº¤ç‚¹çš„æ ·å¼ï¼Œæœ‰ä¸‰ä¸ªå¯èƒ½çš„å€¼ï¼š<code>round</code>ï¼ˆäº¤ç‚¹ä¸ºæ‰‡å½¢ï¼‰ã€<code>bevel</code>ï¼ˆäº¤ç‚¹ä¸ºä¸‰è§’å½¢åº•è¾¹ï¼‰ã€<code>miter</code>ï¼ˆé»˜è®¤å€¼ï¼Œäº¤ç‚¹ä¸ºè±å½¢)ã€‚</li><li><code>CanvasRenderingContext2D.miterLimit</code>ï¼šæŒ‡å®šäº¤ç‚¹è±å½¢çš„é•¿åº¦ï¼Œé»˜è®¤ä¸º10ã€‚è¯¥å±æ€§åªåœ¨<code>lineJoin</code>å±æ€§çš„å€¼ç­‰äº<code>miter</code>æ—¶æœ‰æ•ˆã€‚</li><li><code>CanvasRenderingContext2D.getLineDash()</code>ï¼šè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œè¡¨ç¤ºè™šçº¿é‡Œé¢çº¿æ®µå’Œé—´è·çš„é•¿åº¦ã€‚</li><li><code>CanvasRenderingContext2D.setLineDash()</code>ï¼šæ•°ç»„ï¼Œç”¨äºæŒ‡å®šè™šçº¿é‡Œé¢çº¿æ®µå’Œé—´è·çš„é•¿åº¦ã€‚</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>lineCap <span class="token operator">=</span> <span class="token string">&#39;round&#39;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>lineJoin <span class="token operator">=</span> <span class="token string">&#39;round&#39;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">setLineDash</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œçº¿æ¡çš„å®½åº¦ä¸º3ï¼Œçº¿æ¡çš„æœ«ç«¯å’Œäº¤ç‚¹éƒ½æ”¹æˆåœ†è§’ï¼Œå¹¶ä¸”è®¾ç½®ä¸ºè™šçº¿ã€‚</p><h4 id="çŸ©å½¢" tabindex="-1"><a class="header-anchor" href="#çŸ©å½¢" aria-hidden="true">#</a> çŸ©å½¢</h4><p>ä»¥ä¸‹æ–¹æ³•ç”¨æ¥ç»˜åˆ¶çŸ©å½¢ã€‚</p><ul><li><code>CanvasRenderingContext2D.rect()</code>ï¼šç»˜åˆ¶çŸ©å½¢è·¯å¾„ã€‚</li><li><code>CanvasRenderingContext2D.fillRect()</code>ï¼šå¡«å……ä¸€ä¸ªçŸ©å½¢ã€‚</li><li><code>CanvasRenderingContext2D.strokeRect()</code>ï¼šç»˜åˆ¶çŸ©å½¢è¾¹æ¡†ã€‚</li><li><code>CanvasRenderingContext2D.clearRect()</code>ï¼šæŒ‡å®šçŸ©å½¢åŒºåŸŸçš„åƒç´ éƒ½å˜æˆé€æ˜ã€‚</li></ul><p>ä¸Šé¢å››ä¸ªæ–¹æ³•çš„æ ¼å¼éƒ½ä¸€æ ·ï¼Œéƒ½æ¥å—å››ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯çŸ©å½¢å·¦ä¸Šè§’çš„æ¨ªåæ ‡å’Œçºµåæ ‡ã€çŸ©å½¢çš„å®½å’Œé«˜ã€‚</p><p><code>CanvasRenderingContext2D.rect()</code>æ–¹æ³•ç”¨äºç»˜åˆ¶çŸ©å½¢è·¯å¾„ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span><span class="token function">rect</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ç»˜åˆ¶ä¸€ä¸ªæ­£æ–¹å½¢ï¼Œå·¦ä¸Šè§’åæ ‡ä¸º<code>(10, 10)</code>ï¼Œå®½å’Œé«˜éƒ½ä¸º100ã€‚</p><p><code>CanvasRenderingContext2D.fillRect()</code>ç”¨æ¥å‘ä¸€ä¸ªçŸ©å½¢åŒºåŸŸå¡«å……é¢œè‰²ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&#39;green&#39;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ç»˜åˆ¶ä¸€ä¸ªç»¿è‰²çš„æ­£æ–¹å½¢ï¼Œå·¦ä¸Šè§’åæ ‡ä¸º<code>(10, 10)</code>ï¼Œå®½å’Œé«˜éƒ½ä¸º100ã€‚</p><p><code>CanvasRenderingContext2D.strokeRect()</code>ç”¨æ¥ç»˜åˆ¶ä¸€ä¸ªçŸ©å½¢åŒºåŸŸçš„è¾¹æ¡†ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">&#39;green&#39;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">strokeRect</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ç»˜åˆ¶ä¸€ä¸ªç»¿è‰²çš„ç©ºå¿ƒæ­£æ–¹å½¢ï¼Œå·¦ä¸Šè§’åæ ‡ä¸º<code>(10, 10)</code>ï¼Œå®½å’Œé«˜éƒ½ä¸º100ã€‚</p><p><code>CanvasRenderingContext2D.clearRect()</code>ç”¨äºæ“¦é™¤æŒ‡å®šçŸ©å½¢åŒºåŸŸçš„åƒç´ é¢œè‰²ï¼Œç­‰åŒäºæŠŠæ—©å…ˆçš„ç»˜åˆ¶æ•ˆæœéƒ½å»é™¤ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç å…ˆç»˜åˆ¶ä¸€ä¸ª 100 x 100 çš„æ­£æ–¹å½¢ï¼Œç„¶ååœ¨å®ƒçš„å†…éƒ¨æ“¦é™¤ 90 x 90 çš„åŒºåŸŸï¼Œç­‰åŒäºå½¢æˆäº†ä¸€ä¸ª5åƒç´ å®½åº¦çš„è¾¹æ¡†ã€‚</p><h4 id="å¼§çº¿" tabindex="-1"><a class="header-anchor" href="#å¼§çº¿" aria-hidden="true">#</a> å¼§çº¿</h4><p>ä»¥ä¸‹æ–¹æ³•ç”¨äºç»˜åˆ¶å¼§å½¢ã€‚</p><ul><li><code>CanvasRenderingContext2D.arc()</code>ï¼šé€šè¿‡æŒ‡å®šåœ†å¿ƒå’ŒåŠå¾„ç»˜åˆ¶å¼§å½¢ã€‚</li><li><code>CanvasRenderingContext2D.arcTo()</code>ï¼šé€šè¿‡æŒ‡å®šä¸¤æ ¹åˆ‡çº¿å’ŒåŠå¾„ç»˜åˆ¶å¼§å½¢ã€‚</li></ul><p><code>CanvasRenderingContext2D.arc()</code>ä¸»è¦ç”¨æ¥ç»˜åˆ¶åœ†å½¢æˆ–æ‰‡å½¢ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// æ ¼å¼</span>
ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> radius<span class="token punctuation">,</span> startAngle<span class="token punctuation">,</span> endAngle<span class="token punctuation">,</span> anticlockwise<span class="token punctuation">)</span>

<span class="token comment">// å®ä¾‹</span>
ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>arc()</code>æ–¹æ³•çš„<code>x</code>å’Œ<code>y</code>å‚æ•°æ˜¯åœ†å¿ƒåæ ‡ï¼Œ<code>radius</code>æ˜¯åŠå¾„ï¼Œ<code>startAngle</code>å’Œ<code>endAngle</code>åˆ™æ˜¯æ‰‡å½¢çš„èµ·å§‹è§’åº¦å’Œç»ˆæ­¢è§’åº¦ï¼ˆä»¥å¼§åº¦è¡¨ç¤ºï¼‰ï¼Œ<code>anticlockwise</code>è¡¨ç¤ºåšå›¾æ—¶åº”è¯¥é€†æ—¶é’ˆç”»ï¼ˆ<code>true</code>ï¼‰è¿˜æ˜¯é¡ºæ—¶é’ˆç”»ï¼ˆ<code>false</code>ï¼‰ï¼Œè¿™ä¸ªå‚æ•°ç”¨æ¥æ§åˆ¶æ‰‡å½¢çš„æ–¹å‘ï¼ˆæ¯”å¦‚ä¸ŠåŠåœ†è¿˜æ˜¯ä¸‹åŠåœ†ï¼‰ã€‚</p><p>ä¸‹é¢æ˜¯ç»˜åˆ¶å®å¿ƒåœ†å½¢çš„ä¾‹å­ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ç»˜åˆ¶äº†ä¸€ä¸ªåŠå¾„50ï¼Œèµ·å§‹è§’åº¦ä¸º0ï¼Œç»ˆæ­¢è§’åº¦ä¸º 2 * PI çš„å®Œæ•´çš„åœ†ã€‚</p><p>ç»˜åˆ¶ç©ºå¿ƒåŠåœ†çš„ä¾‹å­ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>CanvasRenderingContext2D.arcTo()</code>æ–¹æ³•ä¸»è¦ç”¨æ¥ç»˜åˆ¶åœ†å¼§ï¼Œéœ€è¦ç»™å‡ºä¸¤ä¸ªç‚¹çš„åæ ‡ï¼Œå½“å‰ç‚¹ä¸ç¬¬ä¸€ä¸ªç‚¹å½¢æˆä¸€æ¡ç›´çº¿ï¼Œç¬¬ä¸€ä¸ªç‚¹ä¸ç¬¬äºŒä¸ªç‚¹å½¢æˆå¦ä¸€æ¡ç›´çº¿ï¼Œç„¶åç”»å‡ºä¸è¿™ä¸¤æ ¹ç›´çº¿ç›¸åˆ‡çš„å¼§çº¿ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">arcTo</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>arcTo()</code>æœ‰5ä¸ªå‚æ•°ï¼Œå‰ä¸¤ä¸ªå‚æ•°æ˜¯ç¬¬ä¸€ä¸ªç‚¹çš„åæ ‡ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°å’Œç¬¬å››ä¸ªå‚æ•°æ˜¯ç¬¬äºŒä¸ªç‚¹çš„åæ ‡ï¼Œç¬¬äº”ä¸ªå‚æ•°æ˜¯åŠå¾„ã€‚ç„¶åï¼Œ<code>(0, 0)</code>ä¸<code>(50, 50)</code>å½¢æˆä¸€æ¡ç›´çº¿ï¼Œç„¶å<code>(50, 50)</code>ä¸<code>(100, 0)</code>å½¢æˆç¬¬äºŒæ¡ç›´çº¿ã€‚å¼§çº¿å°±æ˜¯ä¸è¿™ä¸¤æ ¹ç›´çº¿ç›¸åˆ‡çš„éƒ¨åˆ†ã€‚</p><h4 id="æ–‡æœ¬" tabindex="-1"><a class="header-anchor" href="#æ–‡æœ¬" aria-hidden="true">#</a> æ–‡æœ¬</h4><p>ä»¥ä¸‹æ–¹æ³•å’Œå±æ€§ç”¨äºç»˜åˆ¶æ–‡æœ¬ã€‚</p><ul><li><code>CanvasRenderingContext2D.fillText()</code>ï¼šåœ¨æŒ‡å®šä½ç½®ç»˜åˆ¶å®å¿ƒå­—ç¬¦ã€‚</li><li><code>CanvasRenderingContext2D.strokeText()</code>ï¼šåœ¨æŒ‡å®šä½ç½®ç»˜åˆ¶ç©ºå¿ƒå­—ç¬¦ã€‚</li><li><code>CanvasRenderingContext2D.measureText()</code>ï¼šè¿”å›ä¸€ä¸ª TextMetrics å¯¹è±¡ã€‚</li><li><code>CanvasRenderingContext2D.font</code>ï¼šæŒ‡å®šå­—å‹å¤§å°å’Œå­—ä½“ï¼Œé»˜è®¤å€¼ä¸º<code>10px sans-serif</code>ã€‚</li><li><code>CanvasRenderingContext2D.textAlign</code>ï¼šæ–‡æœ¬çš„å¯¹é½æ–¹å¼ï¼Œé»˜è®¤å€¼ä¸º<code>start</code>ã€‚</li><li><code>CanvasRenderingContext2D.direction</code>ï¼šæ–‡æœ¬çš„æ–¹å‘ï¼Œé»˜è®¤å€¼ä¸º<code>inherit</code>ã€‚</li><li><code>CanvasRenderingContext2D.textBaseline</code>ï¼šæ–‡æœ¬çš„å‚ç›´ä½ç½®ï¼Œé»˜è®¤å€¼ä¸º<code>alphabetic</code>ã€‚</li></ul><p><code>fillText()</code>æ–¹æ³•ç”¨æ¥åœ¨æŒ‡å®šä½ç½®ç»˜åˆ¶å®å¿ƒå­—ç¬¦ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>CanvasRenderingContext2D<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y <span class="token punctuation">[</span><span class="token punctuation">,</span> maxWidth<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>è¯¥æ–¹æ³•æ¥å—å››ä¸ªå‚æ•°ã€‚</p><ul><li><code>text</code>ï¼šæ‰€è¦å¡«å……çš„å­—ç¬¦ä¸²ã€‚</li><li><code>x</code>ï¼šæ–‡å­—èµ·ç‚¹çš„æ¨ªåæ ‡ï¼Œå•ä½åƒç´ ã€‚</li><li><code>y</code>ï¼šæ–‡å­—èµ·ç‚¹çš„çºµåæ ‡ï¼Œå•ä½åƒç´ ã€‚</li><li><code>maxWidth</code>ï¼šæ–‡æœ¬çš„æœ€å¤§åƒç´ å®½åº¦ã€‚è¯¥å‚æ•°å¯é€‰ï¼Œå¦‚æœçœç•¥ï¼Œåˆ™è¡¨ç¤ºå®½åº¦æ²¡æœ‰é™åˆ¶ã€‚å¦‚æœæ–‡æœ¬å®é™…é•¿åº¦è¶…è¿‡è¿™ä¸ªå‚æ•°æŒ‡å®šçš„å€¼ï¼Œé‚£ä¹ˆæµè§ˆå™¨å°†å°è¯•ç”¨è¾ƒå°çš„å­—ä½“å¡«å……ã€‚</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span><span class="token string">&#39;Hello world&#39;</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç åœ¨<code>(50, 50)</code>ä½ç½®å†™å…¥å­—ç¬¦ä¸²<code>Hello world</code>ã€‚</p><p>æ³¨æ„ï¼Œ<code>fillText()</code>æ–¹æ³•ä¸æ”¯æŒæ–‡æœ¬æ–­è¡Œï¼Œæ‰€æœ‰æ–‡æœ¬ä¸€å®šå‡ºç°åœ¨ä¸€è¡Œå†…ã€‚å¦‚æœè¦ç”Ÿæˆå¤šè¡Œæ–‡æœ¬ï¼Œåªæœ‰è°ƒç”¨å¤šæ¬¡<code>fillText()</code>æ–¹æ³•ã€‚</p><p><code>strokeText()</code>æ–¹æ³•ç”¨æ¥æ·»åŠ ç©ºå¿ƒå­—ç¬¦ï¼Œå®ƒçš„å‚æ•°ä¸<code>fillText()</code>ä¸€è‡´ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span><span class="token function">strokeText</span><span class="token punctuation">(</span><span class="token string">&#39;Hello world&#39;</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢è¿™ä¸¤ç§æ–¹æ³•ç»˜åˆ¶çš„æ–‡æœ¬ï¼Œé»˜è®¤éƒ½æ˜¯<code>10px</code>å¤§å°ã€<code>sans-serif</code>å­—ä½“ï¼Œ<code>font</code>å±æ€§å¯ä»¥æ”¹å˜å­—ä½“è®¾ç½®ã€‚è¯¥å±æ€§çš„å€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½¿ç”¨ CSS çš„<code>font</code>å±æ€§å³å¯ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token string">&#39;Bold 20px Arial&#39;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span><span class="token string">&#39;Hello world&#39;</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>textAlign</code>å±æ€§ç”¨æ¥æŒ‡å®šæ–‡æœ¬çš„å¯¹é½æ–¹å¼ã€‚å®ƒå¯ä»¥å–ä»¥ä¸‹å‡ ä¸ªå€¼ã€‚</p><ul><li><code>left</code>ï¼šå·¦å¯¹é½</li><li><code>right</code>ï¼šå³å¯¹é½</li><li><code>center</code>ï¼šå±…ä¸­</li><li><code>start</code>ï¼šé»˜è®¤å€¼ï¼Œèµ·ç‚¹å¯¹é½ï¼ˆä»å·¦åˆ°å³çš„æ–‡æœ¬ä¸ºå·¦å¯¹é½ï¼Œä»å³åˆ°å·¦çš„æ–‡æœ¬ä¸ºå³å¯¹é½ï¼‰ã€‚</li><li><code>end</code>ï¼šç»“å°¾å¯¹é½ï¼ˆä»å·¦åˆ°å³çš„æ–‡æœ¬ä¸ºå³å¯¹é½ï¼Œä»å³åˆ°å·¦çš„æ–‡æœ¬ä¸ºå·¦å¯¹é½ï¼‰ã€‚</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token string">&#39;Bold 20px Arial&#39;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> <span class="token string">&#39;center&#39;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span><span class="token string">&#39;Hello world&#39;</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>direction</code>å±æ€§æŒ‡å®šæ–‡æœ¬çš„æ–¹å‘ï¼Œé»˜è®¤å€¼ä¸º<code>inherit</code>ï¼Œè¡¨ç¤ºç»§æ‰¿<code>&lt;canvas&gt;</code>æˆ–<code>document</code>çš„è®¾ç½®ã€‚å…¶ä»–å€¼åŒ…æ‹¬<code>ltr</code>ï¼ˆä»å·¦åˆ°å³ï¼‰å’Œ<code>rtl</code>ï¼ˆä»å³åˆ°å·¦ï¼‰ã€‚</p><p><code>textBaseline</code>å±æ€§æŒ‡å®šæ–‡æœ¬çš„å‚ç›´ä½ç½®ï¼Œå¯ä»¥å–ä»¥ä¸‹å€¼ã€‚</p><ul><li><code>top</code>ï¼šä¸Šéƒ¨å¯¹é½ï¼ˆå­—æ¯çš„åŸºçº¿æ˜¯æ•´ä½“ä¸Šç§»ï¼‰ã€‚</li><li><code>hanging</code>ï¼šæ‚¬æŒ‚å¯¹é½ï¼ˆå­—æ¯çš„ä¸Šæ²¿åœ¨ä¸€æ ¹ç›´çº¿ä¸Šï¼‰ï¼Œé€‚ç”¨äºå°åº¦æ–‡å’Œè—æ–‡ã€‚</li><li><code>middle</code>ï¼šä¸­éƒ¨å¯¹é½ï¼ˆå­—æ¯çš„ä¸­çº¿åœ¨ä¸€æ ¹ç›´çº¿ä¸Šï¼‰ã€‚</li><li><code>alphabetic</code>ï¼šé»˜è®¤å€¼ï¼Œè¡¨ç¤ºå­—æ¯ä½äºå­—æ¯è¡¨çš„æ­£å¸¸ä½ç½®ï¼ˆå››çº¿æ ¼çš„ç¬¬ä¸‰æ ¹çº¿ï¼‰ã€‚</li><li><code>ideographic</code>ï¼šä¸‹æ²¿å¯¹é½ï¼ˆå­—æ¯çš„ä¸‹æ²¿åœ¨ä¸€æ ¹ç›´çº¿ä¸Šï¼‰ï¼Œä½¿ç”¨äºä¸œäºšæ–‡å­—ã€‚</li><li><code>bottom</code>ï¼šåº•éƒ¨å¯¹é½ï¼ˆå­—æ¯çš„åŸºçº¿ä¸‹ç§»ï¼‰ã€‚å¯¹äºè‹±æ–‡å­—æ¯ï¼Œè¿™ä¸ªè®¾ç½®ä¸<code>ideographic</code>æ²¡æœ‰å·®å¼‚ã€‚</li></ul><p><code>measureText()</code>æ–¹æ³•æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ª TextMetrics å¯¹è±¡ï¼Œå¯ä»¥ä»è¿™ä¸ªå¯¹è±¡ä¸Šé¢è·å–å‚æ•°å­—ç¬¦ä¸²çš„ä¿¡æ¯ï¼Œç›®å‰ä¸»è¦æ˜¯æ–‡æœ¬æ¸²æŸ“åçš„å®½åº¦ï¼ˆ<code>width</code>ï¼‰ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> text1 <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">measureText</span><span class="token punctuation">(</span><span class="token string">&#39;Hello world&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
text1<span class="token punctuation">.</span>width <span class="token comment">// 49.46</span>

ctx<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token string">&#39;Bold 20px Arial&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> text2 <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">measureText</span><span class="token punctuation">(</span><span class="token string">&#39;Hello world&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
text2<span class="token punctuation">.</span>width <span class="token comment">// 107.78</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>10px</code>å¤§å°çš„å­—ç¬¦ä¸²<code>Hello world</code>ï¼Œæ¸²æŸ“åå®½åº¦ä¸º<code>49.46</code>ã€‚æ”¾å¤§åˆ°<code>20px</code>ä»¥åï¼Œå®½åº¦ä¸º<code>107.78</code>ã€‚</p><h4 id="æ¸å˜è‰²å’Œå›¾åƒå¡«å……" tabindex="-1"><a class="header-anchor" href="#æ¸å˜è‰²å’Œå›¾åƒå¡«å……" aria-hidden="true">#</a> æ¸å˜è‰²å’Œå›¾åƒå¡«å……</h4><p>ä»¥ä¸‹æ–¹æ³•ç”¨äºè®¾ç½®æ¸å˜æ•ˆæœå’Œå›¾åƒå¡«å……æ•ˆæœã€‚</p><ul><li><code>CanvasRenderingContext2D.createLinearGradient()</code>ï¼šå®šä¹‰çº¿æ€§æ¸å˜æ ·å¼ã€‚</li><li><code>CanvasRenderingContext2D.createRadialGradient()</code>ï¼šå®šä¹‰è¾å°„æ¸å˜æ ·å¼ã€‚</li><li><code>CanvasRenderingContext2D.createPattern()</code>ï¼šå®šä¹‰å›¾åƒå¡«å……æ ·å¼ã€‚</li></ul><p><code>createLinearGradient()</code>æ–¹æ³•æŒ‰ç…§ç»™å®šç›´çº¿ï¼Œç”Ÿæˆçº¿æ€§æ¸å˜çš„æ ·å¼ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>ctx<span class="token punctuation">.</span><span class="token function">createLinearGradient</span><span class="token punctuation">(</span>x0<span class="token punctuation">,</span> y0<span class="token punctuation">,</span> x1<span class="token punctuation">,</span> y1<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>ctx.createLinearGradient(x0, y0, x1, y1)</code>æ–¹æ³•æ¥å—å››ä¸ªå‚æ•°ï¼š<code>x0</code>å’Œ<code>y0</code>æ˜¯èµ·ç‚¹çš„æ¨ªåæ ‡å’Œçºµåæ ‡ï¼Œ<code>x1</code>å’Œ<code>y1</code>æ˜¯ç»ˆç‚¹çš„æ¨ªåæ ‡å’Œçºµåæ ‡ã€‚é€šè¿‡ä¸åŒçš„åæ ‡å€¼ï¼Œå¯ä»¥ç”Ÿæˆä»ä¸Šè‡³ä¸‹ã€ä»å·¦åˆ°å³çš„æ¸å˜ç­‰ç­‰ã€‚</p><p>è¯¥æ–¹æ³•çš„è¿”å›å€¼æ˜¯ä¸€ä¸ª<code>CanvasGradient</code>å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åªæœ‰ä¸€ä¸ª<code>addColorStop()</code>æ–¹å‘ï¼Œç”¨æ¥æŒ‡å®šæ¸å˜ç‚¹çš„é¢œè‰²ã€‚<code>addColorStop()</code>æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯0åˆ°1ä¹‹é—´çš„ä¸€ä¸ªä½ç½®é‡ï¼Œ0è¡¨ç¤ºèµ·ç‚¹ï¼Œ1è¡¨ç¤ºç»ˆç‚¹ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤º CSS é¢œè‰²ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> gradient <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">createLinearGradient</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
gradient<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&#39;green&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
gradient<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;white&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> gradient<span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå®šä¹‰äº†æ¸å˜æ ·å¼<code>gradient</code>ä»¥åï¼Œå°†è¿™ä¸ªæ ·å¼æŒ‡å®šç»™<code>fillStyle</code>å±æ€§ï¼Œç„¶å<code>fillRect()</code>å°±ä¼šç”Ÿæˆä»¥è¿™ä¸ªæ ·å¼å¡«å……çš„çŸ©å½¢åŒºåŸŸã€‚</p><p><code>createRadialGradient()</code>æ–¹æ³•å®šä¹‰ä¸€ä¸ªè¾å°„æ¸å˜ï¼Œéœ€è¦æŒ‡å®šä¸¤ä¸ªåœ†ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>ctx<span class="token punctuation">.</span><span class="token function">createRadialGradient</span><span class="token punctuation">(</span>x0<span class="token punctuation">,</span> y0<span class="token punctuation">,</span> r0<span class="token punctuation">,</span> x1<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> r1<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>createRadialGradient()</code>æ–¹æ³•æ¥å—å…­ä¸ªå‚æ•°ï¼Œ<code>x0</code>å’Œ<code>y0</code>æ˜¯è¾å°„èµ·å§‹çš„åœ†çš„åœ†å¿ƒåæ ‡ï¼Œ<code>r0</code>æ˜¯èµ·å§‹åœ†çš„åŠå¾„ï¼Œ<code>x1</code>å’Œ<code>y1</code>æ˜¯è¾å°„ç»ˆæ­¢çš„åœ†çš„åœ†å¿ƒåæ ‡ï¼Œ<code>r1</code>æ˜¯ç»ˆæ­¢åœ†çš„åŠå¾„ã€‚</p><p>è¯¥æ–¹æ³•çš„è¿”å›å€¼ä¹Ÿæ˜¯ä¸€ä¸ª<code>CanvasGradient</code>å¯¹è±¡ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> gradient <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">createRadialGradient</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
gradient<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&#39;white&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
gradient<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;green&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> gradient<span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œç”Ÿæˆè¾å°„æ ·å¼ä»¥åï¼Œç”¨è¿™ä¸ªæ ·å¼å¡«å……ä¸€ä¸ªçŸ©å½¢ã€‚</p><p><code>createPattern()</code>æ–¹æ³•å®šä¹‰ä¸€ä¸ªå›¾åƒå¡«å……æ ·å¼ï¼Œåœ¨æŒ‡å®šæ–¹å‘ä¸Šä¸æ–­é‡å¤è¯¥å›¾åƒï¼Œå¡«å……æŒ‡å®šçš„åŒºåŸŸã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>ctx<span class="token punctuation">.</span><span class="token function">createPattern</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> repetition<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>è¯¥æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å›¾åƒæ•°æ®ï¼Œå®ƒå¯ä»¥æ˜¯<code>&lt;img&gt;</code>å…ƒç´ ï¼Œä¹Ÿå¯ä»¥æ˜¯å¦ä¸€ä¸ª<code>&lt;canvas&gt;</code>å…ƒç´ ï¼Œæˆ–è€…ä¸€ä¸ªè¡¨ç¤ºå›¾åƒçš„ Blob å¯¹è±¡ã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæœ‰å››ä¸ªå¯èƒ½çš„å€¼ï¼Œåˆ†åˆ«æ˜¯<code>repeat</code>ï¼ˆåŒå‘é‡å¤ï¼‰ã€<code>repeat-x</code>(æ°´å¹³é‡å¤)ã€<code>repeat-y</code>(å‚ç›´é‡å¤)ã€<code>no-repeat</code>(ä¸é‡å¤)ã€‚å¦‚æœç¬¬äºŒä¸ªå‚æ•°æ˜¯ç©ºå­—ç¬¦ä¸²æˆ–<code>null</code>ï¼Œåˆ™ç­‰åŒäº<code>null</code>ã€‚</p><p>è¯¥æ–¹æ³•çš„è¿”å›å€¼æ˜¯ä¸€ä¸ª<code>CanvasPattern</code>å¯¹è±¡ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
img<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">&#39;https://example.com/pattern.png&#39;</span><span class="token punctuation">;</span>
img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> pattern <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">createPattern</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token string">&#39;repeat&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> pattern<span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå›¾åƒåŠ è½½æˆåŠŸä»¥åï¼Œä½¿ç”¨<code>createPattern()</code>ç”Ÿæˆå›¾åƒæ ·å¼ï¼Œç„¶åä½¿ç”¨è¿™ä¸ªæ ·å¼å¡«å……æŒ‡å®šåŒºåŸŸã€‚</p><h4 id="é˜´å½±" tabindex="-1"><a class="header-anchor" href="#é˜´å½±" aria-hidden="true">#</a> é˜´å½±</h4><p>ä»¥ä¸‹å±æ€§ç”¨äºè®¾ç½®é˜´å½±ã€‚</p><ul><li><code>CanvasRenderingContext2D.shadowBlur</code>ï¼šé˜´å½±çš„æ¨¡ç³Šç¨‹åº¦ï¼Œé»˜è®¤ä¸º<code>0</code>ã€‚</li><li><code>CanvasRenderingContext2D.shadowColor</code>ï¼šé˜´å½±çš„é¢œè‰²ï¼Œé»˜è®¤ä¸º<code>black</code>ã€‚</li><li><code>CanvasRenderingContext2D.shadowOffsetX</code>ï¼šé˜´å½±çš„æ°´å¹³ä½ç§»ï¼Œé»˜è®¤ä¸º<code>0</code>ã€‚</li><li><code>CanvasRenderingContext2D.shadowOffsetY</code>ï¼šé˜´å½±çš„å‚ç›´ä½ç§»ï¼Œé»˜è®¤ä¸º<code>0</code>ã€‚</li></ul><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span>shadowOffsetX <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>shadowOffsetY <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>shadowBlur <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>shadowColor <span class="token operator">=</span> <span class="token string">&#39;rgba(0,0,0,0.5)&#39;</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&#39;green&#39;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="canvas-api-å›¾åƒå¤„ç†" tabindex="-1"><a class="header-anchor" href="#canvas-api-å›¾åƒå¤„ç†" aria-hidden="true">#</a> Canvas APIï¼šå›¾åƒå¤„ç†</h3><h4 id="canvasrenderingcontext2d-drawimage" tabindex="-1"><a class="header-anchor" href="#canvasrenderingcontext2d-drawimage" aria-hidden="true">#</a> CanvasRenderingContext2D.drawImage()</h4><p>Canvas API å…è®¸å°†å›¾åƒæ–‡ä»¶å†™å…¥ç”»å¸ƒï¼Œåšæ³•æ˜¯è¯»å–å›¾ç‰‡åï¼Œä½¿ç”¨<code>drawImage()</code>æ–¹æ³•å°†è¿™å¼ å›¾ç‰‡æ”¾ä¸Šç”»å¸ƒã€‚</p><p><code>CanvasRenderingContext2D.drawImage()</code>æœ‰ä¸‰ç§ä½¿ç”¨æ ¼å¼ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> dx<span class="token punctuation">,</span> dy<span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> dx<span class="token punctuation">,</span> dy<span class="token punctuation">,</span> dWidth<span class="token punctuation">,</span> dHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> sx<span class="token punctuation">,</span> sy<span class="token punctuation">,</span> sWidth<span class="token punctuation">,</span> sHeight<span class="token punctuation">,</span> dx<span class="token punctuation">,</span> dy<span class="token punctuation">,</span> dWidth<span class="token punctuation">,</span> dHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å„ä¸ªå‚æ•°çš„å«ä¹‰å¦‚ä¸‹ã€‚</p><ul><li>imageï¼šå›¾åƒå…ƒç´ </li><li>sxï¼šå›¾åƒå†…éƒ¨çš„æ¨ªåæ ‡ï¼Œç”¨äºæ˜ å°„åˆ°ç”»å¸ƒçš„æ”¾ç½®ç‚¹ä¸Šã€‚</li><li>syï¼šå›¾åƒå†…éƒ¨çš„çºµåæ ‡ï¼Œç”¨äºæ˜ å°„åˆ°ç”»å¸ƒçš„æ”¾ç½®ç‚¹ä¸Šã€‚</li><li>sWidthï¼šå›¾åƒåœ¨ç”»å¸ƒä¸Šçš„å®½åº¦ï¼Œä¼šäº§ç”Ÿç¼©æ”¾æ•ˆæœã€‚å¦‚æœæœªæŒ‡å®šï¼Œåˆ™å›¾åƒä¸ä¼šç¼©æ”¾ï¼ŒæŒ‰ç…§å®é™…å¤§å°å æ®ç”»å¸ƒçš„å®½åº¦ã€‚</li><li>sHeightï¼šå›¾åƒåœ¨ç”»å¸ƒä¸Šçš„é«˜åº¦ï¼Œä¼šäº§ç”Ÿç¼©æ”¾æ•ˆæœã€‚å¦‚æœæœªæŒ‡å®šï¼Œåˆ™å›¾åƒä¸ä¼šç¼©æ”¾ï¼ŒæŒ‰ç…§å®é™…å¤§å°å æ®ç”»å¸ƒçš„é«˜åº¦ã€‚</li><li>dxï¼šç”»å¸ƒå†…éƒ¨çš„æ¨ªåæ ‡ï¼Œç”¨äºæ”¾ç½®å›¾åƒçš„å·¦ä¸Šè§’</li><li>dyï¼šç”»å¸ƒå†…éƒ¨çš„çºµåæ ‡ï¼Œç”¨äºæ”¾ç½®å›¾åƒçš„å³ä¸Šè§’</li><li>dWidthï¼šå›¾åƒåœ¨ç”»å¸ƒå†…éƒ¨çš„å®½åº¦ï¼Œä¼šäº§ç”Ÿç¼©æ”¾æ•ˆæœã€‚</li><li>dHeightï¼šå›¾åƒåœ¨ç”»å¸ƒå†…éƒ¨çš„é«˜åº¦ï¼Œä¼šäº§ç”Ÿç¼©æ”¾æ•ˆæœã€‚</li></ul><p>ä¸‹é¢æ˜¯æœ€ç®€å•çš„ä½¿ç”¨åœºæ™¯ï¼Œå°†å›¾åƒæ”¾åœ¨ç”»å¸ƒä¸Šï¼Œä¸¤è€…å·¦ä¸Šè§’å¯¹é½ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
img<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">&#39;image.png&#39;</span><span class="token punctuation">;</span>
img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç å°†ä¸€ä¸ª PNG å›¾åƒæ”¾å…¥ç”»å¸ƒã€‚è¿™æ—¶ï¼Œå›¾åƒå°†æ˜¯åŸå§‹å¤§å°ï¼Œå¦‚æœç”»å¸ƒå°äºå›¾åƒï¼Œå°±ä¼šåªæ˜¾ç¤ºå‡ºå›¾åƒå·¦ä¸Šè§’ï¼Œæ­£å¥½ç­‰äºç”»å¸ƒå¤§å°çš„é‚£ä¸€å—ã€‚</p><p>å¦‚æœè¦æ˜¾ç¤ºå®Œæ•´çš„å›¾ç‰‡ï¼Œå¯ä»¥ç”¨å›¾åƒçš„å®½å’Œé«˜ï¼Œè®¾ç½®æˆç”»å¸ƒçš„å®½å’Œé«˜ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> image <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
image<span class="token punctuation">.</span>onload <span class="token operator">=</span> drawImageActualSize<span class="token punctuation">;</span>
image<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">&#39;https://example.com/image.jpg&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">drawImageActualSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>naturalWidth<span class="token punctuation">;</span>
  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>naturalHeight<span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>naturalWidth<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>naturalHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>&lt;canvas&gt;</code>å…ƒç´ çš„å¤§å°è®¾ç½®æˆå›¾åƒçš„æœ¬æ¥å¤§å°ï¼Œå°±èƒ½ä¿è¯å®Œæ•´å±•ç¤ºå›¾åƒã€‚ç”±äºå›¾åƒçš„æœ¬æ¥å¤§å°ï¼Œåªæœ‰å›¾åƒåŠ è½½æˆåŠŸä»¥åæ‰èƒ½æ‹¿åˆ°ï¼Œå› æ­¤è°ƒæ•´ç”»å¸ƒçš„å¤§å°ï¼Œå¿…é¡»æ”¾åœ¨<code>image.onload</code>è¿™ä¸ªç›‘å¬å‡½æ•°é‡Œé¢ã€‚</p><h4 id="åƒç´ è¯»å†™" tabindex="-1"><a class="header-anchor" href="#åƒç´ è¯»å†™" aria-hidden="true">#</a> åƒç´ è¯»å†™</h4><p>ä»¥ä¸‹ä¸‰ä¸ªæ–¹æ³•ä¸åƒç´ è¯»å†™ç›¸å…³ã€‚</p><ul><li><code>CanvasRenderingContext2D.getImageData()</code>ï¼šå°†ç”»å¸ƒè¯»å–æˆä¸€ä¸ª ImageData å¯¹è±¡</li><li><code>CanvasRenderingContext2D.putImageData()</code>ï¼šå°† ImageData å¯¹è±¡å†™å…¥ç”»å¸ƒ</li><li><code>CanvasRenderingContext2D.createImageData()</code>ï¼šç”Ÿæˆ ImageData å¯¹è±¡</li></ul><p><strong>ï¼ˆ1ï¼‰getImageData()</strong></p><p><code>CanvasRenderingContext2D.getImageData()</code>æ–¹æ³•ç”¨æ¥è¯»å–<code>&lt;canvas&gt;</code>çš„å†…å®¹ï¼Œè¿”å›ä¸€ä¸ª ImageData å¯¹è±¡ï¼ŒåŒ…å«äº†æ¯ä¸ªåƒç´ çš„ä¿¡æ¯ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>ctx<span class="token punctuation">.</span><span class="token function">getImageData</span><span class="token punctuation">(</span>sx<span class="token punctuation">,</span> sy<span class="token punctuation">,</span> sw<span class="token punctuation">,</span> sh<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>getImageData()</code>æ–¹æ³•æ¥å—å››ä¸ªå‚æ•°ã€‚<code>sx</code>å’Œ<code>sy</code>æ˜¯è¯»å–åŒºåŸŸçš„å·¦ä¸Šè§’åæ ‡ï¼Œ<code>sw</code>å’Œ<code>sh</code>æ˜¯è¯»å–åŒºåŸŸçš„å®½åº¦å’Œé«˜åº¦ã€‚å¦‚æœæƒ³è¦è¯»å–æ•´ä¸ª<code>&lt;canvas&gt;</code>åŒºåŸŸï¼Œå¯ä»¥å†™æˆä¸‹é¢è¿™æ ·ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> imageData <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">getImageData</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> canvas<span class="token punctuation">.</span>width<span class="token punctuation">,</span> canvas<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>getImageData()</code>æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ª<code>ImageData</code>å¯¹è±¡ã€‚è¯¥å¯¹è±¡æœ‰ä¸‰ä¸ªå±æ€§ã€‚</p><ul><li>ImageData.dataï¼šä¸€ä¸ªä¸€ç»´æ•°ç»„ã€‚è¯¥æ•°ç»„çš„å€¼ï¼Œä¾æ¬¡æ˜¯æ¯ä¸ªåƒç´ çš„çº¢ã€ç»¿ã€è“ã€alpha é€šé“å€¼ï¼ˆæ¯ä¸ªå€¼çš„èŒƒå›´æ˜¯ 0ï½255ï¼‰ï¼Œå› æ­¤è¯¥æ•°ç»„çš„é•¿åº¦ç­‰äº<code>å›¾åƒçš„åƒç´ å®½åº¦ x å›¾åƒçš„åƒç´ é«˜åº¦ x 4</code>ã€‚è¿™ä¸ªæ•°ç»„ä¸ä»…å¯è¯»ï¼Œè€Œä¸”å¯å†™ï¼Œå› æ­¤é€šè¿‡æ“ä½œè¿™ä¸ªæ•°ç»„ï¼Œå°±å¯ä»¥è¾¾åˆ°æ“ä½œå›¾åƒçš„ç›®çš„ã€‚</li><li>ImageData.widthï¼šæµ®ç‚¹æ•°ï¼Œè¡¨ç¤º ImageData çš„åƒç´ å®½åº¦ã€‚</li><li>ImageData.heightï¼šæµ®ç‚¹æ•°ï¼Œè¡¨ç¤º ImageData çš„åƒç´ é«˜åº¦ã€‚</li></ul><p><strong>ï¼ˆ2ï¼‰putImageData()</strong></p><p><code>CanvasRenderingContext2D.putImageData()</code>æ–¹æ³•å°†<code>ImageData</code>å¯¹è±¡çš„åƒç´ ç»˜åˆ¶åœ¨<code>&lt;canvas&gt;</code>ç”»å¸ƒä¸Šã€‚è¯¥æ–¹æ³•æœ‰ä¸¤ç§ä½¿ç”¨æ ¼å¼ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>ctx<span class="token punctuation">.</span><span class="token function">putImageData</span><span class="token punctuation">(</span>imagedata<span class="token punctuation">,</span> dx<span class="token punctuation">,</span> dy<span class="token punctuation">)</span>
ctx<span class="token punctuation">.</span><span class="token function">putImageData</span><span class="token punctuation">(</span>imagedata<span class="token punctuation">,</span> dx<span class="token punctuation">,</span> dy<span class="token punctuation">,</span> dirtyX<span class="token punctuation">,</span> dirtyY<span class="token punctuation">,</span> dirtyWidth<span class="token punctuation">,</span> dirtyHeight<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯¥æ–¹æ³•æœ‰å¦‚ä¸‹å‚æ•°ã€‚</p><ul><li>imagedataï¼šåŒ…å«åƒç´ ä¿¡æ¯çš„ ImageData å¯¹è±¡ã€‚</li><li>dxï¼š<code>&lt;canvas&gt;</code>å…ƒç´ å†…éƒ¨çš„æ¨ªåæ ‡ï¼Œç”¨äºæ”¾ç½® ImageData å›¾åƒçš„å·¦ä¸Šè§’ã€‚</li><li>dyï¼š<code>&lt;canvas&gt;</code>å…ƒç´ å†…éƒ¨çš„çºµåæ ‡ï¼Œç”¨äºæ”¾ç½® ImageData å›¾åƒçš„å·¦ä¸Šè§’ã€‚</li><li>dirtyXï¼šImageData å›¾åƒå†…éƒ¨çš„æ¨ªåæ ‡ï¼Œç”¨äºä½œä¸ºæ”¾ç½®åˆ°<code>&lt;canvas&gt;</code>çš„çŸ©å½¢åŒºåŸŸçš„å·¦ä¸Šè§’çš„æ¨ªåæ ‡ï¼Œé»˜è®¤ä¸º0ã€‚</li><li>dirtyYï¼šImageData å›¾åƒå†…éƒ¨çš„çºµåæ ‡ï¼Œç”¨äºä½œä¸ºæ”¾ç½®åˆ°<code>&lt;canvas&gt;</code>çš„çŸ©å½¢åŒºåŸŸçš„å·¦ä¸Šè§’çš„çºµåæ ‡ï¼Œé»˜è®¤ä¸º0ã€‚</li><li>dirtyWidthï¼šæ”¾ç½®åˆ°<code>&lt;canvas&gt;</code>çš„çŸ©å½¢åŒºåŸŸçš„å®½åº¦ï¼Œé»˜è®¤ä¸º ImageData å›¾åƒçš„å®½åº¦ã€‚</li><li>dirtyHeightï¼šæ”¾ç½®åˆ°<code>&lt;canvas&gt;</code>çš„çŸ©å½¢åŒºåŸŸçš„é«˜åº¦ï¼Œé»˜è®¤ä¸º ImageData å›¾åƒçš„é«˜åº¦ã€‚</li></ul><p>ä¸‹é¢æ˜¯å°† ImageData å¯¹è±¡ç»˜åˆ¶åˆ°<code>&lt;canvas&gt;</code>çš„ä¾‹å­ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>ctx<span class="token punctuation">.</span><span class="token function">putImageData</span><span class="token punctuation">(</span>imageData<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>ï¼ˆ3ï¼‰createImageData()</strong></p><p><code>CanvasRenderingContext2D.createImageData()</code>æ–¹æ³•ç”¨äºç”Ÿæˆä¸€ä¸ªç©ºçš„<code>ImageData</code>å¯¹è±¡ï¼Œæ‰€æœ‰åƒç´ éƒ½æ˜¯é€æ˜çš„é»‘è‰²ï¼ˆå³æ¯ä¸ªå€¼éƒ½æ˜¯<code>0</code>ï¼‰ã€‚è¯¥æ–¹æ³•æœ‰ä¸¤ç§ä½¿ç”¨æ ¼å¼ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>ctx<span class="token punctuation">.</span><span class="token function">createImageData</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">)</span>
ctx<span class="token punctuation">.</span><span class="token function">createImageData</span><span class="token punctuation">(</span>imagedata<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><code>createImageData()</code>æ–¹æ³•çš„å‚æ•°å¦‚ä¸‹ã€‚</p><ul><li>widthï¼šImageData å¯¹è±¡çš„å®½åº¦ï¼Œå•ä½ä¸ºåƒç´ ã€‚</li><li>heightï¼šImageData å¯¹è±¡çš„é«˜åº¦ï¼Œå•ä½ä¸ºåƒç´ ã€‚</li><li>imagedataï¼šä¸€ä¸ªç°æœ‰çš„ ImageData å¯¹è±¡ï¼Œè¿”å›å€¼å°†æ˜¯è¿™ä¸ªå¯¹è±¡çš„æ‹·è´ã€‚</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> imageData <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">createImageData</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>imageData</code>æ˜¯ä¸€ä¸ª 100 x 100 çš„åƒç´ åŒºåŸŸï¼Œå…¶ä¸­æ¯ä¸ªåƒç´ éƒ½æ˜¯é€æ˜çš„é»‘è‰²ã€‚</p><h4 id="canvasrenderingcontext2d-save-canvasrenderingcontext2d-restore" tabindex="-1"><a class="header-anchor" href="#canvasrenderingcontext2d-save-canvasrenderingcontext2d-restore" aria-hidden="true">#</a> CanvasRenderingContext2D.save()ï¼ŒCanvasRenderingContext2D.restore()</h4><p><code>CanvasRenderingContext2D.save()</code>æ–¹æ³•ç”¨äºå°†ç”»å¸ƒçš„å½“å‰æ ·å¼ä¿å­˜åˆ°å †æ ˆï¼Œç›¸å½“äºåœ¨å†…å­˜ä¹‹ä¸­äº§ç”Ÿä¸€ä¸ªæ ·å¼å¿«ç…§ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>save()</code>ä¼šä¸ºç”»å¸ƒçš„é»˜è®¤æ ·å¼äº§ç”Ÿä¸€ä¸ªå¿«ç…§ã€‚</p><p><code>CanvasRenderingContext2D.restore()</code>æ–¹æ³•å°†ç”»å¸ƒçš„æ ·å¼æ¢å¤åˆ°ä¸Šä¸€ä¸ªä¿å­˜çš„å¿«ç…§ï¼Œå¦‚æœæ²¡æœ‰å·²ä¿å­˜çš„å¿«ç…§ï¼Œåˆ™ä¸äº§ç”Ÿä»»ä½•æ•ˆæœã€‚</p><p>ä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œrestoreæ–¹æ³•ç”¨äºæ¢å¤åˆ°ä¸Šä¸€æ¬¡ä¿å­˜çš„ä¸Šä¸‹æ–‡ç¯å¢ƒã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&#39;green&#39;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">restore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ç”»ä¸€ä¸ªçŸ©å½¢ã€‚çŸ©å½¢çš„å¡«å……è‰²æœ¬æ¥è®¾ä¸ºç»¿è‰²ï¼Œä½†æ˜¯<code>restore()</code>æ–¹æ³•æ’¤é”€äº†è¿™ä¸ªè®¾ç½®ï¼Œå°†æ ·å¼æ¢å¤ä¸Šä¸€æ¬¡ä¿å­˜çš„çŠ¶æ€ï¼ˆå³é»˜è®¤æ ·å¼ï¼‰ï¼Œæ‰€ä»¥å®é™…çš„å¡«å……è‰²æ˜¯é»‘è‰²ï¼ˆé»˜è®¤é¢œè‰²ï¼‰ã€‚</p><h4 id="canvasrenderingcontext2d-canvas" tabindex="-1"><a class="header-anchor" href="#canvasrenderingcontext2d-canvas" aria-hidden="true">#</a> CanvasRenderingContext2D.canvas</h4><p><code>CanvasRenderingContext2D.canvas</code>å±æ€§æŒ‡å‘å½“å‰<code>CanvasRenderingContext2D</code>å¯¹è±¡æ‰€åœ¨çš„<code>&lt;canvas&gt;</code>å…ƒç´ ã€‚è¯¥å±æ€§åªè¯»ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span>canvas <span class="token operator">===</span> canvas <span class="token comment">// true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å›¾åƒå˜æ¢" tabindex="-1"><a class="header-anchor" href="#å›¾åƒå˜æ¢" aria-hidden="true">#</a> å›¾åƒå˜æ¢</h4><p>ä»¥ä¸‹æ–¹æ³•ç”¨äºå›¾åƒå˜æ¢ã€‚</p><ul><li><code>CanvasRenderingContext2D.rotate()</code>ï¼šå›¾åƒæ—‹è½¬</li><li><code>CanvasRenderingContext2D.scale()</code>ï¼šå›¾åƒç¼©æ”¾</li><li><code>CanvasRenderingContext2D.translate()</code>ï¼šå›¾åƒå¹³ç§»</li><li><code>CanvasRenderingContext2D.transform()</code>ï¼šé€šè¿‡ä¸€ä¸ªå˜æ¢çŸ©é˜µå®Œæˆå›¾åƒå˜æ¢</li><li><code>CanvasRenderingContext2D.setTransform()</code>ï¼šå–æ¶ˆå‰é¢çš„å›¾åƒå˜æ¢</li></ul><p><strong>ï¼ˆ1ï¼‰rotate()</strong></p><p><code>CanvasRenderingContext2D.rotate()</code>æ–¹æ³•ç”¨äºå›¾åƒæ—‹è½¬ã€‚å®ƒæ¥å—ä¸€ä¸ªå¼§åº¦å€¼ä½œä¸ºå‚æ•°ï¼Œè¡¨ç¤ºé¡ºæ—¶é’ˆæ—‹è½¬çš„åº¦æ•°ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span><span class="token number">45</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¼šæ˜¾ç¤ºä¸€ä¸ªé¡ºæ—¶é’ˆå€¾æ–œ45åº¦çš„çŸ©å½¢ã€‚æ³¨æ„ï¼Œ<code>rotate()</code>æ–¹æ³•å¿…é¡»åœ¨<code>fillRect()</code>æ–¹æ³•ä¹‹å‰è°ƒç”¨ï¼Œå¦åˆ™æ˜¯ä¸èµ·ä½œç”¨çš„ã€‚</p><p>æ—‹è½¬ä¸­å¿ƒç‚¹å§‹ç»ˆæ˜¯ç”»å¸ƒå·¦ä¸Šè§’çš„åŸç‚¹ã€‚å¦‚æœè¦æ›´æ”¹ä¸­å¿ƒç‚¹ï¼Œéœ€è¦ä½¿ç”¨<code>translate()</code>æ–¹æ³•ç§»åŠ¨ç”»å¸ƒã€‚</p><p><strong>ï¼ˆ2ï¼‰scale()</strong></p><p><code>CanvasRenderingContext2D.scale()</code>æ–¹æ³•ç”¨äºç¼©æ”¾å›¾åƒã€‚å®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯<code>x</code>è½´æ–¹å‘çš„ç¼©æ”¾å› å­å’Œ<code>y</code>è½´æ–¹å‘çš„ç¼©æ”¾å› å­ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€ä¸ªå•ä½å°±æ˜¯ä¸€ä¸ªåƒç´ ï¼Œç¼©æ”¾å› å­å¯ä»¥ç¼©æ”¾å•ä½ï¼Œæ¯”å¦‚ç¼©æ”¾å› å­<code>0.5</code>è¡¨ç¤ºå°†å¤§å°ç¼©å°ä¸ºåŸæ¥çš„50%ï¼Œç¼©æ”¾å› å­<code>10</code>è¡¨ç¤ºæ”¾å¤§åå€ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span><span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼ŒåŸæ¥çš„çŸ©å½¢æ˜¯ 10 x 10ï¼Œç¼©æ”¾åå±•ç¤ºå‡ºæ¥æ˜¯ 100 x 30ã€‚</p><p>å¦‚æœç¼©æ”¾å› å­ä¸º1ï¼Œå°±è¡¨ç¤ºå›¾åƒæ²¡æœ‰ä»»ä½•ç¼©æ”¾ã€‚å¦‚æœä¸º-1ï¼Œåˆ™è¡¨ç¤ºæ–¹å‘ç¿»è½¬ã€‚<code>ctx.scale(-1, 1)</code>ä¸ºæ°´å¹³ç¿»è½¬ï¼Œ<code>ctx.scale(1, -1)</code>è¡¨ç¤ºå‚ç›´ç¿»è½¬ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span><span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token string">&quot;16px serif&quot;</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span><span class="token string">&#39;Hello world!&#39;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¼šæ˜¾ç¤ºä¸€ä¸ªæ°´å¹³å€’è½¬çš„ã€é«˜åº¦æ”¾å¤§2å€çš„<code>Hello World!</code>ã€‚</p><p>æ³¨æ„ï¼Œè´Ÿå‘ç¼©æ”¾æœ¬è´¨æ˜¯åæ ‡ç¿»è½¬ï¼Œæ‰€é’ˆå¯¹çš„åæ ‡è½´å°±æ˜¯ç”»å¸ƒå·¦ä¸Šè§’åŸç‚¹çš„åæ ‡è½´ã€‚</p><p><strong>ï¼ˆ3ï¼‰translate()</strong></p><p><code>CanvasRenderingContext2D.translate()</code>æ–¹æ³•ç”¨äºå¹³ç§»å›¾åƒã€‚å®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯ x è½´å’Œ y è½´ç§»åŠ¨çš„è·ç¦»ï¼ˆå•ä½åƒç´ ï¼‰ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ï¼ˆ4ï¼‰transform()</strong></p><p><code>CanvasRenderingContext2D.transform()</code>æ–¹æ³•æ¥å—ä¸€ä¸ªå˜æ¢çŸ©é˜µçš„å…­ä¸ªå…ƒç´ ä½œä¸ºå‚æ•°ï¼Œå®Œæˆç¼©æ”¾ã€æ—‹è½¬ã€ç§»åŠ¨å’Œå€¾æ–œç­‰å˜å½¢ã€‚</p><p>å®ƒçš„ä½¿ç”¨æ ¼å¼å¦‚ä¸‹ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>ctx<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> e<span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
a:æ°´å¹³ç¼©æ”¾(é»˜è®¤å€¼1ï¼Œå•ä½å€æ•°)
b:æ°´å¹³å€¾æ–œ(é»˜è®¤å€¼0ï¼Œå•ä½å¼§åº¦)
c:å‚ç›´å€¾æ–œ(é»˜è®¤å€¼0ï¼Œå•ä½å¼§åº¦)
d:å‚ç›´ç¼©æ”¾(é»˜è®¤å€¼1ï¼Œå•ä½å€æ•°)
e:æ°´å¹³ä½ç§»(é»˜è®¤å€¼0ï¼Œå•ä½åƒç´ )
f:å‚ç›´ä½ç§»(é»˜è®¤å€¼0ï¼Œå•ä½åƒç´ )
*/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼ŒåŸå§‹å›¾å½¢æ˜¯ 100 x 100 çš„çŸ©å½¢ï¼Œç»“æœç¼©æ”¾æˆ 200 x 100 çš„çŸ©å½¢ï¼Œå¹¶ä¸”å·¦ä¸Šè§’ä»<code>(0, 0)</code>ç§»åŠ¨åˆ°<code>(50, 50)</code>ã€‚</p><p>æ³¨æ„ï¼Œå¤šä¸ª<code>transform()</code>æ–¹æ³•å…·æœ‰å åŠ æ•ˆæœã€‚</p><p><strong>ï¼ˆ5ï¼‰setTransform()</strong></p><p><code>CanvasRenderingContext2D.setTransform()</code>æ–¹æ³•å–æ¶ˆå‰é¢çš„å›¾å½¢å˜æ¢ï¼Œå°†ç”»å¸ƒæ¢å¤åˆ°è¯¥æ–¹æ³•æŒ‡å®šçš„çŠ¶æ€ã€‚è¯¥æ–¹æ³•çš„å‚æ•°ä¸<code>transform()</code>æ–¹æ³•å®Œå…¨ä¸€è‡´ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ctx<span class="token punctuation">.</span><span class="token function">setTransform</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬ä¸€ä¸ª<code>fillRect()</code>æ–¹æ³•ç»˜åˆ¶çš„çŸ©å½¢ï¼Œå·¦ä¸Šè§’ä»<code>(0, 0)</code>å¹³ç§»åˆ°<code>(50, 50)</code>ã€‚<code>setTransform()</code>æ–¹æ³•å–æ¶ˆäº†è¿™ä¸ªå˜æ¢ï¼ˆå·²ç»˜åˆ¶çš„å›¾å½¢ä¸å—å½±å“ï¼‰ï¼Œå°†ç”»å¸ƒæ¢å¤åˆ°é»˜è®¤çŠ¶æ€ï¼ˆå˜æ¢çŸ©å½¢<code>1, 0, 0, 1, 0, 0</code>ï¼‰ï¼Œæ‰€ä»¥ç¬¬äºŒä¸ªçŸ©å½¢çš„å·¦ä¸Šè§’å›åˆ°<code>(0, 0)</code>ã€‚</p><h3 id="canvas-å…ƒç´ çš„æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#canvas-å…ƒç´ çš„æ–¹æ³•" aria-hidden="true">#</a> <code>&lt;canvas&gt;</code> å…ƒç´ çš„æ–¹æ³•</h3><p>é™¤äº†<code>CanvasRenderingContext2D</code>å¯¹è±¡æä¾›çš„æ–¹æ³•ï¼Œ<code>&lt;canvas&gt;</code>å…ƒç´ æœ¬èº«ä¹Ÿæœ‰è‡ªå·±çš„æ–¹æ³•ã€‚</p><h4 id="htmlcanvaselement-todataurl" tabindex="-1"><a class="header-anchor" href="#htmlcanvaselement-todataurl" aria-hidden="true">#</a> HTMLCanvasElement.toDataURL()</h4><p><code>&lt;canvas&gt;</code>å…ƒç´ çš„<code>toDataURL()</code>æ–¹æ³•ï¼Œå¯ä»¥å°† Canvas æ•°æ®è½¬ä¸º Data URI æ ¼å¼çš„å›¾åƒã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>canvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> quality<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>toDataURL()</code>æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ã€‚</p><ul><li>typeï¼šå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå›¾åƒçš„æ ¼å¼ã€‚é»˜è®¤ä¸º<code>image/png</code>ï¼Œå¦ä¸€ä¸ªå¯ç”¨çš„å€¼æ˜¯<code>image/jpeg</code>ï¼ŒChrome æµè§ˆå™¨è¿˜å¯ä»¥ä½¿ç”¨<code>image/webp</code>ã€‚</li><li>qualityï¼šæµ®ç‚¹æ•°ï¼Œ0åˆ°1ä¹‹é—´ï¼Œè¡¨ç¤º JPEG å’Œ WebP å›¾åƒçš„è´¨é‡ç³»æ•°ï¼Œé»˜è®¤å€¼ä¸º0.92ã€‚</li></ul><p>è¯¥æ–¹æ³•çš„è¿”å›å€¼æ˜¯ä¸€ä¸ª Data URI æ ¼å¼çš„å­—ç¬¦ä¸²ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">convertCanvasToImage</span><span class="token punctuation">(</span><span class="token parameter">canvas</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> image <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  image<span class="token punctuation">.</span>src <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">&#39;image/png&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> image<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„ä»£ç å°†<code>&lt;canvas&gt;</code>å…ƒç´ ï¼Œè½¬åŒ–æˆPNG Data URIã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> fullQuality <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">&#39;image/jpeg&#39;</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> mediumQuality <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">&#39;image/jpeg&#39;</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> lowQuality <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">&#39;image/jpeg&#39;</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç å°†<code>&lt;canvas&gt;</code>å…ƒç´ è½¬æˆé«˜ç”»è´¨ã€ä¸­ç”»è´¨ã€ä½ç”»è´¨ä¸‰ç§ JPEG å›¾åƒã€‚</p><h4 id="htmlcanvaselement-toblob" tabindex="-1"><a class="header-anchor" href="#htmlcanvaselement-toblob" aria-hidden="true">#</a> HTMLCanvasElement.toBlob()</h4><p><code>HTMLCanvasElement.toBlob()</code>æ–¹æ³•ç”¨äºå°†<code>&lt;canvas&gt;</code>å›¾åƒè½¬æˆä¸€ä¸ª Blob å¯¹è±¡ï¼Œé»˜è®¤ç±»å‹æ˜¯<code>image/png</code>ã€‚å®ƒçš„ä½¿ç”¨æ ¼å¼å¦‚ä¸‹ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// æ ¼å¼</span>
canvas<span class="token punctuation">.</span><span class="token function">toBlob</span><span class="token punctuation">(</span>callback<span class="token punctuation">,</span> mimeType<span class="token punctuation">,</span> quality<span class="token punctuation">)</span>

<span class="token comment">// ç¤ºä¾‹</span>
canvas<span class="token punctuation">.</span><span class="token function">toBlob</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">blob</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&#39;image/jpeg&#39;</span><span class="token punctuation">,</span> <span class="token number">0.95</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>toBlob()</code>æ–¹æ³•å¯ä»¥æ¥å—ä¸‰ä¸ªå‚æ•°ã€‚</p><ul><li>callbackï¼šå›è°ƒå‡½æ•°ã€‚å®ƒæ¥å—ç”Ÿæˆçš„ Blob å¯¹è±¡ä½œä¸ºå‚æ•°ã€‚</li><li>mimeTypeï¼šå­—ç¬¦ä¸²ï¼Œå›¾åƒçš„ MIMEType ç±»å‹ï¼Œé»˜è®¤æ˜¯<code>image/png</code>ã€‚</li><li>qualityï¼šæµ®ç‚¹æ•°ï¼Œ0åˆ°1ä¹‹é—´ï¼Œè¡¨ç¤ºå›¾åƒçš„è´¨é‡ï¼Œåªå¯¹<code>image/jpeg</code>å’Œ<code>image/webp</code>ç±»å‹çš„å›¾åƒæœ‰æ•ˆã€‚</li></ul><p>æ³¨æ„ï¼Œè¯¥æ–¹æ³•æ²¡æœ‰è¿”å›å€¼ã€‚</p><p>ä¸‹é¢çš„ä¾‹å­å°†<code>&lt;canvas&gt;</code>å›¾åƒå¤åˆ¶æˆ<code>&lt;img&gt;</code>å›¾åƒã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">blobToImg</span><span class="token punctuation">(</span><span class="token parameter">blob</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> newImg <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;img&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span>

  newImg<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ä½¿ç”¨å®Œæ¯•ï¼Œé‡Šæ”¾ URL å¯¹è±¡</span>
    <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">revokeObjectURL</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  newImg<span class="token punctuation">.</span>src <span class="token operator">=</span> url<span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>newImg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

canvas<span class="token punctuation">.</span><span class="token function">toBlob</span><span class="token punctuation">(</span>blobToImg<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="canvas-ä½¿ç”¨å®ä¾‹" tabindex="-1"><a class="header-anchor" href="#canvas-ä½¿ç”¨å®ä¾‹" aria-hidden="true">#</a> Canvas ä½¿ç”¨å®ä¾‹</h3><h4 id="åŠ¨ç”»æ•ˆæœ" tabindex="-1"><a class="header-anchor" href="#åŠ¨ç”»æ•ˆæœ" aria-hidden="true">#</a> åŠ¨ç”»æ•ˆæœ</h4><p>é€šè¿‡æ”¹å˜åæ ‡ï¼Œå¾ˆå®¹æ˜“åœ¨ç”»å¸ƒ Canvas å…ƒç´ ä¸Šäº§ç”ŸåŠ¨ç”»æ•ˆæœã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;myCanvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> posX <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> posY <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>

<span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&#39;black&#39;</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> canvas<span class="token punctuation">.</span>width<span class="token punctuation">,</span> canvas<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>

  posX <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  posY <span class="token operator">+=</span> <span class="token number">0.25</span><span class="token punctuation">;</span>

  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&#39;white&#39;</span><span class="token punctuation">;</span>

  ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span>posX<span class="token punctuation">,</span> posY<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">closePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¼šäº§ç”Ÿä¸€ä¸ªå°åœ†ç‚¹ï¼Œæ¯éš”30æ¯«ç§’å°±å‘å³ä¸‹æ–¹ç§»åŠ¨çš„æ•ˆæœã€‚<code>setInterval()</code>å‡½æ•°çš„ä¸€å¼€å§‹ï¼Œä¹‹æ‰€ä»¥è¦å°†ç”»å¸ƒé‡æ–°æ¸²æŸ“é»‘è‰²åº•è‰²ï¼Œæ˜¯ä¸ºäº†æŠ¹å»ä¸Šä¸€æ­¥çš„å°åœ†ç‚¹ã€‚</p><p>åœ¨è¿™ä¸ªä¾‹å­çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡è®¾ç½®åœ†å¿ƒåæ ‡ï¼Œå¯ä»¥äº§ç”Ÿå„ç§è¿åŠ¨è½¨è¿¹ã€‚ä¸‹é¢æ˜¯å…ˆä¸Šå‡åä¸‹é™çš„ä¾‹å­ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> vx <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> vy <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> gravity <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  posX <span class="token operator">+=</span> vx<span class="token punctuation">;</span>
  posY <span class="token operator">+=</span> vy<span class="token punctuation">;</span>
  vy <span class="token operator">+=</span> gravity<span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>x</code>åæ ‡å§‹ç»ˆå¢å¤§ï¼Œè¡¨ç¤ºæŒç»­å‘å³è¿åŠ¨ã€‚<code>y</code>åæ ‡å…ˆå˜å°ï¼Œç„¶ååœ¨é‡åŠ›ä½œç”¨ä¸‹ï¼Œä¸æ–­å¢å¤§ï¼Œè¡¨ç¤ºå…ˆä¸Šå‡åä¸‹é™ã€‚</p><h4 id="åƒç´ å¤„ç†" tabindex="-1"><a class="header-anchor" href="#åƒç´ å¤„ç†" aria-hidden="true">#</a> åƒç´ å¤„ç†</h4><p>é€šè¿‡<code>getImageData()</code>æ–¹æ³•å’Œ<code>putImageData()</code>æ–¹æ³•ï¼Œå¯ä»¥å¤„ç†æ¯ä¸ªåƒç´ ï¼Œè¿›è€Œæ“ä½œå›¾åƒå†…å®¹ï¼Œå› æ­¤å¯ä»¥æ”¹å†™å›¾åƒã€‚</p><p>ä¸‹é¢æ˜¯å›¾åƒå¤„ç†çš„é€šç”¨å†™æ³•ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>canvas<span class="token punctuation">.</span>width <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> canvas<span class="token punctuation">.</span>height <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> imageData <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getImageData</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> canvas<span class="token punctuation">.</span>width<span class="token punctuation">,</span> canvas<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">filter</span><span class="token punctuation">(</span>imageData<span class="token punctuation">)</span><span class="token punctuation">;</span>
  context<span class="token punctuation">.</span><span class="token function">putImageData</span><span class="token punctuation">(</span>imageData<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>filter</code>æ˜¯ä¸€ä¸ªå¤„ç†åƒç´ çš„å‡½æ•°ã€‚ä»¥ä¸‹æ˜¯å‡ ç§å¸¸è§çš„<code>filter</code>ã€‚</p><p><strong>ï¼ˆ1ï¼‰ç°åº¦æ•ˆæœ</strong></p><p>ç°åº¦å›¾ï¼ˆgrayscaleï¼‰å°±æ˜¯å–çº¢ã€ç»¿ã€è“ä¸‰ä¸ªåƒç´ å€¼çš„ç®—æœ¯å¹³å‡å€¼ï¼Œè¿™å®é™…ä¸Šå°†å›¾åƒè½¬æˆäº†é»‘ç™½å½¢å¼ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function-variable function">grayscale</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">pixels</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> d <span class="token operator">=</span> pixels<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> d<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> r <span class="token operator">=</span> d<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> g <span class="token operator">=</span> d<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> b <span class="token operator">=</span> d<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    d<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> d<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> d<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>r <span class="token operator">+</span> g <span class="token operator">+</span> b<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> pixels<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>d[i]</code>æ˜¯çº¢è‰²å€¼ï¼Œ<code>d[i+1]</code>æ˜¯ç»¿è‰²å€¼ï¼Œ<code>d[i+2]</code>æ˜¯è“è‰²å€¼ï¼Œ<code>d[i+3]</code>æ˜¯ alpha é€šé“å€¼ã€‚è½¬æˆç°åº¦çš„ç®—æ³•ï¼Œå°±æ˜¯å°†çº¢ã€ç»¿ã€è“ä¸‰ä¸ªå€¼ç›¸åŠ åé™¤ä»¥3ï¼Œå†å°†ç»“æœå†™å›æ•°ç»„ã€‚</p><p><strong>ï¼ˆ2ï¼‰å¤å¤æ•ˆæœ</strong></p><p>å¤å¤æ•ˆæœï¼ˆsepiaï¼‰æ˜¯å°†çº¢ã€ç»¿ã€è“ä¸‰ç§å€¼ï¼Œåˆ†åˆ«å–è¿™ä¸‰ä¸ªå€¼çš„æŸç§åŠ æƒå¹³å‡å€¼ï¼Œä½¿å¾—å›¾åƒæœ‰ä¸€ç§å¤æ—§çš„æ•ˆæœã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function-variable function">sepia</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">pixels</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> d <span class="token operator">=</span> pixels<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> d<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> r <span class="token operator">=</span> d<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> g <span class="token operator">=</span> d<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> b <span class="token operator">=</span> d<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      d<span class="token punctuation">[</span>i<span class="token punctuation">]</span>     <span class="token operator">=</span> <span class="token punctuation">(</span>r <span class="token operator">*</span> <span class="token number">0.393</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>g <span class="token operator">*</span> <span class="token number">0.769</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>b <span class="token operator">*</span> <span class="token number">0.189</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// red</span>
      d<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>r <span class="token operator">*</span> <span class="token number">0.349</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>g <span class="token operator">*</span> <span class="token number">0.686</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>b <span class="token operator">*</span> <span class="token number">0.168</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// green</span>
      d<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>r <span class="token operator">*</span> <span class="token number">0.272</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>g <span class="token operator">*</span> <span class="token number">0.534</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>b <span class="token operator">*</span> <span class="token number">0.131</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// blue</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> pixels<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ï¼ˆ3ï¼‰çº¢è‰²è’™ç‰ˆæ•ˆæœ</strong></p><p>çº¢è‰²è’™ç‰ˆæŒ‡çš„æ˜¯ï¼Œè®©å›¾åƒå‘ˆç°ä¸€ç§åçº¢çš„æ•ˆæœã€‚ç®—æ³•æ˜¯å°†çº¢è‰²é€šé“è®¾ä¸ºçº¢ã€ç»¿ã€è“ä¸‰ä¸ªå€¼çš„å¹³å‡å€¼ï¼Œè€Œå°†ç»¿è‰²é€šé“å’Œè“è‰²é€šé“éƒ½è®¾ä¸º0ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">red</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">pixels</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> d <span class="token operator">=</span> pixels<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> d<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> r <span class="token operator">=</span> d<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> g <span class="token operator">=</span> d<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> b <span class="token operator">=</span> d<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    d<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>r <span class="token operator">+</span> g <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">;</span>        <span class="token comment">// çº¢è‰²é€šé“å–å¹³å‡å€¼</span>
    d<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> d<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// ç»¿è‰²é€šé“å’Œè“è‰²é€šé“éƒ½è®¾ä¸º0</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> pixels<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ï¼ˆ4ï¼‰äº®åº¦æ•ˆæœ</strong></p><p>äº®åº¦æ•ˆæœï¼ˆbrightnessï¼‰æ˜¯æŒ‡è®©å›¾åƒå˜å¾—æ›´äº®æˆ–æ›´æš—ã€‚ç®—æ³•å°†çº¢è‰²é€šé“ã€ç»¿è‰²é€šé“ã€è“è‰²é€šé“ï¼ŒåŒæ—¶åŠ ä¸Šä¸€ä¸ªæ­£å€¼æˆ–è´Ÿå€¼ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">brightness</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">pixels<span class="token punctuation">,</span> delta</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> d <span class="token operator">=</span> pixels<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> d<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    d<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> delta<span class="token punctuation">;</span>     <span class="token comment">// red</span>
    d<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+=</span> delta<span class="token punctuation">;</span> <span class="token comment">// green</span>
    d<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+=</span> delta<span class="token punctuation">;</span> <span class="token comment">// blue</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> pixels<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ï¼ˆ5ï¼‰åè½¬æ•ˆæœ</strong></p><p>åè½¬æ•ˆæœï¼ˆinvertï¼‰æ˜¯æŒ‡å›¾ç‰‡å‘ˆç°ä¸€ç§è‰²å½©é¢ å€’çš„æ•ˆæœã€‚ç®—æ³•ä¸ºçº¢ã€ç»¿ã€è“é€šé“éƒ½å–å„è‡ªçš„ç›¸åå€¼ï¼ˆ<code>255 - åŸå€¼</code>ï¼‰ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function-variable function">invert</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">pixels</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> d <span class="token operator">=</span> pixels<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> d<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    d<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">255</span> <span class="token operator">-</span> d<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    d<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">255</span> <span class="token operator">-</span> d<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    d<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">255</span> <span class="token operator">-</span> d<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> pixels<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å‚è€ƒé“¾æ¥" tabindex="-1"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥" aria-hidden="true">#</a> å‚è€ƒé“¾æ¥</h3><ul><li>David Walsh, <a href="http://davidwalsh.name/convert-canvas-image" target="_blank" rel="noopener noreferrer">JavaScript Canvas Image Conversion<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Matt West, <a href="http://blog.teamtreehouse.com/getting-started-with-the-canvas-api" target="_blank" rel="noopener noreferrer">Getting Started With The Canvas API<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>John Robinson, <a href="http://www.storminthecastle.com/2013/04/06/how-you-can-do-cool-image-effects-using-html5-canvas/" target="_blank" rel="noopener noreferrer">How You Can Do Cool Image Effects Using HTML5 Canvas<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Ivaylo Gerchev, <a href="http://www.sitepoint.com/html5-canvas-tutorial-introduction/" target="_blank" rel="noopener noreferrer">HTML5 Canvas Tutorial: An Introduction<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Donovan Hutchinson, <a href="http://hop.ie/blog/particles/" target="_blank" rel="noopener noreferrer">Particles in canvas<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h2 id="å‰ªè´´æ¿æ“ä½œ-clipboard-api-æ•™ç¨‹" tabindex="-1"><a class="header-anchor" href="#å‰ªè´´æ¿æ“ä½œ-clipboard-api-æ•™ç¨‹" aria-hidden="true">#</a> å‰ªè´´æ¿æ“ä½œ Clipboard API æ•™ç¨‹</h2><h3 id="ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#ç®€ä»‹" aria-hidden="true">#</a> ç®€ä»‹</h3><p>æµè§ˆå™¨å…è®¸ JavaScript è„šæœ¬è¯»å†™å‰ªè´´æ¿ï¼Œè‡ªåŠ¨å¤åˆ¶æˆ–ç²˜è´´å†…å®¹ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œè„šæœ¬ä¸åº”è¯¥æ”¹åŠ¨ç”¨æˆ·çš„å‰ªè´´æ¿ï¼Œä»¥å…ä¸ç¬¦åˆç”¨æˆ·çš„é¢„æœŸã€‚ä½†æ˜¯ï¼Œæœ‰äº›æ—¶å€™è¿™æ ·åšç¡®å®èƒ½å¤Ÿå¸¦æ¥æ–¹ä¾¿ï¼Œæ¯”å¦‚â€œä¸€é”®å¤åˆ¶â€åŠŸèƒ½ï¼Œç”¨æˆ·ç‚¹å‡»ä¸€ä¸‹æŒ‰é’®ï¼ŒæŒ‡å®šçš„å†…å®¹å°±è‡ªåŠ¨è¿›å…¥å‰ªè´´æ¿ã€‚</p><p>ç›®å‰ï¼Œä¸€å…±æœ‰ä¸‰ç§æ–¹æ³•å¯ä»¥å®ç°å‰ªè´´æ¿æ“ä½œã€‚</p><ul><li><code>Document.execCommand()</code>æ–¹æ³•</li><li>å¼‚æ­¥çš„ Clipboard API</li><li><code>copy</code>äº‹ä»¶å’Œ<code>paste</code>äº‹ä»¶</li></ul><p>æœ¬æ–‡é€ä¸€ä»‹ç»è¿™ä¸‰ç§æ–¹æ³•ã€‚</p><h3 id="document-execcommand-æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#document-execcommand-æ–¹æ³•" aria-hidden="true">#</a> Document.execCommand() æ–¹æ³•</h3><p><code>Document.execCommand()</code>æ˜¯æ“ä½œå‰ªè´´æ¿çš„ä¼ ç»Ÿæ–¹æ³•ï¼Œå„ç§æµè§ˆå™¨éƒ½æ”¯æŒã€‚</p><p>å®ƒæ”¯æŒå¤åˆ¶ã€å‰ªåˆ‡å’Œç²˜è´´è¿™ä¸‰ä¸ªæ“ä½œã€‚</p><ul><li><code>document.execCommand(&#39;copy&#39;)</code>ï¼ˆå¤åˆ¶ï¼‰</li><li><code>document.execCommand(&#39;cut&#39;)</code>ï¼ˆå‰ªåˆ‡ï¼‰</li><li><code>document.execCommand(&#39;paste&#39;)</code>ï¼ˆç²˜è´´ï¼‰</li></ul><p>ï¼ˆ1ï¼‰å¤åˆ¶æ“ä½œ</p><p>å¤åˆ¶æ—¶ï¼Œå…ˆé€‰ä¸­æ–‡æœ¬ï¼Œç„¶åè°ƒç”¨<code>document.execCommand(&#39;copy&#39;)</code>ï¼Œé€‰ä¸­çš„æ–‡æœ¬å°±ä¼šè¿›å…¥å‰ªè´´æ¿ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> inputElement <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;##input&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
inputElement<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span><span class="token function">execCommand</span><span class="token punctuation">(</span><span class="token string">&#39;copy&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œè„šæœ¬å…ˆé€‰ä¸­è¾“å…¥æ¡†<code>inputElement</code>é‡Œé¢çš„æ–‡å­—ï¼ˆ<code>inputElement.select()</code>ï¼‰ï¼Œç„¶å<code>document.execCommand(&#39;copy&#39;)</code>å°†å…¶å¤åˆ¶åˆ°å‰ªè´´æ¿ã€‚</p><p>æ³¨æ„ï¼Œå¤åˆ¶æ“ä½œæœ€å¥½æ”¾åœ¨äº‹ä»¶ç›‘å¬å‡½æ•°é‡Œé¢ï¼Œç”±ç”¨æˆ·è§¦å‘ï¼ˆæ¯”å¦‚ç”¨æˆ·ç‚¹å‡»æŒ‰é’®ï¼‰ã€‚å¦‚æœè„šæœ¬è‡ªä¸»æ‰§è¡Œï¼ŒæŸäº›æµè§ˆå™¨å¯èƒ½ä¼šæŠ¥é”™ã€‚</p><p>ï¼ˆ2ï¼‰ç²˜è´´æ“ä½œ</p><p>ç²˜è´´æ—¶ï¼Œè°ƒç”¨<code>document.execCommand(&#39;paste&#39;)</code>ï¼Œå°±ä¼šå°†å‰ªè´´æ¿é‡Œé¢çš„å†…å®¹ï¼Œè¾“å‡ºåˆ°å½“å‰çš„ç„¦ç‚¹å…ƒç´ ä¸­ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> pasteText <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;##output&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pasteText<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span><span class="token function">execCommand</span><span class="token punctuation">(</span><span class="token string">&#39;paste&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ï¼ˆ3ï¼‰ç¼ºç‚¹</p><p><code>Document.execCommand()</code>æ–¹æ³•è™½ç„¶æ–¹ä¾¿ï¼Œä½†æ˜¯æœ‰ä¸€äº›ç¼ºç‚¹ã€‚</p><p>é¦–å…ˆï¼Œå®ƒåªèƒ½å°†é€‰ä¸­çš„å†…å®¹å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œæ— æ³•å‘å‰ªè´´æ¿ä»»æ„å†™å…¥å†…å®¹ã€‚</p><p>å…¶æ¬¡ï¼Œå®ƒæ˜¯åŒæ­¥æ“ä½œï¼Œå¦‚æœå¤åˆ¶/ç²˜è´´å¤§é‡æ•°æ®ï¼Œé¡µé¢ä¼šå‡ºç°å¡é¡¿ã€‚æœ‰äº›æµè§ˆå™¨è¿˜ä¼šè·³å‡ºæç¤ºæ¡†ï¼Œè¦æ±‚ç”¨æˆ·è®¸å¯ï¼Œè¿™æ—¶åœ¨ç”¨æˆ·åšå‡ºé€‰æ‹©å‰ï¼Œé¡µé¢ä¼šå¤±å»å“åº”ã€‚</p><p>ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œæµè§ˆå™¨å‚å•†æå‡ºäº†å¼‚æ­¥çš„ Clipboard APIã€‚</p><h3 id="å¼‚æ­¥-clipboard-api" tabindex="-1"><a class="header-anchor" href="#å¼‚æ­¥-clipboard-api" aria-hidden="true">#</a> å¼‚æ­¥ Clipboard API</h3><p>Clipboard API æ˜¯ä¸‹ä¸€ä»£çš„å‰ªè´´æ¿æ“ä½œæ–¹æ³•ï¼Œæ¯”ä¼ ç»Ÿçš„<code>document.execCommand()</code>æ–¹æ³•æ›´å¼ºå¤§ã€æ›´åˆç†ã€‚</p><p>å®ƒçš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯å¼‚æ­¥çš„ï¼Œè¿”å› Promise å¯¹è±¡ï¼Œä¸ä¼šé€ æˆé¡µé¢å¡é¡¿ã€‚è€Œä¸”ï¼Œå®ƒå¯ä»¥å°†ä»»æ„å†…å®¹ï¼ˆæ¯”å¦‚å›¾ç‰‡ï¼‰æ”¾å…¥å‰ªè´´æ¿ã€‚</p><p><code>navigator.clipboard</code>å±æ€§è¿”å› Clipboard å¯¹è±¡ï¼Œæ‰€æœ‰æ“ä½œéƒ½é€šè¿‡è¿™ä¸ªå¯¹è±¡è¿›è¡Œã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> clipboardObj <span class="token operator">=</span> navigator<span class="token punctuation">.</span>clipboard<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¦‚æœ<code>navigator.clipboard</code>å±æ€§è¿”å›<code>undefined</code>ï¼Œå°±è¯´æ˜å½“å‰æµè§ˆå™¨ä¸æ”¯æŒè¿™ä¸ª APIã€‚</p><p>ç”±äºç”¨æˆ·å¯èƒ½æŠŠæ•æ„Ÿæ•°æ®ï¼ˆæ¯”å¦‚å¯†ç ï¼‰æ”¾åœ¨å‰ªè´´æ¿ï¼Œå…è®¸è„šæœ¬ä»»æ„è¯»å–ä¼šäº§ç”Ÿå®‰å…¨é£é™©ï¼Œæ‰€ä»¥è¿™ä¸ª API çš„å®‰å…¨é™åˆ¶æ¯”è¾ƒå¤šã€‚</p><p>é¦–å…ˆï¼ŒChrome æµè§ˆå™¨è§„å®šï¼Œåªæœ‰ HTTPS åè®®çš„é¡µé¢æ‰èƒ½ä½¿ç”¨è¿™ä¸ª APIã€‚ä¸è¿‡ï¼Œå¼€å‘ç¯å¢ƒï¼ˆ<code>localhost</code>ï¼‰å…è®¸ä½¿ç”¨éåŠ å¯†åè®®ã€‚</p><p>å…¶æ¬¡ï¼Œè°ƒç”¨æ—¶éœ€è¦æ˜ç¡®è·å¾—ç”¨æˆ·çš„è®¸å¯ã€‚æƒé™çš„å…·ä½“å®ç°ä½¿ç”¨äº† Permissions APIï¼Œè·Ÿå‰ªè´´æ¿ç›¸å…³çš„æœ‰ä¸¤ä¸ªæƒé™ï¼š<code>clipboard-write</code>ï¼ˆå†™æƒé™ï¼‰å’Œ<code>clipboard-read</code>ï¼ˆè¯»æƒé™ï¼‰ã€‚â€œå†™æƒé™â€è‡ªåŠ¨æˆäºˆè„šæœ¬ï¼Œè€Œâ€œè¯»æƒé™â€å¿…é¡»ç”¨æˆ·æ˜ç¡®åŒæ„ç»™äºˆã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå†™å…¥å‰ªè´´æ¿ï¼Œè„šæœ¬å¯ä»¥è‡ªåŠ¨å®Œæˆï¼Œä½†æ˜¯è¯»å–å‰ªè´´æ¿æ—¶ï¼Œæµè§ˆå™¨ä¼šå¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œè¯¢é—®ç”¨æˆ·æ˜¯å¦åŒæ„è¯»å–ã€‚</p><p><img src="https://xiaou-1305448902.cos.ap-nanjing.myqcloud.com/img/202308071415498.jpg" alt="" loading="lazy"></p><p>å¦å¤–ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè„šæœ¬è¯»å–çš„æ€»æ˜¯å½“å‰é¡µé¢çš„å‰ªè´´æ¿ã€‚è¿™å¸¦æ¥çš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œå¦‚æœæŠŠç›¸å…³çš„ä»£ç ç²˜è´´åˆ°å¼€å‘è€…å·¥å…·ä¸­ç›´æ¥è¿è¡Œï¼Œå¯èƒ½ä¼šæŠ¥é”™ï¼Œå› ä¸ºè¿™æ—¶çš„å½“å‰é¡µé¢æ˜¯å¼€å‘è€…å·¥å…·çš„çª—å£ï¼Œè€Œä¸æ˜¯ç½‘é¡µé¡µé¢ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token keyword">await</span> navigator<span class="token punctuation">.</span>clipboard<span class="token punctuation">.</span><span class="token function">readText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœä½ æŠŠä¸Šé¢çš„ä»£ç ï¼Œç²˜è´´åˆ°å¼€å‘è€…å·¥å…·é‡Œé¢è¿è¡Œï¼Œå°±ä¼šæŠ¥é”™ã€‚å› ä¸ºä»£ç è¿è¡Œçš„æ—¶å€™ï¼Œå¼€å‘è€…å·¥å…·çª—å£æ˜¯å½“å‰é¡µï¼Œè¿™ä¸ªé¡µé¢ä¸å­˜åœ¨ Clipboard API ä¾èµ–çš„ DOM æ¥å£ã€‚ä¸€ä¸ªè§£å†³æ–¹æ³•å°±æ˜¯ï¼Œç›¸å…³ä»£ç æ”¾åˆ°<code>setTimeout()</code>é‡Œé¢å»¶è¿Ÿè¿è¡Œï¼Œåœ¨è°ƒç”¨å‡½æ•°ä¹‹å‰å¿«é€Ÿç‚¹å‡»æµè§ˆå™¨çš„é¡µé¢çª—å£ï¼Œå°†å…¶å˜æˆå½“å‰é¡µã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token keyword">await</span> navigator<span class="token punctuation">.</span>clipboard<span class="token punctuation">.</span><span class="token function">readText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ç²˜è´´åˆ°å¼€å‘è€…å·¥å…·è¿è¡Œåï¼Œå¿«é€Ÿç‚¹å‡»ä¸€ä¸‹ç½‘é¡µçš„é¡µé¢çª—å£ï¼Œä½¿å…¶å˜ä¸ºå½“å‰é¡µï¼Œè¿™æ ·å°±ä¸ä¼šæŠ¥é”™äº†ã€‚</p><h3 id="clipboard-å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#clipboard-å¯¹è±¡" aria-hidden="true">#</a> Clipboard å¯¹è±¡</h3><p>Clipboard å¯¹è±¡æä¾›äº†å››ä¸ªæ–¹æ³•ï¼Œç”¨æ¥è¯»å†™å‰ªè´´æ¿ã€‚å®ƒä»¬éƒ½æ˜¯å¼‚æ­¥æ–¹æ³•ï¼Œè¿”å› Promise å¯¹è±¡ã€‚</p><h4 id="clipboard-readtext" tabindex="-1"><a class="header-anchor" href="#clipboard-readtext" aria-hidden="true">#</a> Clipboard.readText()</h4><p><code>Clipboard.readText()</code>æ–¹æ³•ç”¨äºå¤åˆ¶å‰ªè´´æ¿é‡Œé¢çš„æ–‡æœ¬æ•°æ®ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>
  <span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span>
  <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token keyword">await</span> navigator<span class="token punctuation">.</span>clipboard<span class="token punctuation">.</span><span class="token function">readText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œç”¨æˆ·ç‚¹å‡»é¡µé¢åï¼Œå°±ä¼šè¾“å‡ºå‰ªè´´æ¿é‡Œé¢çš„æ–‡æœ¬ã€‚æ³¨æ„ï¼Œæµè§ˆå™¨è¿™æ—¶ä¼šè·³å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œè¯¢é—®ç”¨æˆ·æ˜¯å¦åŒæ„è„šæœ¬è¯»å–å‰ªè´´æ¿ã€‚</p><p>å¦‚æœç”¨æˆ·ä¸åŒæ„ï¼Œè„šæœ¬å°±ä¼šæŠ¥é”™ã€‚è¿™æ—¶ï¼Œå¯ä»¥ä½¿ç”¨<code>try...catch</code>ç»“æ„ï¼Œå¤„ç†æŠ¥é”™ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getClipboardContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token keyword">await</span> navigator<span class="token punctuation">.</span>clipboard<span class="token punctuation">.</span><span class="token function">readText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Pasted content: &#39;</span><span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;Failed to read clipboard contents: &#39;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="clipboard-read" tabindex="-1"><a class="header-anchor" href="#clipboard-read" aria-hidden="true">#</a> Clipboard.read()</h4><p><code>Clipboard.read()</code>æ–¹æ³•ç”¨äºå¤åˆ¶å‰ªè´´æ¿é‡Œé¢çš„æ•°æ®ï¼Œå¯ä»¥æ˜¯æ–‡æœ¬æ•°æ®ï¼Œä¹Ÿå¯ä»¥æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼ˆæ¯”å¦‚å›¾ç‰‡ï¼‰ã€‚è¯¥æ–¹æ³•éœ€è¦ç”¨æˆ·æ˜ç¡®ç»™äºˆè®¸å¯ã€‚</p><p>è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ã€‚ä¸€æ—¦è¯¥å¯¹è±¡çš„çŠ¶æ€å˜ä¸º resolvedï¼Œå°±å¯ä»¥è·å¾—ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªæ•°ç»„æˆå‘˜éƒ½æ˜¯ ClipboardItem å¯¹è±¡çš„å®ä¾‹ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getClipboardContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> clipboardItems <span class="token operator">=</span> <span class="token keyword">await</span> navigator<span class="token punctuation">.</span>clipboard<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> clipboardItem <span class="token keyword">of</span> clipboardItems<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> type <span class="token keyword">of</span> clipboardItem<span class="token punctuation">.</span>types<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> blob <span class="token operator">=</span> <span class="token keyword">await</span> clipboardItem<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>name<span class="token punctuation">,</span> err<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ClipboardItem å¯¹è±¡è¡¨ç¤ºä¸€ä¸ªå•ç‹¬çš„å‰ªè´´é¡¹ï¼Œæ¯ä¸ªå‰ªè´´é¡¹éƒ½æ‹¥æœ‰<code>ClipboardItem.types</code>å±æ€§å’Œ<code>ClipboardItem.getType()</code>æ–¹æ³•ã€‚</p><p><code>ClipboardItem.types</code>å±æ€§è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œé‡Œé¢çš„æˆå‘˜æ˜¯è¯¥å‰ªè´´é¡¹å¯ç”¨çš„ MIME ç±»å‹ï¼Œæ¯”å¦‚æŸä¸ªå‰ªè´´é¡¹å¯ä»¥ç”¨ HTML æ ¼å¼ç²˜è´´ï¼Œä¹Ÿå¯ä»¥ç”¨çº¯æ–‡æœ¬æ ¼å¼ç²˜è´´ï¼Œé‚£ä¹ˆå®ƒå°±æœ‰ä¸¤ä¸ª MIME ç±»å‹ï¼ˆ<code>text/html</code>å’Œ<code>text/plain</code>ï¼‰ã€‚</p><p><code>ClipboardItem.getType(type)</code>æ–¹æ³•ç”¨äºè¯»å–å‰ªè´´é¡¹çš„æ•°æ®ï¼Œè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ã€‚è¯¥æ–¹æ³•æ¥å—å‰ªè´´é¡¹çš„ MIME ç±»å‹ä½œä¸ºå‚æ•°ï¼Œè¿”å›è¯¥ç±»å‹çš„æ•°æ®ï¼Œè¯¥å‚æ•°æ˜¯å¿…éœ€çš„ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</p><h4 id="clipboard-writetext" tabindex="-1"><a class="header-anchor" href="#clipboard-writetext" aria-hidden="true">#</a> Clipboard.writeText()</h4><p><code>Clipboard.writeText()</code>æ–¹æ³•ç”¨äºå°†æ–‡æœ¬å†…å®¹å†™å…¥å‰ªè´´æ¿ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>
  <span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span>
  <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> navigator<span class="token punctuation">.</span>clipboard<span class="token punctuation">.</span><span class="token function">writeText</span><span class="token punctuation">(</span><span class="token string">&#39;Yo&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ç¤ºä¾‹æ˜¯ç”¨æˆ·åœ¨ç½‘é¡µç‚¹å‡»åï¼Œè„šæœ¬å‘å‰ªè´´æ¿å†™å…¥æ–‡æœ¬æ•°æ®ã€‚</p><p>è¯¥æ–¹æ³•ä¸éœ€è¦ç”¨æˆ·è®¸å¯ï¼Œä½†æ˜¯æœ€å¥½ä¹Ÿæ”¾åœ¨<code>try...catch</code>é‡Œé¢é˜²æ­¢æŠ¥é”™ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">copyPageUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> navigator<span class="token punctuation">.</span>clipboard<span class="token punctuation">.</span><span class="token function">writeText</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>href<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Page URL copied to clipboard&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;Failed to copy: &#39;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="clipboard-write" tabindex="-1"><a class="header-anchor" href="#clipboard-write" aria-hidden="true">#</a> Clipboard.write()</h4><p><code>Clipboard.write()</code>æ–¹æ³•ç”¨äºå°†ä»»æ„æ•°æ®å†™å…¥å‰ªè´´æ¿ï¼Œå¯ä»¥æ˜¯æ–‡æœ¬æ•°æ®ï¼Œä¹Ÿå¯ä»¥æ˜¯äºŒè¿›åˆ¶æ•°æ®ã€‚</p><p>è¯¥æ–¹æ³•æ¥å—ä¸€ä¸ª ClipboardItem å®ä¾‹ä½œä¸ºå‚æ•°ï¼Œè¡¨ç¤ºå†™å…¥å‰ªè´´æ¿çš„æ•°æ®ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> imgURL <span class="token operator">=</span> <span class="token string">&#39;https://dummyimage.com/300.png&#39;</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>imgURL<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> blob <span class="token operator">=</span> <span class="token keyword">await</span> data<span class="token punctuation">.</span><span class="token function">blob</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> navigator<span class="token punctuation">.</span>clipboard<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">ClipboardItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token punctuation">[</span>blob<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token operator">:</span> blob
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Image copied.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>name<span class="token punctuation">,</span> err<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œè„šæœ¬å‘å‰ªè´´æ¿å†™å…¥äº†ä¸€å¼ å›¾ç‰‡ã€‚æ³¨æ„ï¼ŒChrome æµè§ˆå™¨ç›®å‰åªæ”¯æŒå†™å…¥ PNG æ ¼å¼çš„å›¾ç‰‡ã€‚</p><p><code>ClipboardItem()</code>æ˜¯æµè§ˆå™¨åŸç”Ÿæä¾›çš„æ„é€ å‡½æ•°ï¼Œç”¨æ¥ç”Ÿæˆ<code>ClipboardItem</code>å®ä¾‹ï¼Œå®ƒæ¥å—ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œè¯¥å¯¹è±¡çš„é”®åæ˜¯æ•°æ®çš„ MIME ç±»å‹ï¼Œé”®å€¼å°±æ˜¯æ•°æ®æœ¬èº«ã€‚</p><p>ä¸‹é¢çš„ä¾‹å­æ˜¯å°†åŒä¸€ä¸ªå‰ªè´´é¡¹çš„å¤šç§æ ¼å¼çš„å€¼ï¼Œå†™å…¥å‰ªè´´æ¿ï¼Œä¸€ç§æ˜¯æ–‡æœ¬æ•°æ®ï¼Œå¦ä¸€ç§æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œä¾›ä¸åŒçš„åœºåˆç²˜è´´ä½¿ç”¨ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">copy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> image <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;kitten.png&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;Cute sleeping kitten&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;text/plain&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> item <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClipboardItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string-property property">&#39;text/plain&#39;</span><span class="token operator">:</span> text<span class="token punctuation">,</span>
    <span class="token string-property property">&#39;image/png&#39;</span><span class="token operator">:</span> image
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> navigator<span class="token punctuation">.</span>clipboard<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="copy-äº‹ä»¶-cut-äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#copy-äº‹ä»¶-cut-äº‹ä»¶" aria-hidden="true">#</a> copy äº‹ä»¶ï¼Œcut äº‹ä»¶</h3><p>ç”¨æˆ·å‘å‰ªè´´æ¿æ”¾å…¥æ•°æ®æ—¶ï¼Œå°†è§¦å‘<code>copy</code>äº‹ä»¶ã€‚</p><p>ä¸‹é¢çš„ç¤ºä¾‹æ˜¯å°†ç”¨æˆ·æ”¾å…¥å‰ªè´´æ¿çš„æ–‡æœ¬ï¼Œè½¬ä¸ºå¤§å†™ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> source <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.source&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

source<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;copy&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> selection <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getSelection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  event<span class="token punctuation">.</span>clipboardData<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token string">&#39;text/plain&#39;</span><span class="token punctuation">,</span> selection<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œäº‹ä»¶å¯¹è±¡çš„<code>clipboardData</code>å±æ€§åŒ…å«äº†å‰ªè´´æ¿æ•°æ®ã€‚å®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæœ‰ä»¥ä¸‹å±æ€§å’Œæ–¹æ³•ã€‚</p><ul><li><code>Event.clipboardData.setData(type, data)</code>ï¼šä¿®æ”¹å‰ªè´´æ¿æ•°æ®ï¼Œéœ€è¦æŒ‡å®šæ•°æ®ç±»å‹ã€‚</li><li><code>Event.clipboardData.getData(type)</code>ï¼šè·å–å‰ªè´´æ¿æ•°æ®ï¼Œéœ€è¦æŒ‡å®šæ•°æ®ç±»å‹ã€‚</li><li><code>Event.clipboardData.clearData([type])</code>ï¼šæ¸…é™¤å‰ªè´´æ¿æ•°æ®ï¼Œå¯ä»¥æŒ‡å®šæ•°æ®ç±»å‹ã€‚å¦‚æœä¸æŒ‡å®šç±»å‹ï¼Œå°†æ¸…é™¤æ‰€æœ‰ç±»å‹çš„æ•°æ®ã€‚</li><li><code>Event.clipboardData.items</code>ï¼šä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼ŒåŒ…å«äº†æ‰€æœ‰å‰ªè´´é¡¹ï¼Œä¸è¿‡é€šå¸¸åªæœ‰ä¸€ä¸ªå‰ªè´´é¡¹ã€‚</li></ul><p>ä¸‹é¢çš„ç¤ºä¾‹æ˜¯æ‹¦æˆªç”¨æˆ·çš„å¤åˆ¶æ“ä½œï¼Œå°†æŒ‡å®šå†…å®¹æ”¾å…¥å‰ªè´´æ¿ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> clipboardItems <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;copy&#39;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> clipboardItems <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> item <span class="token keyword">of</span> e<span class="token punctuation">.</span>clipboardData<span class="token punctuation">.</span>items<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>item<span class="token punctuation">.</span>type<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&#39;image/&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">continue</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      clipboardItems<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
        <span class="token keyword">new</span> <span class="token class-name">ClipboardItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token punctuation">[</span>item<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token operator">:</span> item<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">await</span> navigator<span class="token punctuation">.</span>clipboard<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>clipboardItems<span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Image copied.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>name<span class="token punctuation">,</span> err<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå…ˆä½¿ç”¨<code>e.preventDefault()</code>å–æ¶ˆäº†å‰ªè´´æ¿çš„é»˜è®¤æ“ä½œï¼Œç„¶åç”±è„šæœ¬æ¥ç®¡å¤åˆ¶æ“ä½œã€‚</p><p><code>cut</code>äº‹ä»¶åˆ™æ˜¯åœ¨ç”¨æˆ·è¿›è¡Œå‰ªåˆ‡æ“ä½œæ—¶è§¦å‘ï¼Œå®ƒçš„å¤„ç†è·Ÿ<code>copy</code>äº‹ä»¶å®Œå…¨ä¸€æ ·ï¼Œä¹Ÿæ˜¯ä»<code>Event.clipboardData</code>å±æ€§æ‹¿åˆ°å‰ªåˆ‡çš„æ•°æ®ã€‚</p><h3 id="paste-äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#paste-äº‹ä»¶" aria-hidden="true">#</a> paste äº‹ä»¶</h3><p>ç”¨æˆ·ä½¿ç”¨å‰ªè´´æ¿æ•°æ®ï¼Œè¿›è¡Œç²˜è´´æ“ä½œæ—¶ï¼Œä¼šè§¦å‘<code>paste</code>äº‹ä»¶ã€‚</p><p>ä¸‹é¢çš„ç¤ºä¾‹æ˜¯æ‹¦æˆªç²˜è´´æ“ä½œï¼Œç”±è„šæœ¬å°†å‰ªè´´æ¿é‡Œé¢çš„æ•°æ®å–å‡ºæ¥ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;paste&#39;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token keyword">await</span> navigator<span class="token punctuation">.</span>clipboard<span class="token punctuation">.</span><span class="token function">readText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Pasted text: &#39;</span><span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å‚è€ƒé“¾æ¥-1" tabindex="-1"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥-1" aria-hidden="true">#</a> å‚è€ƒé“¾æ¥</h3><ul><li><a href="https://web.dev/async-clipboard/" target="_blank" rel="noopener noreferrer">Unblocking clipboard access<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Interact_with_the_clipboard" target="_blank" rel="noopener noreferrer">Interact with the clipboard<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://blog.tomayac.com/2020/03/20/multi-mime-type-copying-with-the-async-clipboard-api/" target="_blank" rel="noopener noreferrer">Multi-MIME Type Copying with the Async Clipboard API<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h2 id="fetch-api-æ•™ç¨‹" tabindex="-1"><a class="header-anchor" href="#fetch-api-æ•™ç¨‹" aria-hidden="true">#</a> Fetch API æ•™ç¨‹</h2><p><code>fetch()</code>æ˜¯ XMLHttpRequest çš„å‡çº§ç‰ˆï¼Œç”¨äºåœ¨ JavaScript è„šæœ¬é‡Œé¢å‘å‡º HTTP è¯·æ±‚ã€‚</p><p>æµè§ˆå™¨åŸç”Ÿæä¾›è¿™ä¸ªå¯¹è±¡ã€‚æœ¬ç« è¯¦ç»†ä»‹ç»å®ƒçš„ç”¨æ³•ã€‚</p><h3 id="åŸºæœ¬ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ç”¨æ³•" aria-hidden="true">#</a> åŸºæœ¬ç”¨æ³•</h3><p><code>fetch()</code>çš„åŠŸèƒ½ä¸ XMLHttpRequest åŸºæœ¬ç›¸åŒï¼Œä½†æœ‰ä¸‰ä¸ªä¸»è¦çš„å·®å¼‚ã€‚</p><p>ï¼ˆ1ï¼‰<code>fetch()</code>ä½¿ç”¨ Promiseï¼Œä¸ä½¿ç”¨å›è°ƒå‡½æ•°ï¼Œå› æ­¤å¤§å¤§ç®€åŒ–äº†å†™æ³•ï¼Œå†™èµ·æ¥æ›´ç®€æ´ã€‚</p><p>ï¼ˆ2ï¼‰<code>fetch()</code>é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼ŒAPI åˆ†æ•£åœ¨å¤šä¸ªå¯¹è±¡ä¸Šï¼ˆResponse å¯¹è±¡ã€Request å¯¹è±¡ã€Headers å¯¹è±¡ï¼‰ï¼Œæ›´åˆç†ä¸€äº›ï¼›ç›¸æ¯”ä¹‹ä¸‹ï¼ŒXMLHttpRequest çš„ API è®¾è®¡å¹¶ä¸æ˜¯å¾ˆå¥½ï¼Œè¾“å…¥ã€è¾“å‡ºã€çŠ¶æ€éƒ½åœ¨åŒä¸€ä¸ªæ¥å£ç®¡ç†ï¼Œå®¹æ˜“å†™å‡ºéå¸¸æ··ä¹±çš„ä»£ç ã€‚</p><p>ï¼ˆ3ï¼‰<code>fetch()</code>é€šè¿‡æ•°æ®æµï¼ˆStream å¯¹è±¡ï¼‰å¤„ç†æ•°æ®ï¼Œå¯ä»¥åˆ†å—è¯»å–ï¼Œæœ‰åˆ©äºæé«˜ç½‘ç«™æ€§èƒ½è¡¨ç°ï¼Œå‡å°‘å†…å­˜å ç”¨ï¼Œå¯¹äºè¯·æ±‚å¤§æ–‡ä»¶æˆ–è€…ç½‘é€Ÿæ…¢çš„åœºæ™¯ç›¸å½“æœ‰ç”¨ã€‚XMLHTTPRequest å¯¹è±¡ä¸æ”¯æŒæ•°æ®æµï¼Œæ‰€æœ‰çš„æ•°æ®å¿…é¡»æ”¾åœ¨ç¼“å­˜é‡Œï¼Œä¸æ”¯æŒåˆ†å—è¯»å–ï¼Œå¿…é¡»ç­‰å¾…å…¨éƒ¨æ‹¿åˆ°åï¼Œå†ä¸€æ¬¡æ€§åå‡ºæ¥ã€‚</p><p>åœ¨ç”¨æ³•ä¸Šï¼Œ<code>fetch()</code>æ¥å—ä¸€ä¸ª URL å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œé»˜è®¤å‘è¯¥ç½‘å€å‘å‡º GET è¯·æ±‚ï¼Œè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ã€‚å®ƒçš„åŸºæœ¬ç”¨æ³•å¦‚ä¸‹ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œä»æœåŠ¡å™¨è·å– JSON æ•°æ®ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;https://api.github.com/users/ruanyf&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">json</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Request Failed&#39;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ<code>fetch()</code>æ¥æ”¶åˆ°çš„<code>response</code>æ˜¯ä¸€ä¸ª <a href="https://developer.mozilla.org/en-US/docs/Web/API/Streams_API" target="_blank" rel="noopener noreferrer">Stream å¯¹è±¡<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œ<code>response.json()</code>æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œå–å‡ºæ‰€æœ‰å†…å®¹ï¼Œå¹¶å°†å…¶è½¬ä¸º JSON å¯¹è±¡ã€‚</p><p>Promise å¯ä»¥ä½¿ç”¨ await è¯­æ³•æ”¹å†™ï¼Œä½¿å¾—è¯­ä¹‰æ›´æ¸…æ™°ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token string">&#39;https://api.github.com/users/ruanyf&#39;</span><span class="token punctuation">;</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Request Failed&#39;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ<code>await</code>è¯­å¥å¿…é¡»æ”¾åœ¨<code>try...catch</code>é‡Œé¢ï¼Œè¿™æ ·æ‰èƒ½æ•æ‰å¼‚æ­¥æ“ä½œä¸­å¯èƒ½å‘ç”Ÿçš„é”™è¯¯ã€‚</p><p>åæ–‡éƒ½é‡‡ç”¨<code>await</code>çš„å†™æ³•ï¼Œä¸ä½¿ç”¨<code>.then()</code>çš„å†™æ³•ã€‚</p><h3 id="response-å¯¹è±¡-å¤„ç†-http-å›åº”" tabindex="-1"><a class="header-anchor" href="#response-å¯¹è±¡-å¤„ç†-http-å›åº”" aria-hidden="true">#</a> Response å¯¹è±¡ï¼šå¤„ç† HTTP å›åº”</h3><h4 id="response-å¯¹è±¡çš„åŒæ­¥å±æ€§" tabindex="-1"><a class="header-anchor" href="#response-å¯¹è±¡çš„åŒæ­¥å±æ€§" aria-hidden="true">#</a> Response å¯¹è±¡çš„åŒæ­¥å±æ€§</h4><p><code>fetch()</code>è¯·æ±‚æˆåŠŸä»¥åï¼Œå¾—åˆ°çš„æ˜¯ä¸€ä¸ª <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response" target="_blank" rel="noopener noreferrer">Response å¯¹è±¡<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ã€‚å®ƒå¯¹åº”æœåŠ¡å™¨çš„ HTTP å›åº”ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å‰é¢è¯´è¿‡ï¼ŒResponse åŒ…å«çš„æ•°æ®é€šè¿‡ Stream æ¥å£å¼‚æ­¥è¯»å–ï¼Œä½†æ˜¯å®ƒè¿˜åŒ…å«ä¸€äº›åŒæ­¥å±æ€§ï¼Œå¯¹åº” HTTP å›åº”çš„æ ‡å¤´ä¿¡æ¯ï¼ˆHeadersï¼‰ï¼Œå¯ä»¥ç«‹å³è¯»å–ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fetchText</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;/readme.txt&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>statusText<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ<code>response.status</code>å’Œ<code>response.statusText</code>å°±æ˜¯ Response çš„åŒæ­¥å±æ€§ï¼Œå¯ä»¥ç«‹å³è¯»å–ã€‚</p><p>æ ‡å¤´ä¿¡æ¯å±æ€§æœ‰ä¸‹é¢è¿™äº›ã€‚</p><p><strong>Response.ok</strong></p><p><code>Response.ok</code>å±æ€§è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¯·æ±‚æ˜¯å¦æˆåŠŸï¼Œ<code>true</code>å¯¹åº” HTTP è¯·æ±‚çš„çŠ¶æ€ç  200 åˆ° 299ï¼Œ<code>false</code>å¯¹åº”å…¶ä»–çš„çŠ¶æ€ç ã€‚</p><p><strong>Response.status</strong></p><p><code>Response.status</code>å±æ€§è¿”å›ä¸€ä¸ªæ•°å­—ï¼Œè¡¨ç¤º HTTP å›åº”çš„çŠ¶æ€ç ï¼ˆä¾‹å¦‚200ï¼Œè¡¨ç¤ºæˆåŠŸè¯·æ±‚ï¼‰ã€‚</p><p><strong>Response.statusText</strong></p><p><code>Response.statusText</code>å±æ€§è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤º HTTP å›åº”çš„çŠ¶æ€ä¿¡æ¯ï¼ˆä¾‹å¦‚è¯·æ±‚æˆåŠŸä»¥åï¼ŒæœåŠ¡å™¨è¿”å›â€œOKâ€ï¼‰ã€‚</p><p><strong>Response.url</strong></p><p><code>Response.url</code>å±æ€§è¿”å›è¯·æ±‚çš„ URLã€‚å¦‚æœ URL å­˜åœ¨è·³è½¬ï¼Œè¯¥å±æ€§è¿”å›çš„æ˜¯æœ€ç»ˆ URLã€‚</p><p><strong>Response.type</strong></p><p><code>Response.type</code>å±æ€§è¿”å›è¯·æ±‚çš„ç±»å‹ã€‚å¯èƒ½çš„å€¼å¦‚ä¸‹ï¼š</p><ul><li><code>basic</code>ï¼šæ™®é€šè¯·æ±‚ï¼Œå³åŒæºè¯·æ±‚ã€‚</li><li><code>cors</code>ï¼šè·¨æºè¯·æ±‚ã€‚</li><li><code>error</code>ï¼šç½‘ç»œé”™è¯¯ï¼Œä¸»è¦ç”¨äº Service Workerã€‚</li><li><code>opaque</code>ï¼šå¦‚æœ<code>fetch()</code>è¯·æ±‚çš„<code>type</code>å±æ€§è®¾ä¸º<code>no-cors</code>ï¼Œå°±ä¼šè¿”å›è¿™ä¸ªå€¼ï¼Œè¯¦è§è¯·æ±‚éƒ¨åˆ†ã€‚è¡¨ç¤ºå‘å‡ºçš„æ˜¯ç®€å•çš„è·¨æºè¯·æ±‚ï¼Œç±»ä¼¼<code>&lt;form&gt;</code>è¡¨å•çš„é‚£ç§è·¨æºè¯·æ±‚ã€‚</li><li><code>opaqueredirect</code>ï¼šå¦‚æœ<code>fetch()</code>è¯·æ±‚çš„<code>redirect</code>å±æ€§è®¾ä¸º<code>manual</code>ï¼Œå°±ä¼šè¿”å›è¿™ä¸ªå€¼ï¼Œè¯¦è§è¯·æ±‚éƒ¨åˆ†ã€‚</li></ul><p><strong>Response.redirected</strong></p><p><code>Response.redirected</code>å±æ€§è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¯·æ±‚æ˜¯å¦å‘ç”Ÿè¿‡è·³è½¬ã€‚</p><h4 id="åˆ¤æ–­è¯·æ±‚æ˜¯å¦æˆåŠŸ" tabindex="-1"><a class="header-anchor" href="#åˆ¤æ–­è¯·æ±‚æ˜¯å¦æˆåŠŸ" aria-hidden="true">#</a> åˆ¤æ–­è¯·æ±‚æ˜¯å¦æˆåŠŸ</h4><p><code>fetch()</code>å‘å‡ºè¯·æ±‚ä»¥åï¼Œæœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„æ³¨æ„ç‚¹ï¼šåªæœ‰ç½‘ç»œé”™è¯¯ï¼Œæˆ–è€…æ— æ³•è¿æ¥æ—¶ï¼Œ<code>fetch()</code>æ‰ä¼šæŠ¥é”™ï¼Œå…¶ä»–æƒ…å†µéƒ½ä¸ä¼šæŠ¥é”™ï¼Œè€Œæ˜¯è®¤ä¸ºè¯·æ±‚æˆåŠŸã€‚</p><p>è¿™å°±æ˜¯è¯´ï¼Œå³ä½¿æœåŠ¡å™¨è¿”å›çš„çŠ¶æ€ç æ˜¯ 4xx æˆ– 5xxï¼Œ<code>fetch()</code>ä¹Ÿä¸ä¼šæŠ¥é”™ï¼ˆå³ Promise ä¸ä¼šå˜ä¸º <code>rejected</code>çŠ¶æ€ï¼‰ã€‚</p><p>åªæœ‰é€šè¿‡<code>Response.status</code>å±æ€§ï¼Œå¾—åˆ° HTTP å›åº”çš„çœŸå®çŠ¶æ€ç ï¼Œæ‰èƒ½åˆ¤æ–­è¯·æ±‚æ˜¯å¦æˆåŠŸã€‚è¯·çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fetchText</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;/readme.txt&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>status <span class="token operator">&gt;=</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> response<span class="token punctuation">.</span>status <span class="token operator">&lt;</span> <span class="token number">300</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>statusText<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ<code>response.status</code>å±æ€§åªæœ‰ç­‰äº 2xx ï¼ˆ200~299ï¼‰ï¼Œæ‰èƒ½è®¤å®šè¯·æ±‚æˆåŠŸã€‚è¿™é‡Œä¸ç”¨è€ƒè™‘ç½‘å€è·³è½¬ï¼ˆçŠ¶æ€ç ä¸º 3xxï¼‰ï¼Œå› ä¸º<code>fetch()</code>ä¼šå°†è·³è½¬çš„çŠ¶æ€ç è‡ªåŠ¨è½¬ä¸º 200ã€‚</p><p>å¦ä¸€ç§æ–¹æ³•æ˜¯åˆ¤æ–­<code>response.ok</code>æ˜¯å¦ä¸º<code>true</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// è¯·æ±‚æˆåŠŸ</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token comment">// è¯·æ±‚å¤±è´¥</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="response-headers-å±æ€§" tabindex="-1"><a class="header-anchor" href="#response-headers-å±æ€§" aria-hidden="true">#</a> Response.headers å±æ€§</h4><p>Response å¯¹è±¡è¿˜æœ‰ä¸€ä¸ª<code>Response.headers</code>å±æ€§ï¼ŒæŒ‡å‘ä¸€ä¸ª <a href="https://developer.mozilla.org/en-US/docs/Web/API/Headers" target="_blank" rel="noopener noreferrer">Headers å¯¹è±¡<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œå¯¹åº” HTTP å›åº”çš„æ‰€æœ‰æ ‡å¤´ã€‚</p><p>Headers å¯¹è±¡å¯ä»¥ä½¿ç”¨<code>for...of</code>å¾ªç¯è¿›è¡Œéå†ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> value<span class="token punctuation">]</span> <span class="token keyword">of</span> response<span class="token punctuation">.</span>headers<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> : </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// æˆ–è€…</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> value<span class="token punctuation">]</span> <span class="token keyword">of</span> response<span class="token punctuation">.</span>headers<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> : </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Headers å¯¹è±¡æä¾›äº†ä»¥ä¸‹æ–¹æ³•ï¼Œç”¨æ¥æ“ä½œæ ‡å¤´ã€‚</p><blockquote><ul><li><code>Headers.get()</code>ï¼šæ ¹æ®æŒ‡å®šçš„é”®åï¼Œè¿”å›é”®å€¼ã€‚</li><li><code>Headers.has()</code>ï¼š è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦åŒ…å«æŸä¸ªæ ‡å¤´ã€‚</li><li><code>Headers.set()</code>ï¼šå°†æŒ‡å®šçš„é”®åè®¾ç½®ä¸ºæ–°çš„é”®å€¼ï¼Œå¦‚æœè¯¥é”®åä¸å­˜åœ¨åˆ™ä¼šæ·»åŠ ã€‚</li><li><code>Headers.append()</code>ï¼šæ·»åŠ æ ‡å¤´ã€‚</li><li><code>Headers.delete()</code>ï¼šåˆ é™¤æ ‡å¤´ã€‚</li><li><code>Headers.keys()</code>ï¼šè¿”å›ä¸€ä¸ªéå†å™¨ï¼Œå¯ä»¥ä¾æ¬¡éå†æ‰€æœ‰é”®åã€‚</li><li><code>Headers.values()</code>ï¼šè¿”å›ä¸€ä¸ªéå†å™¨ï¼Œå¯ä»¥ä¾æ¬¡éå†æ‰€æœ‰é”®å€¼ã€‚</li><li><code>Headers.entries()</code>ï¼šè¿”å›ä¸€ä¸ªéå†å™¨ï¼Œå¯ä»¥ä¾æ¬¡éå†æ‰€æœ‰é”®å€¼å¯¹ï¼ˆ<code>[key, value]</code>ï¼‰ã€‚</li><li><code>Headers.forEach()</code>ï¼šä¾æ¬¡éå†æ ‡å¤´ï¼Œæ¯ä¸ªæ ‡å¤´éƒ½ä¼šæ‰§è¡Œä¸€æ¬¡å‚æ•°å‡½æ•°ã€‚</li></ul></blockquote><p>ä¸Šé¢çš„æœ‰äº›æ–¹æ³•å¯ä»¥ä¿®æ”¹æ ‡å¤´ï¼Œé‚£æ˜¯å› ä¸ºç»§æ‰¿è‡ª Headers æ¥å£ã€‚å¯¹äº HTTP å›åº”æ¥è¯´ï¼Œä¿®æ”¹æ ‡å¤´æ„ä¹‰ä¸å¤§ï¼Œå†µä¸”å¾ˆå¤šæ ‡å¤´æ˜¯åªè¯»çš„ï¼Œæµè§ˆå™¨ä¸å…è®¸ä¿®æ”¹ã€‚</p><p>è¿™äº›æ–¹æ³•ä¸­ï¼Œæœ€å¸¸ç”¨çš„æ˜¯<code>response.headers.get()</code>ï¼Œç”¨äºè¯»å–æŸä¸ªæ ‡å¤´çš„å€¼ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">let</span> response <span class="token operator">=</span>  <span class="token keyword">await</span>  <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
response<span class="token punctuation">.</span>headers<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;Content-Type&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// application/json; charset=utf-8</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>Headers.keys()</code>å’Œ<code>Headers.values()</code>æ–¹æ³•ç”¨æ¥åˆ†åˆ«éå†æ ‡å¤´çš„é”®åå’Œé”®å€¼ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// é”®å</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">of</span> myHeaders<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// é”®å€¼</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> value <span class="token keyword">of</span> myHeaders<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>Headers.forEach()</code>æ–¹æ³•ä¹Ÿå¯ä»¥éå†æ‰€æœ‰çš„é”®å€¼å’Œé”®åã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">let</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
response<span class="token punctuation">.</span>headers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token string">&#39;:&#39;</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="è¯»å–å†…å®¹çš„æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#è¯»å–å†…å®¹çš„æ–¹æ³•" aria-hidden="true">#</a> è¯»å–å†…å®¹çš„æ–¹æ³•</h4><p><code>Response</code>å¯¹è±¡æ ¹æ®æœåŠ¡å™¨è¿”å›çš„ä¸åŒç±»å‹çš„æ•°æ®ï¼Œæä¾›äº†ä¸åŒçš„è¯»å–æ–¹æ³•ã€‚</p><blockquote><ul><li><code>response.text()</code>ï¼šå¾—åˆ°æ–‡æœ¬å­—ç¬¦ä¸²ã€‚</li><li><code>response.json()</code>ï¼šå¾—åˆ° JSON å¯¹è±¡ã€‚</li><li><code>response.blob()</code>ï¼šå¾—åˆ°äºŒè¿›åˆ¶ Blob å¯¹è±¡ã€‚</li><li><code>response.formData()</code>ï¼šå¾—åˆ° FormData è¡¨å•å¯¹è±¡ã€‚</li><li><code>response.arrayBuffer()</code>ï¼šå¾—åˆ°äºŒè¿›åˆ¶ ArrayBuffer å¯¹è±¡ã€‚</li></ul></blockquote><p>ä¸Šé¢5ä¸ªè¯»å–æ–¹æ³•éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œè¿”å›çš„éƒ½æ˜¯ Promise å¯¹è±¡ã€‚å¿…é¡»ç­‰åˆ°å¼‚æ­¥æ“ä½œç»“æŸï¼Œæ‰èƒ½å¾—åˆ°æœåŠ¡å™¨è¿”å›çš„å®Œæ•´æ•°æ®ã€‚</p><p><strong>response.text()</strong></p><p><code>response.text()</code>å¯ä»¥ç”¨äºè·å–æ–‡æœ¬æ•°æ®ï¼Œæ¯”å¦‚ HTML æ–‡ä»¶ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;/users.html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> body <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> body
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>response.json()</strong></p><p><code>response.json()</code>ä¸»è¦ç”¨äºè·å–æœåŠ¡å™¨è¿”å›çš„ JSON æ•°æ®ï¼Œå‰é¢å·²ç»ä¸¾è¿‡ä¾‹å­äº†ã€‚</p><p><strong>response.formData()</strong></p><p><code>response.formData()</code>ä¸»è¦ç”¨åœ¨ Service Worker é‡Œé¢ï¼Œæ‹¦æˆªç”¨æˆ·æäº¤çš„è¡¨å•ï¼Œä¿®æ”¹æŸäº›æ•°æ®ä»¥åï¼Œå†æäº¤ç»™æœåŠ¡å™¨ã€‚</p><p><strong>response.blob()</strong></p><p><code>response.blob()</code>ç”¨äºè·å–äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;flower.jpg&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> myBlob <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">blob</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> objectURL <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>myBlob<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> myImage <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;img&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
myImage<span class="token punctuation">.</span>src <span class="token operator">=</span> objectURL<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ç¤ºä¾‹è¯»å–å›¾ç‰‡æ–‡ä»¶<code>flower.jpg</code>ï¼Œæ˜¾ç¤ºåœ¨ç½‘é¡µä¸Šã€‚</p><p><strong>response.arrayBuffer()</strong></p><p><code>response.arrayBuffer()</code>ä¸»è¦ç”¨äºè·å–æµåª’ä½“æ–‡ä»¶ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> audioCtx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">window<span class="token punctuation">.</span>AudioContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> source <span class="token operator">=</span> audioCtx<span class="token punctuation">.</span><span class="token function">createBufferSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;song.ogg&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> buffer <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">arrayBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> decodeData <span class="token operator">=</span> <span class="token keyword">await</span> audioCtx<span class="token punctuation">.</span><span class="token function">decodeAudioData</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
source<span class="token punctuation">.</span>buffer <span class="token operator">=</span> buffer<span class="token punctuation">;</span>
source<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>audioCtx<span class="token punctuation">.</span>destination<span class="token punctuation">)</span><span class="token punctuation">;</span>
source<span class="token punctuation">.</span>loop <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ç¤ºä¾‹æ˜¯<code>response.arrayBuffer()</code>è·å–éŸ³é¢‘æ–‡ä»¶<code>song.ogg</code>ï¼Œç„¶ååœ¨çº¿æ’­æ”¾çš„ä¾‹å­ã€‚</p><h4 id="response-clone" tabindex="-1"><a class="header-anchor" href="#response-clone" aria-hidden="true">#</a> Response.clone()</h4><p>Stream å¯¹è±¡åªèƒ½è¯»å–ä¸€æ¬¡ï¼Œè¯»å–å®Œå°±æ²¡äº†ã€‚è¿™æ„å‘³ç€ï¼Œå‰ä¸€èŠ‚çš„äº”ä¸ªè¯»å–æ–¹æ³•ï¼Œåªèƒ½ä½¿ç”¨ä¸€ä¸ªï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">let</span> text <span class="token operator">=</span>  <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> json <span class="token operator">=</span>  <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// æŠ¥é”™</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ç¤ºä¾‹å…ˆä½¿ç”¨äº†<code>response.text()</code>ï¼Œå°±æŠŠ Stream è¯»å®Œäº†ã€‚åé¢å†è°ƒç”¨<code>response.json()</code>ï¼Œå°±æ²¡æœ‰å†…å®¹å¯è¯»äº†ï¼Œæ‰€ä»¥æŠ¥é”™ã€‚</p><p>Response å¯¹è±¡æä¾›<code>Response.clone()</code>æ–¹æ³•ï¼Œåˆ›å»º<code>Response</code>å¯¹è±¡çš„å‰¯æœ¬ï¼Œå®ç°å¤šæ¬¡è¯»å–ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> response1 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;flowers.jpg&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> response2 <span class="token operator">=</span> response1<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> myBlob1 <span class="token operator">=</span> <span class="token keyword">await</span> response1<span class="token punctuation">.</span><span class="token function">blob</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> myBlob2 <span class="token operator">=</span> <span class="token keyword">await</span> response2<span class="token punctuation">.</span><span class="token function">blob</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

image1<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>myBlob1<span class="token punctuation">)</span><span class="token punctuation">;</span>
image2<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>myBlob2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ<code>response.clone()</code>å¤åˆ¶äº†ä¸€ä»½ Response å¯¹è±¡ï¼Œç„¶åå°†åŒä¸€å¼ å›¾ç‰‡è¯»å–äº†ä¸¤æ¬¡ã€‚</p><p>Response å¯¹è±¡è¿˜æœ‰ä¸€ä¸ª<code>Response.redirect()</code>æ–¹æ³•ï¼Œç”¨äºå°† Response ç»“æœé‡å®šå‘åˆ°æŒ‡å®šçš„ URLã€‚è¯¥æ–¹æ³•ä¸€èˆ¬åªç”¨åœ¨ Service Worker é‡Œé¢ï¼Œè¿™é‡Œå°±ä¸ä»‹ç»äº†ã€‚</p><h4 id="response-body-å±æ€§" tabindex="-1"><a class="header-anchor" href="#response-body-å±æ€§" aria-hidden="true">#</a> Response.body å±æ€§</h4><p><code>Response.body</code>å±æ€§æ˜¯ Response å¯¹è±¡æš´éœ²å‡ºçš„åº•å±‚æ¥å£ï¼Œè¿”å›ä¸€ä¸ª ReadableStream å¯¹è±¡ï¼Œä¾›ç”¨æˆ·æ“ä½œã€‚</p><p>å®ƒå¯ä»¥ç”¨æ¥åˆ†å—è¯»å–å†…å®¹ï¼Œåº”ç”¨ä¹‹ä¸€å°±æ˜¯æ˜¾ç¤ºä¸‹è½½çš„è¿›åº¦ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;flower.jpg&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> reader <span class="token operator">=</span> response<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">getReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span>done<span class="token punctuation">,</span> value<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> reader<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>done<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Received </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token punctuation">.</span>length<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> bytes</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ<code>response.body.getReader()</code>æ–¹æ³•è¿”å›ä¸€ä¸ªéå†å™¨ã€‚è¿™ä¸ªéå†å™¨çš„<code>read()</code>æ–¹æ³•æ¯æ¬¡è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¡¨ç¤ºæœ¬æ¬¡è¯»å–çš„å†…å®¹å—ã€‚</p><p>è¿™ä¸ªå¯¹è±¡çš„<code>done</code>å±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œç”¨æ¥åˆ¤æ–­æœ‰æ²¡æœ‰è¯»å®Œï¼›<code>value</code>å±æ€§æ˜¯ä¸€ä¸ª arrayBuffer æ•°ç»„ï¼Œè¡¨ç¤ºå†…å®¹å—çš„å†…å®¹ï¼Œè€Œ<code>value.length</code>å±æ€§æ˜¯å½“å‰å—çš„å¤§å°ã€‚</p><h3 id="fetch-çš„ç¬¬äºŒä¸ªå‚æ•°-å®šåˆ¶-http-è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#fetch-çš„ç¬¬äºŒä¸ªå‚æ•°-å®šåˆ¶-http-è¯·æ±‚" aria-hidden="true">#</a> <code>fetch()</code>çš„ç¬¬äºŒä¸ªå‚æ•°ï¼šå®šåˆ¶ HTTP è¯·æ±‚</h3><p><code>fetch()</code>çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ URLï¼Œè¿˜å¯ä»¥æ¥å—ç¬¬äºŒä¸ªå‚æ•°ï¼Œä½œä¸ºé…ç½®å¯¹è±¡ï¼Œå®šåˆ¶å‘å‡ºçš„ HTTP è¯·æ±‚ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> optionObj<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä¸Šé¢å‘½ä»¤çš„<code>optionObj</code>å°±æ˜¯ç¬¬äºŒä¸ªå‚æ•°ã€‚</p><p>HTTP è¯·æ±‚çš„æ–¹æ³•ã€æ ‡å¤´ã€æ•°æ®ä½“éƒ½åœ¨è¿™ä¸ªå¯¹è±¡é‡Œé¢è®¾ç½®ã€‚ä¸‹é¢æ˜¯ä¸€äº›ç¤ºä¾‹ã€‚</p><p><strong>ï¼ˆ1ï¼‰POST è¯·æ±‚</strong></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&#39;POST&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;Content-type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/x-www-form-urlencoded; charset=UTF-8&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token string">&#39;foo=bar&amp;lorem=ipsum&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> json <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œé…ç½®å¯¹è±¡ç”¨åˆ°äº†ä¸‰ä¸ªå±æ€§ã€‚</p><blockquote><ul><li><code>method</code>ï¼šHTTP è¯·æ±‚çš„æ–¹æ³•ï¼Œ<code>POST</code>ã€<code>DELETE</code>ã€<code>PUT</code>éƒ½åœ¨è¿™ä¸ªå±æ€§è®¾ç½®ã€‚</li><li><code>headers</code>ï¼šä¸€ä¸ªå¯¹è±¡ï¼Œç”¨æ¥å®šåˆ¶ HTTP è¯·æ±‚çš„æ ‡å¤´ã€‚</li><li><code>body</code>ï¼šPOST è¯·æ±‚çš„æ•°æ®ä½“ã€‚</li></ul></blockquote><p>æ³¨æ„ï¼Œæœ‰äº›æ ‡å¤´ä¸èƒ½é€šè¿‡<code>headers</code>å±æ€§è®¾ç½®ï¼Œæ¯”å¦‚<code>Content-Length</code>ã€<code>Cookie</code>ã€<code>Host</code>ç­‰ç­‰ã€‚å®ƒä»¬æ˜¯ç”±æµè§ˆå™¨è‡ªåŠ¨ç”Ÿæˆï¼Œæ— æ³•ä¿®æ”¹ã€‚</p><p><strong>ï¼ˆ2ï¼‰æäº¤ JSON æ•°æ®</strong></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> user <span class="token operator">=</span>  <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span>  <span class="token string">&#39;John&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">surname</span><span class="token operator">:</span>  <span class="token string">&#39;Smith&#39;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;/article/fetch/post/user&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&#39;POST&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
   <span class="token string-property property">&#39;Content-Type&#39;</span><span class="token operator">:</span> <span class="token string">&#39;application/json;charset=utf-8&#39;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> 
  <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œæ ‡å¤´<code>Content-Type</code>è¦è®¾æˆ<code>&#39;application/json;charset=utf-8&#39;</code>ã€‚å› ä¸ºé»˜è®¤å‘é€çš„æ˜¯çº¯æ–‡æœ¬ï¼Œ<code>Content-Type</code>çš„é»˜è®¤å€¼æ˜¯<code>&#39;text/plain;charset=UTF-8&#39;</code>ã€‚</p><p><strong>ï¼ˆ3ï¼‰æäº¤è¡¨å•</strong></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> form <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;form&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;/users&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&#39;POST&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span>form<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ï¼ˆ4ï¼‰æ–‡ä»¶ä¸Šä¼ </strong></p><p>å¦‚æœè¡¨å•é‡Œé¢æœ‰æ–‡ä»¶é€‰æ‹©å™¨ï¼Œå¯ä»¥ç”¨å‰ä¸€ä¸ªä¾‹å­çš„å†™æ³•ï¼Œä¸Šä¼ çš„æ–‡ä»¶åŒ…å«åœ¨æ•´ä¸ªè¡¨å•é‡Œé¢ï¼Œä¸€èµ·æäº¤ã€‚</p><p>å¦ä¸€ç§æ–¹æ³•æ˜¯ç”¨è„šæœ¬æ·»åŠ æ–‡ä»¶ï¼Œæ„é€ å‡ºä¸€ä¸ªè¡¨å•ï¼Œè¿›è¡Œä¸Šä¼ ï¼Œè¯·çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> input <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;input[type=&quot;file&quot;]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
data<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&#39;file&#39;</span><span class="token punctuation">,</span> input<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
data<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&#39;user&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;foo&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;/avatars&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&#39;POST&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">body</span><span class="token operator">:</span> data
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶æ—¶ï¼Œä¸ç”¨ä¿®æ”¹æ ‡å¤´çš„<code>Content-Type</code>ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨è®¾ç½®ã€‚</p><p><strong>ï¼ˆ5ï¼‰ç›´æ¥ä¸Šä¼ äºŒè¿›åˆ¶æ•°æ®</strong></p><p><code>fetch()</code>ä¹Ÿå¯ä»¥ç›´æ¥ä¸Šä¼ äºŒè¿›åˆ¶æ•°æ®ï¼Œå°† Blob æˆ– arrayBuffer æ•°æ®æ”¾åœ¨<code>body</code>å±æ€§é‡Œé¢ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">let</span> blob <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span>
  canvasElem<span class="token punctuation">.</span><span class="token function">toBlob</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span>  <span class="token string">&#39;image/png&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;/article/fetch/post/image&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span>  <span class="token string">&#39;POST&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">body</span><span class="token operator">:</span> blob
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="fetch-é…ç½®å¯¹è±¡çš„å®Œæ•´-api" tabindex="-1"><a class="header-anchor" href="#fetch-é…ç½®å¯¹è±¡çš„å®Œæ•´-api" aria-hidden="true">#</a> <code>fetch()</code>é…ç½®å¯¹è±¡çš„å®Œæ•´ API</h3><p><code>fetch()</code>ç¬¬äºŒä¸ªå‚æ•°çš„å®Œæ•´ API å¦‚ä¸‹ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;GET&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;Content-Type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text/plain;charset=UTF-8&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
  <span class="token literal-property property">referrer</span><span class="token operator">:</span> <span class="token string">&quot;about:client&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">referrerPolicy</span><span class="token operator">:</span> <span class="token string">&quot;no-referrer-when-downgrade&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&quot;cors&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">credentials</span><span class="token operator">:</span> <span class="token string">&quot;same-origin&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">cache</span><span class="token operator">:</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">redirect</span><span class="token operator">:</span> <span class="token string">&quot;follow&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">integrity</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">keepalive</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token literal-property property">signal</span><span class="token operator">:</span> <span class="token keyword">undefined</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>fetch()</code>è¯·æ±‚çš„åº•å±‚ç”¨çš„æ˜¯ <a href="https://developer.mozilla.org/en-US/docs/Web/API/Request/Request" target="_blank" rel="noopener noreferrer">Request() å¯¹è±¡<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>çš„æ¥å£ï¼Œå‚æ•°å®Œå…¨ä¸€æ ·ï¼Œå› æ­¤ä¸Šé¢çš„ API ä¹Ÿæ˜¯<code>Request()</code>çš„ APIã€‚</p><p>è¿™äº›å±æ€§é‡Œé¢ï¼Œ<code>headers</code>ã€<code>body</code>ã€<code>method</code>å‰é¢å·²ç»ç»™è¿‡ç¤ºä¾‹äº†ï¼Œä¸‹é¢æ˜¯å…¶ä»–å±æ€§çš„ä»‹ç»ã€‚</p><p><strong>cache</strong></p><p><code>cache</code>å±æ€§æŒ‡å®šå¦‚ä½•å¤„ç†ç¼“å­˜ã€‚å¯èƒ½çš„å–å€¼å¦‚ä¸‹ï¼š</p><ul><li><code>default</code>ï¼šé»˜è®¤å€¼ï¼Œå…ˆåœ¨ç¼“å­˜é‡Œé¢å¯»æ‰¾åŒ¹é…çš„è¯·æ±‚ã€‚</li><li><code>no-store</code>ï¼šç›´æ¥è¯·æ±‚è¿œç¨‹æœåŠ¡å™¨ï¼Œå¹¶ä¸”ä¸æ›´æ–°ç¼“å­˜ã€‚</li><li><code>reload</code>ï¼šç›´æ¥è¯·æ±‚è¿œç¨‹æœåŠ¡å™¨ï¼Œå¹¶ä¸”æ›´æ–°ç¼“å­˜ã€‚</li><li><code>no-cache</code>ï¼šå°†æœåŠ¡å™¨èµ„æºè·Ÿæœ¬åœ°ç¼“å­˜è¿›è¡Œæ¯”è¾ƒï¼Œæœ‰æ–°çš„ç‰ˆæœ¬æ‰ä½¿ç”¨æœåŠ¡å™¨èµ„æºï¼Œå¦åˆ™ä½¿ç”¨ç¼“å­˜ã€‚</li><li><code>force-cache</code>ï¼šç¼“å­˜ä¼˜å…ˆï¼Œåªæœ‰ä¸å­˜åœ¨ç¼“å­˜çš„æƒ…å†µä¸‹ï¼Œæ‰è¯·æ±‚è¿œç¨‹æœåŠ¡å™¨ã€‚</li><li><code>only-if-cached</code>ï¼šåªæ£€æŸ¥ç¼“å­˜ï¼Œå¦‚æœç¼“å­˜é‡Œé¢ä¸å­˜åœ¨ï¼Œå°†è¿”å›504é”™è¯¯ã€‚</li></ul><p><strong>mode</strong></p><p><code>mode</code>å±æ€§æŒ‡å®šè¯·æ±‚çš„æ¨¡å¼ã€‚å¯èƒ½çš„å–å€¼å¦‚ä¸‹ï¼š</p><ul><li><code>cors</code>ï¼šé»˜è®¤å€¼ï¼Œå…è®¸è·¨æºè¯·æ±‚ã€‚</li><li><code>same-origin</code>ï¼šåªå…è®¸åŒæºè¯·æ±‚ã€‚</li><li><code>no-cors</code>ï¼šè¯·æ±‚æ–¹æ³•åªé™äº GETã€POST å’Œ HEADï¼Œå¹¶ä¸”åªèƒ½ä½¿ç”¨æœ‰é™çš„å‡ ä¸ªç®€å•æ ‡å¤´ï¼Œä¸èƒ½æ·»åŠ è·¨æºçš„å¤æ‚æ ‡å¤´ï¼Œç›¸å½“äºæäº¤è¡¨å•ã€<code>&lt;script&gt;</code>åŠ è½½è„šæœ¬ã€<code>&lt;img&gt;</code>åŠ è½½å›¾ç‰‡ç­‰ä¼ ç»Ÿçš„è·¨æºè¯·æ±‚æ–¹æ³•ã€‚</li></ul><p><strong>credentials</strong></p><p><code>credentials</code>å±æ€§æŒ‡å®šæ˜¯å¦å‘é€ Cookieã€‚å¯èƒ½çš„å–å€¼å¦‚ä¸‹ï¼š</p><ul><li><code>same-origin</code>ï¼šé»˜è®¤å€¼ï¼ŒåŒæºè¯·æ±‚æ—¶å‘é€ Cookieï¼Œè·¨æºè¯·æ±‚æ—¶ä¸å‘é€ã€‚</li><li><code>include</code>ï¼šä¸ç®¡åŒæºè¯·æ±‚ï¼Œè¿˜æ˜¯è·¨æºè¯·æ±‚ï¼Œä¸€å¾‹å‘é€ Cookieã€‚</li><li><code>omit</code>ï¼šä¸€å¾‹ä¸å‘é€ã€‚</li></ul><p>è·¨æºè¯·æ±‚å‘é€ Cookieï¼Œéœ€è¦å°†<code>credentials</code>å±æ€§è®¾ä¸º<code>include</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;http://another.com&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">credentials</span><span class="token operator">:</span> <span class="token string">&quot;include&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>signal</strong></p><p><code>signal</code>å±æ€§æŒ‡å®šä¸€ä¸ª AbortSignal å®ä¾‹ï¼Œç”¨äºå–æ¶ˆ<code>fetch()</code>è¯·æ±‚ï¼Œè¯¦è§ä¸‹ä¸€èŠ‚ã€‚</p><p><strong>keepalive</strong></p><p><code>keepalive</code>å±æ€§ç”¨äºé¡µé¢å¸è½½æ—¶ï¼Œå‘Šè¯‰æµè§ˆå™¨åœ¨åå°ä¿æŒè¿æ¥ï¼Œç»§ç»­å‘é€æ•°æ®ã€‚</p><p>ä¸€ä¸ªå…¸å‹çš„åœºæ™¯å°±æ˜¯ï¼Œç”¨æˆ·ç¦»å¼€ç½‘é¡µæ—¶ï¼Œè„šæœ¬å‘æœåŠ¡å™¨æäº¤ä¸€äº›ç”¨æˆ·è¡Œä¸ºçš„ç»Ÿè®¡ä¿¡æ¯ã€‚è¿™æ—¶ï¼Œå¦‚æœä¸ç”¨<code>keepalive</code>å±æ€§ï¼Œæ•°æ®å¯èƒ½æ— æ³•å‘é€ï¼Œå› ä¸ºæµè§ˆå™¨å·²ç»æŠŠé¡µé¢å¸è½½äº†ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>window<span class="token punctuation">.</span><span class="token function-variable function">onunload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;/analytics&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&#39;POST&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&#39;Content-Type&#39;</span><span class="token operator">:</span> <span class="token string">&#39;application/json&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">some</span><span class="token operator">:</span> <span class="token string">&#39;data&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">keepalive</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>redirect</strong></p><p><code>redirect</code>å±æ€§æŒ‡å®š HTTP è·³è½¬çš„å¤„ç†æ–¹æ³•ã€‚å¯èƒ½çš„å–å€¼å¦‚ä¸‹ï¼š</p><ul><li><code>follow</code>ï¼šé»˜è®¤å€¼ï¼Œ<code>fetch()</code>è·Ÿéš HTTP è·³è½¬ã€‚</li><li><code>error</code>ï¼šå¦‚æœå‘ç”Ÿè·³è½¬ï¼Œ<code>fetch()</code>å°±æŠ¥é”™ã€‚</li><li><code>manual</code>ï¼š<code>fetch()</code>ä¸è·Ÿéš HTTP è·³è½¬ï¼Œä½†æ˜¯<code>response.url</code>å±æ€§ä¼šæŒ‡å‘æ–°çš„ URLï¼Œ<code>response.redirected</code>å±æ€§ä¼šå˜ä¸º<code>true</code>ï¼Œç”±å¼€å‘è€…è‡ªå·±å†³å®šåç»­å¦‚ä½•å¤„ç†è·³è½¬ã€‚</li></ul><p><strong>integrity</strong></p><p><code>integrity</code>å±æ€§æŒ‡å®šä¸€ä¸ªå“ˆå¸Œå€¼ï¼Œç”¨äºæ£€æŸ¥ HTTP å›åº”ä¼ å›çš„æ•°æ®æ˜¯å¦ç­‰äºè¿™ä¸ªé¢„å…ˆè®¾å®šçš„å“ˆå¸Œå€¼ã€‚</p><p>æ¯”å¦‚ï¼Œä¸‹è½½æ–‡ä»¶æ—¶ï¼Œæ£€æŸ¥æ–‡ä»¶çš„ SHA-256 å“ˆå¸Œå€¼æ˜¯å¦ç›¸ç¬¦ï¼Œç¡®ä¿æ²¡æœ‰è¢«ç¯¡æ”¹ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;http://site.com/file&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">integrity</span><span class="token operator">:</span> <span class="token string">&#39;sha256-abcdef&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>referrer</strong></p><p><code>referrer</code>å±æ€§ç”¨äºè®¾å®š<code>fetch()</code>è¯·æ±‚çš„<code>referer</code>æ ‡å¤´ã€‚</p><p>è¿™ä¸ªå±æ€§å¯ä»¥ä¸ºä»»æ„å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥è®¾ä¸ºç©ºå­—ç¬¦ä¸²ï¼ˆå³ä¸å‘é€<code>referer</code>æ ‡å¤´ï¼‰ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;/page&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">referrer</span><span class="token operator">:</span> <span class="token string">&#39;&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>referrerPolicy</strong></p><p><code>referrerPolicy</code>å±æ€§ç”¨äºè®¾å®š<code>Referer</code>æ ‡å¤´çš„è§„åˆ™ã€‚å¯èƒ½çš„å–å€¼å¦‚ä¸‹ï¼š</p><ul><li><code>no-referrer-when-downgrade</code>ï¼šé»˜è®¤å€¼ï¼Œæ€»æ˜¯å‘é€<code>Referer</code>æ ‡å¤´ï¼Œé™¤éä» HTTPS é¡µé¢è¯·æ±‚ HTTP èµ„æºæ—¶ä¸å‘é€ã€‚</li><li><code>no-referrer</code>ï¼šä¸å‘é€<code>Referer</code>æ ‡å¤´ã€‚</li><li><code>origin</code>ï¼š<code>Referer</code>æ ‡å¤´åªåŒ…å«åŸŸåï¼Œä¸åŒ…å«å®Œæ•´çš„è·¯å¾„ã€‚</li><li><code>origin-when-cross-origin</code>ï¼šåŒæºè¯·æ±‚<code>Referer</code>æ ‡å¤´åŒ…å«å®Œæ•´çš„è·¯å¾„ï¼Œè·¨æºè¯·æ±‚åªåŒ…å«åŸŸåã€‚</li><li><code>same-origin</code>ï¼šè·¨æºè¯·æ±‚ä¸å‘é€<code>Referer</code>ï¼ŒåŒæºè¯·æ±‚å‘é€ã€‚</li><li><code>strict-origin</code>ï¼š<code>Referer</code>æ ‡å¤´åªåŒ…å«åŸŸåï¼ŒHTTPS é¡µé¢è¯·æ±‚ HTTP èµ„æºæ—¶ä¸å‘é€<code>Referer</code>æ ‡å¤´ã€‚</li><li><code>strict-origin-when-cross-origin</code>ï¼šåŒæºè¯·æ±‚æ—¶<code>Referer</code>æ ‡å¤´åŒ…å«å®Œæ•´è·¯å¾„ï¼Œè·¨æºè¯·æ±‚æ—¶åªåŒ…å«åŸŸåï¼ŒHTTPS é¡µé¢è¯·æ±‚ HTTP èµ„æºæ—¶ä¸å‘é€è¯¥æ ‡å¤´ã€‚</li><li><code>unsafe-url</code>ï¼šä¸ç®¡ä»€ä¹ˆæƒ…å†µï¼Œæ€»æ˜¯å‘é€<code>Referer</code>æ ‡å¤´ã€‚</li></ul><h3 id="å–æ¶ˆfetch-è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#å–æ¶ˆfetch-è¯·æ±‚" aria-hidden="true">#</a> å–æ¶ˆ<code>fetch()</code>è¯·æ±‚</h3><p><code>fetch()</code>è¯·æ±‚å‘é€ä»¥åï¼Œå¦‚æœä¸­é€”æƒ³è¦å–æ¶ˆï¼Œéœ€è¦ä½¿ç”¨<code>AbortController</code>å¯¹è±¡ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">let</span> controller <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AbortController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> signal <span class="token operator">=</span> controller<span class="token punctuation">.</span>signal<span class="token punctuation">;</span>

<span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">signal</span><span class="token operator">:</span> controller<span class="token punctuation">.</span>signal
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

signal<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;abort&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;abort!&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

controller<span class="token punctuation">.</span><span class="token function">abort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å–æ¶ˆ</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>signal<span class="token punctuation">.</span>aborted<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œé¦–å…ˆæ–°å»º AbortController å®ä¾‹ï¼Œç„¶åå‘é€<code>fetch()</code>è¯·æ±‚ï¼Œé…ç½®å¯¹è±¡çš„<code>signal</code>å±æ€§å¿…é¡»æŒ‡å®šæ¥æ”¶ AbortController å®ä¾‹å‘é€çš„ä¿¡å·<code>controller.signal</code>ã€‚</p><p><code>controller.abort()</code>æ–¹æ³•ç”¨äºå‘å‡ºå–æ¶ˆä¿¡å·ã€‚è¿™æ—¶ä¼šè§¦å‘<code>abort</code>äº‹ä»¶ï¼Œè¿™ä¸ªäº‹ä»¶å¯ä»¥ç›‘å¬ï¼Œä¹Ÿå¯ä»¥é€šè¿‡<code>controller.signal.aborted</code>å±æ€§åˆ¤æ–­å–æ¶ˆä¿¡å·æ˜¯å¦å·²ç»å‘å‡ºã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ª1ç§’åè‡ªåŠ¨å–æ¶ˆè¯·æ±‚çš„ä¾‹å­ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">let</span> controller <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AbortController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> controller<span class="token punctuation">.</span><span class="token function">abort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;/long-operation&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">signal</span><span class="token operator">:</span> controller<span class="token punctuation">.</span>signal
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">&#39;AbortError&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Aborted!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å‚è€ƒé“¾æ¥-2" tabindex="-1"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥-2" aria-hidden="true">#</a> å‚è€ƒé“¾æ¥</h3><ul><li><a href="https://javascript.info/fetch" target="_blank" rel="noopener noreferrer">Network requests: Fetch<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://github.com/node-fetch/node-fetch" target="_blank" rel="noopener noreferrer">node-fetch<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://developers.google.com/web/updates/2015/03/introduction-to-fetch" target="_blank" rel="noopener noreferrer">Introduction to fetch()<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch" target="_blank" rel="noopener noreferrer">Using Fetch<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://developerhowto.com/2019/09/14/javascript-fetch-api/" target="_blank" rel="noopener noreferrer">Javascript Fetch API: The XMLHttpRequest evolution<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://www.sitepen.com/blog/2017/10/02/a-guide-to-faster-web-app-io-and-data-operations-with-streams/" target="_blank" rel="noopener noreferrer">A Guide to Faster Web App I/O and Data Operations with Streams<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h2 id="fontface-api" tabindex="-1"><a class="header-anchor" href="#fontface-api" aria-hidden="true">#</a> FontFace API</h2><p>FontFace API ç”¨æ¥æ§åˆ¶å­—ä½“åŠ è½½ã€‚</p><p>è¿™ä¸ª API æä¾›ä¸€ä¸ªæ„é€ å‡½æ•°<code>FontFace()</code>ï¼Œè¿”å›ä¸€ä¸ªå­—ä½“å¯¹è±¡ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">new</span> <span class="token class-name">FontFace</span><span class="token punctuation">(</span>family<span class="token punctuation">,</span> source<span class="token punctuation">,</span> descriptors<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>FontFace()</code>æ„é€ å‡½æ•°æ¥å—ä¸‰ä¸ªå‚æ•°ã€‚</p><ul><li><code>family</code>ï¼šå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå­—ä½“åï¼Œå†™æ³•ä¸ CSS çš„<code>@font-face</code>çš„<code>font-family</code>å±æ€§ç›¸åŒã€‚</li><li><code>source</code>ï¼šå­—ä½“æ–‡ä»¶çš„ URLï¼ˆå¿…é¡»åŒ…æ‹¬ CSS çš„<code>url()</code>æ–¹æ³•ï¼‰ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªå­—ä½“çš„ ArrayBuffer å¯¹è±¡ã€‚</li><li><code>descriptors</code>ï¼šå¯¹è±¡ï¼Œç”¨æ¥å®šåˆ¶å­—ä½“æ–‡ä»¶ã€‚è¯¥å‚æ•°å¯é€‰ã€‚</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> fontFace <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FontFace</span><span class="token punctuation">(</span>
  <span class="token string">&#39;Roboto&#39;</span><span class="token punctuation">,</span>
  <span class="token string">&#39;url(https://fonts.example.com/roboto.woff2)&#39;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

fontFace<span class="token punctuation">.</span>family <span class="token comment">// &quot;Roboto&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>FontFace()</code>è¿”å›çš„æ˜¯ä¸€ä¸ªå­—ä½“å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡åŒ…å«å­—ä½“ä¿¡æ¯ã€‚æ³¨æ„ï¼Œè¿™æ—¶å­—ä½“æ–‡ä»¶è¿˜æ²¡æœ‰å¼€å§‹åŠ è½½ã€‚</p><p>å­—ä½“å¯¹è±¡åŒ…å«ä»¥ä¸‹å±æ€§ã€‚</p><ul><li><code>FontFace.family</code>ï¼šå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå­—ä½“çš„åå­—ï¼Œç­‰åŒäº CSS çš„<code>font-family</code>å±æ€§ã€‚</li><li><code>FontFace.display</code>ï¼šå­—ç¬¦ä¸²ï¼ŒæŒ‡å®šå­—ä½“åŠ è½½æœŸé—´å¦‚ä½•å±•ç¤ºï¼Œç­‰åŒäº CSS çš„<code>font-display</code>å±æ€§ã€‚å®ƒæœ‰äº”ä¸ªå¯èƒ½çš„å€¼ï¼š<code>auto</code>ï¼ˆç”±æµè§ˆå™¨å†³å®šï¼‰ã€<code>block</code>ï¼ˆå­—ä½“åŠ è½½æœŸé—´ï¼Œå‰3ç§’ä¼šæ˜¾ç¤ºä¸å‡ºå†…å®¹ï¼Œç„¶ååªè¦è¿˜æ²¡å®ŒæˆåŠ è½½ï¼Œå°±ä¸€ç›´æ˜¾ç¤ºåå¤‡å­—ä½“ï¼‰ã€<code>fallback</code>ï¼ˆå‰100æ¯«ç§’æ˜¾ç¤ºä¸å‡ºå†…å®¹ï¼Œå3ç§’æ˜¾ç¤ºåå¤‡å­—ä½“ï¼Œç„¶ååªè¦å­—ä½“è¿˜æ²¡å®ŒæˆåŠ è½½ï¼Œå°±ä¸€ç›´æ˜¾ç¤ºåå¤‡å­—ä½“ï¼‰ã€<code>optional</code>ï¼ˆå‰100æ¯«ç§’æ˜¾ç¤ºä¸å‡ºå†…å®¹ï¼Œç„¶ååªè¦å­—ä½“è¿˜æ²¡æœ‰å®ŒæˆåŠ è½½ï¼Œå°±ä¸€ç›´æ˜¾ç¤ºåå¤‡å­—ä½“ï¼‰ï¼Œ<code>swap</code>ï¼ˆåªè¦å­—ä½“æ²¡æœ‰å®ŒæˆåŠ è½½ï¼Œå°±ä¸€ç›´æ˜¾ç¤ºåå¤‡å­—ä½“ï¼‰ã€‚</li><li><code>FontFace.style</code>ï¼šå­—ç¬¦ä¸²ï¼Œç­‰åŒäº CSS çš„<code>font-style</code>å±æ€§ã€‚</li><li><code>FontFace.weight</code>ï¼šå­—ç¬¦ä¸²ï¼Œç­‰åŒäº CSS çš„<code>font-weight</code>å±æ€§ã€‚</li><li><code>FontFace.stretch</code>ï¼šå­—ç¬¦ä¸²ï¼Œç­‰åŒäº CSS çš„<code>font-strentch</code>å±æ€§ã€‚</li><li><code>FontFace.unicodeRange</code>ï¼šå­—ç¬¦ä¸²ï¼Œç­‰åŒäº<code>descriptors</code>å¯¹è±¡çš„åŒåå±æ€§ã€‚</li><li><code>FontFace.variant</code>ï¼šå­—ç¬¦ä¸²ï¼Œç­‰åŒäº<code>descriptors</code>å¯¹è±¡çš„åŒåå±æ€§ã€‚</li><li><code>FontFace.featureSettings</code>ï¼šå­—ç¬¦ä¸²ï¼Œç­‰åŒäº<code>descriptors</code>å¯¹è±¡çš„åŒåå±æ€§ã€‚</li><li><code>FontFace.status</code>ï¼šå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå­—ä½“çš„åŠ è½½çŠ¶æ€ï¼Œæœ‰å››ä¸ªå¯èƒ½çš„å€¼ï¼š<code>unloaded</code>ã€<code>loading</code>ã€<code>loaded</code>ã€<code>error</code>ã€‚è¯¥å±æ€§åªè¯»ã€‚</li><li><code>FontFace.loaded</code>ï¼šè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå­—ä½“åŠ è½½æˆåŠŸæˆ–å¤±è´¥ï¼Œä¼šå¯¼è‡´è¯¥ Promise çŠ¶æ€æ”¹å˜ã€‚è¯¥å±æ€§åªè¯»ã€‚</li></ul><p>å­—ä½“å¯¹è±¡çš„æ–¹æ³•ï¼Œåªæœ‰ä¸€ä¸ª<code>FontFace.load()</code>ï¼Œè¯¥æ–¹æ³•ä¼šçœŸæ­£å¼€å§‹åŠ è½½å­—ä½“ã€‚å®ƒè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼ŒçŠ¶æ€ç”±å­—ä½“åŠ è½½çš„ç»“æœå†³å®šã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FontFace</span><span class="token punctuation">(</span><span class="token string">&#39;test&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;url(x)&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

f<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ç½‘é¡µå¯ä»¥å¼€å§‹ä½¿ç”¨è¯¥å­—ä½“</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="geolocation-api" tabindex="-1"><a class="header-anchor" href="#geolocation-api" aria-hidden="true">#</a> Geolocation API</h2><p>Geolocation API ç”¨äºè·å–ç”¨æˆ·çš„åœ°ç†ä½ç½®ã€‚</p><p>ç”±äºè¯¥åŠŸèƒ½æ¶‰åŠç”¨æˆ·éšç§ï¼Œæ‰€ä»¥æµè§ˆå™¨ä¼šæç¤ºç”¨æˆ·ï¼Œæ˜¯å¦åŒæ„ç»™å‡ºåœ°ç†ä½ç½®ï¼Œç”¨æˆ·å¯èƒ½ä¼šæ‹’ç»ã€‚å¦å¤–ï¼Œè¿™ä¸ª API åªèƒ½åœ¨ HTTPS ç¯å¢ƒä½¿ç”¨ã€‚</p><p>æµè§ˆå™¨é€šè¿‡<code>navigator.geolocation</code>å±æ€§æä¾›è¯¥ APIã€‚</p><h3 id="geolocation-å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#geolocation-å¯¹è±¡" aria-hidden="true">#</a> Geolocation å¯¹è±¡</h3><p><code>navigator.geolocation</code>å±æ€§è¿”å›ä¸€ä¸ª Geolocation å¯¹è±¡ã€‚è¯¥å¯¹è±¡å…·æœ‰ä»¥ä¸‹ä¸‰ä¸ªæ–¹æ³•ã€‚</p><ul><li><code>Geolocation.getCurrentPosition()</code>ï¼šè¿”å›ä¸€ä¸ª Position å¯¹è±¡ï¼Œè¡¨ç¤ºç”¨æˆ·çš„å½“å‰ä½ç½®ã€‚</li><li><code>Geolocation.watchPosition()</code>ï¼šæŒ‡å®šä¸€ä¸ªç›‘å¬å‡½æ•°ï¼Œæ¯å½“ç”¨æˆ·çš„ä½ç½®å‘ç”Ÿå˜åŒ–ï¼Œå°±æ‰§è¡Œè¯¥ç›‘å¬å‡½æ•°ã€‚</li><li><code>Geolocation.clearWatch()</code>ï¼šå–æ¶ˆ<code>watchPosition()</code>æ–¹æ³•æŒ‡å®šçš„ç›‘å¬å‡½æ•°ã€‚</li></ul><h4 id="geolocation-getcurrentposition" tabindex="-1"><a class="header-anchor" href="#geolocation-getcurrentposition" aria-hidden="true">#</a> Geolocation.getCurrentPosition()</h4><p><code>Geolocation.getCurrentPosition()</code>æ–¹æ³•ç”¨äºè·å–ç”¨æˆ·çš„ä½ç½®ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>navigator<span class="token punctuation">.</span>geolocation<span class="token punctuation">.</span><span class="token function">getCurrentPosition</span><span class="token punctuation">(</span>success<span class="token punctuation">,</span> error<span class="token punctuation">,</span> options<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>è¯¥æ–¹æ³•æ¥å—ä¸‰ä¸ªå‚æ•°ã€‚</p><ul><li><code>success</code>ï¼šç”¨æˆ·åŒæ„ç»™å‡ºä½ç½®æ—¶çš„å›è°ƒå‡½æ•°ï¼Œå®ƒçš„å‚æ•°æ˜¯ä¸€ä¸ª Position å¯¹è±¡ã€‚</li><li><code>error</code>ï¼šç”¨æˆ·æ‹’ç»ç»™å‡ºä½ç½®æ—¶çš„å›è°ƒå‡½æ•°ï¼Œå®ƒçš„å‚æ•°æ˜¯ä¸€ä¸ª PositionError å¯¹è±¡ã€‚è¯¥å‚æ•°å¯é€‰ã€‚</li><li><code>options</code>ï¼šå‚æ•°å¯¹è±¡ï¼Œè¯¥å‚æ•°å¯é€‰ã€‚</li></ul><p>Position å¯¹è±¡æœ‰ä¸¤ä¸ªå±æ€§ã€‚</p><ul><li><code>Position.coords</code>ï¼šè¿”å›ä¸€ä¸ª Coordinates å¯¹è±¡ï¼Œè¡¨ç¤ºå½“å‰ä½ç½®çš„åæ ‡ã€‚</li><li><code>Position.timestamp</code>ï¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œä»£è¡¨å½“å‰æ—¶é—´æˆ³ã€‚</li></ul><p>PositionError å¯¹è±¡ä¸»è¦æœ‰ä¸¤ä¸ªå±æ€§ã€‚</p><ul><li><code>PositionError.code</code>ï¼šæ•´æ•°ï¼Œè¡¨ç¤ºå‘ç”Ÿé”™è¯¯çš„åŸå› ã€‚<code>1</code>è¡¨ç¤ºæ— æƒé™ï¼Œæœ‰å¯èƒ½æ˜¯ç”¨æˆ·æ‹’ç»æˆæƒï¼›<code>2</code>è¡¨ç¤ºæ— æ³•è·å¾—ä½ç½®ï¼Œå¯èƒ½è®¾å¤‡æœ‰æ•…éšœï¼›<code>3</code>è¡¨ç¤ºè¶…æ—¶ã€‚</li><li><code>PositionError.message</code>ï¼šå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºé”™è¯¯çš„æè¿°ã€‚</li></ul><p>å‚æ•°å¯¹è±¡<code>option</code>å¯ä»¥æŒ‡å®šä¸‰ä¸ªå±æ€§ã€‚</p><ul><li><code>enableHighAccuracy</code>ï¼šå¸ƒå°”å€¼ï¼Œæ˜¯å¦è¿”å›é«˜ç²¾åº¦ç»“æœã€‚å¦‚æœè®¾ä¸º<code>true</code>ï¼Œå¯èƒ½å¯¼è‡´å“åº”æ—¶é—´å˜æ…¢æˆ–ï¼ˆç§»åŠ¨è®¾å¤‡çš„ï¼‰åŠŸè€—å¢åŠ ï¼›åä¹‹ï¼Œå¦‚æœè®¾ä¸º<code>false</code>ï¼Œè®¾å¤‡å¯ä»¥æ›´å¿«é€Ÿåœ°å“åº”ã€‚é»˜è®¤å€¼ä¸º<code>false</code>ã€‚</li><li><code>timeout</code>ï¼šæ­£æ•´æ•°ï¼Œè¡¨ç¤ºç­‰å¾…æŸ¥è¯¢çš„æœ€é•¿æ—¶é—´ï¼Œå•ä½ä¸ºæ¯«ç§’ã€‚é»˜è®¤å€¼ä¸º<code>Infinity</code>ã€‚</li><li><code>maximumAge</code>ï¼šæ­£æ•´æ•°ï¼Œè¡¨ç¤ºå¯æ¥å—çš„ç¼“å­˜æœ€é•¿æ—¶é—´ï¼Œå•ä½ä¸ºæ¯«ç§’ã€‚å¦‚æœè®¾ä¸º<code>0</code>ï¼Œè¡¨ç¤ºä¸è¿”å›ç¼“å­˜å€¼ï¼Œå¿…é¡»æŸ¥è¯¢å½“å‰çš„å®é™…ä½ç½®ï¼›å¦‚æœè®¾ä¸º<code>Infinity</code>ï¼Œå¿…é¡»è¿”å›ç¼“å­˜å€¼ï¼Œä¸ç®¡ç¼“å­˜äº†å¤šå°‘æ—¶é—´ã€‚é»˜è®¤å€¼ä¸º<code>0</code>ã€‚</li></ul><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">enableHighAccuracy</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">timeout</span><span class="token operator">:</span> <span class="token number">5000</span><span class="token punctuation">,</span>
  <span class="token literal-property property">maximumAge</span><span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">pos</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> crd <span class="token operator">=</span> pos<span class="token punctuation">.</span>coords<span class="token punctuation">;</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ç»åº¦ï¼š</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>crd<span class="token punctuation">.</span>latitude<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">çº¬åº¦ï¼š</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>crd<span class="token punctuation">.</span>longitude<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">è¯¯å·®ï¼š</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>crd<span class="token punctuation">.</span>accuracy<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> ç±³</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ERROR(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>err<span class="token punctuation">.</span>code<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">): </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>err<span class="token punctuation">.</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

navigator<span class="token punctuation">.</span>geolocation<span class="token punctuation">.</span><span class="token function">getCurrentPosition</span><span class="token punctuation">(</span>success<span class="token punctuation">,</span> error<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="geolocation-watchposition" tabindex="-1"><a class="header-anchor" href="#geolocation-watchposition" aria-hidden="true">#</a> Geolocation.watchPosition()</h4><p><code>Geolocation.watchPosition()</code>å¯¹è±¡æŒ‡å®šä¸€ä¸ªç›‘å¬å‡½æ•°ï¼Œæ¯å½“ç”¨æˆ·çš„ä½ç½®å‘ç”Ÿå˜åŒ–ï¼Œå°±æ˜¯è‡ªåŠ¨æ‰§è¡Œè¿™ä¸ªå‡½æ•°ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>navigator<span class="token punctuation">.</span>geolocation<span class="token punctuation">.</span><span class="token function">watchPosition</span><span class="token punctuation">(</span>success<span class="token punctuation">[</span><span class="token punctuation">,</span> error<span class="token punctuation">[</span><span class="token punctuation">,</span> options<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>è¯¥æ–¹æ³•æ¥å—ä¸‰ä¸ªå‚æ•°ã€‚</p><ul><li><code>success</code>ï¼šç›‘å¬æˆåŠŸçš„å›è°ƒå‡½æ•°ï¼Œè¯¥å‡½æ•°çš„å‚æ•°ä¸ºä¸€ä¸ª Position å¯¹è±¡ã€‚</li><li><code>error</code>ï¼šè¯¥å‚æ•°å¯é€‰ï¼Œè¡¨ç¤ºç›‘å¬å¤±è´¥çš„å›è°ƒå‡½æ•°ï¼Œè¯¥å‡½æ•°çš„å‚æ•°æ˜¯ä¸€ä¸ª PositionError å¯¹è±¡ã€‚</li><li><code>options</code>ï¼šè¯¥å‚æ•°å¯é€‰ï¼Œè¡¨ç¤ºç›‘å¬çš„å‚æ•°é…ç½®å¯¹è±¡ã€‚</li></ul><p>è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªæ•´æ•°å€¼ï¼Œè¡¨ç¤ºç›‘å¬å‡½æ•°çš„ç¼–å·ã€‚è¯¥æ•´æ•°ç”¨æ¥ä¾›<code>Geolocation.clearWatch()</code>æ–¹æ³•å–æ¶ˆç›‘å¬ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> id<span class="token punctuation">;</span>

<span class="token keyword">var</span> target <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">latitude</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token literal-property property">longitude</span><span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">enableHighAccuracy</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token literal-property property">timeout</span><span class="token operator">:</span> <span class="token number">5000</span><span class="token punctuation">,</span>
  <span class="token literal-property property">maximumAge</span><span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">pos</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> crd <span class="token operator">=</span> pos<span class="token punctuation">.</span>coords<span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>target<span class="token punctuation">.</span>latitude <span class="token operator">===</span> crd<span class="token punctuation">.</span>latitude <span class="token operator">&amp;&amp;</span> target<span class="token punctuation">.</span>longitude <span class="token operator">===</span> crd<span class="token punctuation">.</span>longitude<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;æ­å–œï¼Œä½ å·²ç»åˆ°è¾¾äº†æŒ‡å®šä½ç½®ã€‚&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    navigator<span class="token punctuation">.</span>geolocation<span class="token punctuation">.</span><span class="token function">clearWatch</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&#39;ERROR(&#39;</span> <span class="token operator">+</span> err<span class="token punctuation">.</span>code <span class="token operator">+</span> <span class="token string">&#39;): &#39;</span> <span class="token operator">+</span> err<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

id <span class="token operator">=</span> navigator<span class="token punctuation">.</span>geolocation<span class="token punctuation">.</span><span class="token function">watchPosition</span><span class="token punctuation">(</span>success<span class="token punctuation">,</span> error<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="geolocation-clearwatch" tabindex="-1"><a class="header-anchor" href="#geolocation-clearwatch" aria-hidden="true">#</a> Geolocation.clearWatch()</h4><p><code>Geolocation.clearWatch()</code>æ–¹æ³•ç”¨æ¥å–æ¶ˆ<code>watchPosition()</code>æ–¹æ³•æŒ‡å®šçš„ç›‘å¬å‡½æ•°ã€‚å®ƒçš„å‚æ•°æ˜¯<code>watchPosition()</code>è¿”å›çš„ç›‘å¬å‡½æ•°çš„ç¼–å·ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>navigator<span class="token punctuation">.</span>geolocation<span class="token punctuation">.</span><span class="token function">clearWatch</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä½¿ç”¨æ–¹æ³•çš„ä¾‹å­è§ä¸Šä¸€èŠ‚ã€‚</p><h3 id="coordinates-å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#coordinates-å¯¹è±¡" aria-hidden="true">#</a> Coordinates å¯¹è±¡</h3><p>Coordinates å¯¹è±¡æ˜¯åœ°ç†ä½ç½®çš„åæ ‡æ¥å£ï¼Œ<code>Position.coords</code>å±æ€§è¿”å›çš„å°±æ˜¯è¿™ä¸ªå¯¹è±¡ã€‚</p><p>å®ƒæœ‰ä»¥ä¸‹å±æ€§ï¼Œå…¨éƒ¨ä¸ºåªè¯»å±æ€§ã€‚</p><ul><li><code>Coordinates.latitude</code>ï¼šæµ®ç‚¹æ•°ï¼Œè¡¨ç¤ºçº¬åº¦ã€‚</li><li><code>Coordinates.longitude</code>ï¼šæµ®ç‚¹æ•°ï¼Œè¡¨ç¤ºç»åº¦ã€‚</li><li><code>Coordinates.altitude</code>ï¼šæµ®ç‚¹æ•°ï¼Œè¡¨ç¤ºæµ·æ‹”ï¼ˆå•ä½ï¼šç±³ï¼‰ã€‚å¦‚æœä¸å¯å¾—ï¼Œè¿”å›<code>null</code>ã€‚</li><li><code>Coordinates.accuracy</code>ï¼šæµ®ç‚¹æ•°ï¼Œè¡¨ç¤ºç»åº¦å’Œçº¬åº¦çš„ç²¾åº¦ï¼ˆå•ä½ï¼šç±³ï¼‰ã€‚</li><li><code>Coordinates.altitudeAccuracy</code>ï¼šæµ®ç‚¹æ•°ï¼Œè¡¨ç¤ºæµ·æ‹”çš„ç²¾åº¦ï¼ˆå•ä½ï¼šç±³ï¼‰ã€‚è¿”å›<code>null</code>ã€‚</li><li><code>Coordinates.speed</code>ï¼šæµ®ç‚¹æ•°ï¼Œè¡¨ç¤ºè®¾å¤‡çš„é€Ÿåº¦ï¼ˆå•ä½ï¼šç±³/ç§’ï¼‰ã€‚å¦‚æœä¸å¯å¾—ï¼Œè¿”å›<code>null</code>ã€‚</li><li><code>Coordinates.heading</code>ï¼šæµ®ç‚¹æ•°ï¼Œè¡¨ç¤ºè®¾å¤‡å‰è¿›çš„æ–¹å‘ï¼ˆå•ä½ï¼šåº¦ï¼‰ã€‚æ–¹å‘æŒ‰ç…§é¡ºæ—¶é’ˆï¼ŒåŒ—æ–¹æ˜¯0åº¦ï¼Œä¸œæ–¹æ˜¯90åº¦ï¼Œè¥¿æ–¹æ˜¯270åº¦ã€‚å¦‚æœ<code>Coordinates.speed</code>ä¸º0ï¼Œ<code>heading</code>å±æ€§è¿”å›<code>NaN</code>ã€‚å¦‚æœè®¾å¤‡æ— æ³•æä¾›æ–¹å‘ä¿¡æ¯ï¼Œè¯¥å±æ€§è¿”å›<code>null</code>ã€‚</li></ul><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>navigator<span class="token punctuation">.</span>geolocation<span class="token punctuation">.</span><span class="token function">getCurrentPosition</span><span class="token punctuation">(</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">position</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> lat <span class="token operator">=</span> position<span class="token punctuation">.</span>coords<span class="token punctuation">.</span>latitude<span class="token punctuation">;</span>
  <span class="token keyword">let</span> long <span class="token operator">=</span> position<span class="token punctuation">.</span>coords<span class="token punctuation">.</span>longitude<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">çº¬åº¦ï¼š</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>lat<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ç»åº¦ï¼š</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>long<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å‚è€ƒé“¾æ¥-3" tabindex="-1"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥-3" aria-hidden="true">#</a> å‚è€ƒé“¾æ¥</h3><ul><li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Geolocation_API" target="_blank" rel="noopener noreferrer">Geolocation API<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, by MDN</li></ul><h2 id="intersectionobserver" tabindex="-1"><a class="header-anchor" href="#intersectionobserver" aria-hidden="true">#</a> IntersectionObserver</h2><p>ç½‘é¡µå¼€å‘æ—¶ï¼Œå¸¸å¸¸éœ€è¦äº†è§£æŸä¸ªå…ƒç´ æ˜¯å¦è¿›å…¥äº†â€œè§†å£â€ï¼ˆviewportï¼‰ï¼Œå³ç”¨æˆ·èƒ½ä¸èƒ½çœ‹åˆ°å®ƒã€‚</p><p><img src="https://xiaou-1305448902.cos.ap-nanjing.myqcloud.com/img/202308071415512.gif" alt="" loading="lazy"></p><p>ä¸Šå›¾çš„ç»¿è‰²æ–¹å—ä¸æ–­æ»šåŠ¨ï¼Œé¡¶éƒ¨ä¼šæç¤ºå®ƒçš„å¯è§æ€§ã€‚</p><p>ä¼ ç»Ÿçš„å®ç°æ–¹æ³•æ˜¯ï¼Œç›‘å¬åˆ°<code>scroll</code>äº‹ä»¶åï¼Œè°ƒç”¨ç›®æ ‡å…ƒç´ ï¼ˆç»¿è‰²æ–¹å—ï¼‰çš„<a href="https://developer.mozilla.org/en/docs/Web/API/Element/getBoundingClientRect" target="_blank" rel="noopener noreferrer"><code>getBoundingClientRect()</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>æ–¹æ³•ï¼Œå¾—åˆ°å®ƒå¯¹åº”äºè§†å£å·¦ä¸Šè§’çš„åæ ‡ï¼Œå†åˆ¤æ–­æ˜¯å¦åœ¨è§†å£ä¹‹å†…ã€‚è¿™ç§æ–¹æ³•çš„ç¼ºç‚¹æ˜¯ï¼Œç”±äº<code>scroll</code>äº‹ä»¶å¯†é›†å‘ç”Ÿï¼Œè®¡ç®—é‡å¾ˆå¤§ï¼Œå®¹æ˜“é€ æˆ<a href="http://www.ruanyifeng.com/blog/2015/09/web-page-performance-in-depth.html" target="_blank" rel="noopener noreferrer">æ€§èƒ½é—®é¢˜<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ã€‚</p><p><a href="https://wicg.github.io/IntersectionObserver/" target="_blank" rel="noopener noreferrer">IntersectionObserver API<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œå¯ä»¥è‡ªåŠ¨â€œè§‚å¯Ÿâ€å…ƒç´ æ˜¯å¦å¯è§ï¼ŒChrome 51+ å·²ç»æ”¯æŒã€‚ç”±äºå¯è§ï¼ˆvisibleï¼‰çš„æœ¬è´¨æ˜¯ï¼Œç›®æ ‡å…ƒç´ ä¸è§†å£äº§ç”Ÿä¸€ä¸ªäº¤å‰åŒºï¼Œæ‰€ä»¥è¿™ä¸ª API å«åšâ€œäº¤å‰è§‚å¯Ÿå™¨â€ï¼ˆintersection oberserverï¼‰ã€‚</p><h3 id="ç®€ä»‹-1" tabindex="-1"><a class="header-anchor" href="#ç®€ä»‹-1" aria-hidden="true">#</a> ç®€ä»‹</h3><p>IntersectionObserver API çš„ç”¨æ³•ï¼Œç®€å•æ¥è¯´å°±æ˜¯ä¸¤è¡Œã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IntersectionObserver</span><span class="token punctuation">(</span>callback<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>IntersectionObserver</code>æ˜¯æµè§ˆå™¨åŸç”Ÿæä¾›çš„æ„é€ å‡½æ•°ï¼Œæ¥å—ä¸¤ä¸ªå‚æ•°ï¼š<code>callback</code>æ˜¯å¯è§æ€§å˜åŒ–æ—¶çš„å›è°ƒå‡½æ•°ï¼Œ<code>option</code>æ˜¯é…ç½®å¯¹è±¡ï¼ˆè¯¥å‚æ•°å¯é€‰ï¼‰ã€‚</p><p><code>IntersectionObserver()</code>çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªè§‚å¯Ÿå™¨å®ä¾‹ã€‚å®ä¾‹çš„<code>observe()</code>æ–¹æ³•å¯ä»¥æŒ‡å®šè§‚å¯Ÿå“ªä¸ª DOM èŠ‚ç‚¹ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// å¼€å§‹è§‚å¯Ÿ</span>
observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;example&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// åœæ­¢è§‚å¯Ÿ</span>
observer<span class="token punctuation">.</span><span class="token function">unobserve</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å…³é—­è§‚å¯Ÿå™¨</span>
observer<span class="token punctuation">.</span><span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>observe()</code>çš„å‚æ•°æ˜¯ä¸€ä¸ª DOM èŠ‚ç‚¹å¯¹è±¡ã€‚å¦‚æœè¦è§‚å¯Ÿå¤šä¸ªèŠ‚ç‚¹ï¼Œå°±è¦å¤šæ¬¡è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>elementA<span class="token punctuation">)</span><span class="token punctuation">;</span>
observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>elementB<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼ŒIntersectionObserver API æ˜¯å¼‚æ­¥çš„ï¼Œä¸éšç€ç›®æ ‡å…ƒç´ çš„æ»šåŠ¨åŒæ­¥è§¦å‘ã€‚è§„æ ¼å†™æ˜ï¼Œ<code>IntersectionObserver</code>çš„å®ç°ï¼Œåº”è¯¥é‡‡ç”¨<code>requestIdleCallback()</code>ï¼Œå³åªæœ‰çº¿ç¨‹ç©ºé—²ä¸‹æ¥ï¼Œæ‰ä¼šæ‰§è¡Œè§‚å¯Ÿå™¨ã€‚è¿™æ„å‘³ç€ï¼Œè¿™ä¸ªè§‚å¯Ÿå™¨çš„ä¼˜å…ˆçº§éå¸¸ä½ï¼Œåªåœ¨å…¶ä»–ä»»åŠ¡æ‰§è¡Œå®Œï¼Œæµè§ˆå™¨æœ‰äº†ç©ºé—²æ‰ä¼šæ‰§è¡Œã€‚</p><h3 id="intersectionobserver-observe" tabindex="-1"><a class="header-anchor" href="#intersectionobserver-observe" aria-hidden="true">#</a> IntersectionObserver.observe()</h3><p>IntersectionObserver å®ä¾‹çš„<code>observe()</code>æ–¹æ³•ç”¨æ¥å¯åŠ¨å¯¹ä¸€ä¸ª DOM å…ƒç´ çš„è§‚å¯Ÿã€‚è¯¥æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šå›è°ƒå‡½æ•°<code>callback</code>å’Œé…ç½®å¯¹è±¡<code>options</code>ã€‚</p><h4 id="callback-å‚æ•°" tabindex="-1"><a class="header-anchor" href="#callback-å‚æ•°" aria-hidden="true">#</a> callback å‚æ•°</h4><p>ç›®æ ‡å…ƒç´ çš„å¯è§æ€§å˜åŒ–æ—¶ï¼Œå°±ä¼šè°ƒç”¨è§‚å¯Ÿå™¨çš„å›è°ƒå‡½æ•°<code>callback</code>ã€‚</p><p><code>callback</code>ä¼šè§¦å‘ä¸¤æ¬¡ã€‚ä¸€æ¬¡æ˜¯ç›®æ ‡å…ƒç´ åˆšåˆšè¿›å…¥è§†å£ï¼ˆå¼€å§‹å¯è§ï¼‰ï¼Œå¦ä¸€æ¬¡æ˜¯å®Œå…¨ç¦»å¼€è§†å£ï¼ˆå¼€å§‹ä¸å¯è§ï¼‰ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IntersectionObserver</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token parameter">entries<span class="token punctuation">,</span> observer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>entries<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå›è°ƒå‡½æ•°é‡‡ç”¨çš„æ˜¯<a href="http://es6.ruanyifeng.com/##docs/function##%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0" target="_blank" rel="noopener noreferrer">ç®­å¤´å‡½æ•°<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>çš„å†™æ³•ã€‚<code>callback</code>å‡½æ•°çš„å‚æ•°ï¼ˆ<code>entries</code>ï¼‰æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªæˆå‘˜éƒ½æ˜¯ä¸€ä¸ª<a href="https://developer.mozilla.org/en-US/docs/Web/API/IntersectionObserverEntry" target="_blank" rel="noopener noreferrer"><code>IntersectionObserverEntry</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>å¯¹è±¡ï¼ˆè¯¦è§ä¸‹æ–‡ï¼‰ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœåŒæ—¶æœ‰ä¸¤ä¸ªè¢«è§‚å¯Ÿçš„å¯¹è±¡çš„å¯è§æ€§å‘ç”Ÿå˜åŒ–ï¼Œ<code>entries</code>æ•°ç»„å°±ä¼šæœ‰ä¸¤ä¸ªæˆå‘˜ã€‚</p><h4 id="intersectionobserverentry-å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#intersectionobserverentry-å¯¹è±¡" aria-hidden="true">#</a> IntersectionObserverEntry å¯¹è±¡</h4><p><code>IntersectionObserverEntry</code>å¯¹è±¡æä¾›ç›®æ ‡å…ƒç´ çš„ä¿¡æ¯ï¼Œä¸€å…±æœ‰å…­ä¸ªå±æ€§ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token literal-property property">time</span><span class="token operator">:</span> <span class="token number">3893.92</span><span class="token punctuation">,</span>
  <span class="token literal-property property">rootBounds</span><span class="token operator">:</span> ClientRect <span class="token punctuation">{</span>
    <span class="token literal-property property">bottom</span><span class="token operator">:</span> <span class="token number">920</span><span class="token punctuation">,</span>
    <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">1024</span><span class="token punctuation">,</span>
    <span class="token literal-property property">left</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token literal-property property">right</span><span class="token operator">:</span> <span class="token number">1024</span><span class="token punctuation">,</span>
    <span class="token literal-property property">top</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">920</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">boundingClientRect</span><span class="token operator">:</span> ClientRect <span class="token punctuation">{</span>
     <span class="token comment">// ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">intersectionRect</span><span class="token operator">:</span> ClientRect <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">intersectionRatio</span><span class="token operator">:</span> <span class="token number">0.54</span><span class="token punctuation">,</span>
  <span class="token literal-property property">target</span><span class="token operator">:</span> element
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¯ä¸ªå±æ€§çš„å«ä¹‰å¦‚ä¸‹ã€‚</p><blockquote><ul><li><code>time</code>ï¼šå¯è§æ€§å‘ç”Ÿå˜åŒ–çš„æ—¶é—´ï¼Œæ˜¯ä¸€ä¸ªé«˜ç²¾åº¦æ—¶é—´æˆ³ï¼Œå•ä½ä¸ºæ¯«ç§’</li><li><code>target</code>ï¼šè¢«è§‚å¯Ÿçš„ç›®æ ‡å…ƒç´ ï¼Œæ˜¯ä¸€ä¸ª DOM èŠ‚ç‚¹å¯¹è±¡</li><li><code>rootBounds</code>ï¼šå®¹å™¨å…ƒç´ çš„çŸ©å½¢åŒºåŸŸçš„ä¿¡æ¯ï¼Œ<code>getBoundingClientRect()</code>æ–¹æ³•çš„è¿”å›å€¼ï¼Œå¦‚æœæ²¡æœ‰å®¹å™¨å…ƒç´ ï¼ˆå³ç›´æ¥ç›¸å¯¹äºè§†å£æ»šåŠ¨ï¼‰ï¼Œåˆ™è¿”å›<code>null</code></li><li><code>boundingClientRect</code>ï¼šç›®æ ‡å…ƒç´ çš„çŸ©å½¢åŒºåŸŸçš„ä¿¡æ¯</li><li><code>intersectionRect</code>ï¼šç›®æ ‡å…ƒç´ ä¸è§†å£ï¼ˆæˆ–å®¹å™¨å…ƒç´ ï¼‰çš„äº¤å‰åŒºåŸŸçš„ä¿¡æ¯</li><li><code>intersectionRatio</code>ï¼šç›®æ ‡å…ƒç´ çš„å¯è§æ¯”ä¾‹ï¼Œå³<code>intersectionRect</code>å <code>boundingClientRect</code>çš„æ¯”ä¾‹ï¼Œå®Œå…¨å¯è§æ—¶ä¸º<code>1</code>ï¼Œå®Œå…¨ä¸å¯è§æ—¶å°äºç­‰äº<code>0</code></li></ul></blockquote><p><img src="https://xiaou-1305448902.cos.ap-nanjing.myqcloud.com/img/202308071415501.png" alt="" loading="lazy"></p><p>ä¸Šå›¾ä¸­ï¼Œç°è‰²çš„æ°´å¹³æ–¹æ¡†ä»£è¡¨è§†å£ï¼Œæ·±çº¢è‰²çš„åŒºåŸŸä»£è¡¨å››ä¸ªè¢«è§‚å¯Ÿçš„ç›®æ ‡å…ƒç´ ã€‚å®ƒä»¬å„è‡ªçš„<code>intersectionRatio</code>å›¾ä¸­éƒ½å·²ç»æ³¨æ˜ã€‚</p><p>æˆ‘å†™äº†ä¸€ä¸ª <a href="http://jsbin.com/canuze/edit?js,console,output" target="_blank" rel="noopener noreferrer">Demo<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œæ¼”ç¤º<code>IntersectionObserverEntry</code>å¯¹è±¡ã€‚æ³¨æ„ï¼Œè¿™ä¸ª Demo åªèƒ½åœ¨ Chrome 51+ è¿è¡Œã€‚</p><h4 id="option-å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#option-å¯¹è±¡" aria-hidden="true">#</a> Option å¯¹è±¡</h4><p><code>IntersectionObserver</code>æ„é€ å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªé…ç½®å¯¹è±¡ã€‚å®ƒå¯ä»¥è®¾ç½®ä»¥ä¸‹å±æ€§ã€‚</p><p><strong>ï¼ˆ1ï¼‰threshold å±æ€§</strong></p><p><code>threshold</code>å±æ€§å†³å®šäº†ä»€ä¹ˆæ—¶å€™è§¦å‘å›è°ƒå‡½æ•°ï¼Œå³å…ƒç´ è¿›å…¥è§†å£ï¼ˆæˆ–è€…å®¹å™¨å…ƒç´ ï¼‰å¤šå°‘æ¯”ä¾‹æ—¶ï¼Œæ‰§è¡Œå›è°ƒå‡½æ•°ã€‚å®ƒæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªæˆå‘˜éƒ½æ˜¯ä¸€ä¸ªé—¨æ§›å€¼ï¼Œé»˜è®¤ä¸º<code>[0]</code>ï¼Œå³äº¤å‰æ¯”ä¾‹ï¼ˆ<code>intersectionRatio</code>ï¼‰è¾¾åˆ°<code>0</code>æ—¶è§¦å‘å›è°ƒå‡½æ•°ã€‚</p><p>å¦‚æœ<code>threshold</code>å±æ€§æ˜¯0.5ï¼Œå½“å…ƒç´ è¿›å…¥è§†å£50%æ—¶ï¼Œè§¦å‘å›è°ƒå‡½æ•°ã€‚å¦‚æœå€¼ä¸º<code>[0.3, 0.6]</code>ï¼Œåˆ™å½“å…ƒç´ è¿›å…¥30ï¼…å’Œ60ï¼…æ˜¯è§¦å‘å›è°ƒå‡½æ•°ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">new</span> <span class="token class-name">IntersectionObserver</span><span class="token punctuation">(</span>
  <span class="token parameter">entries</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">/* â€¦ */</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">threshold</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰è¿™ä¸ªæ•°ç»„ã€‚æ¯”å¦‚ï¼Œä¸Šä¾‹çš„<code>[0, 0.25, 0.5, 0.75, 1]</code>å°±è¡¨ç¤ºå½“ç›®æ ‡å…ƒç´  0%ã€25%ã€50%ã€75%ã€100% å¯è§æ—¶ï¼Œä¼šè§¦å‘å›è°ƒå‡½æ•°ã€‚</p><p><img src="https://xiaou-1305448902.cos.ap-nanjing.myqcloud.com/img/202308071415506.gif" alt="" loading="lazy"></p><p><strong>ï¼ˆ2ï¼‰root å±æ€§ï¼ŒrootMargin å±æ€§</strong></p><p><code>IntersectionObserver</code>ä¸ä»…å¯ä»¥è§‚å¯Ÿå…ƒç´ ç›¸å¯¹äºè§†å£çš„å¯è§æ€§ï¼Œè¿˜å¯ä»¥è§‚å¯Ÿå…ƒç´ ç›¸å¯¹äºå…¶æ‰€åœ¨å®¹å™¨çš„å¯è§æ€§ã€‚å®¹å™¨å†…æ»šåŠ¨ä¹Ÿä¼šå½±å“ç›®æ ‡å…ƒç´ çš„å¯è§æ€§ï¼Œå‚è§æœ¬æ–‡å¼€å§‹æ—¶çš„é‚£å¼ ç¤ºæ„å›¾ã€‚</p><p>IntersectionObserver API æ”¯æŒå®¹å™¨å†…æ»šåŠ¨ã€‚<code>root</code>å±æ€§æŒ‡å®šç›®æ ‡å…ƒç´ æ‰€åœ¨çš„å®¹å™¨èŠ‚ç‚¹ã€‚æ³¨æ„ï¼Œå®¹å™¨å…ƒç´ å¿…é¡»æ˜¯ç›®æ ‡å…ƒç´ çš„ç¥–å…ˆèŠ‚ç‚¹ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> opts <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">root</span><span class="token operator">:</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.container&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">rootMargin</span><span class="token operator">:</span> <span class="token string">&#39;0px 0px -200px 0px&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IntersectionObserver</span><span class="token punctuation">(</span>
  callback<span class="token punctuation">,</span>
  opts
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œé™¤äº†<code>root</code>å±æ€§ï¼Œè¿˜æœ‰<a href="https://wicg.github.io/IntersectionObserver/##dom-intersectionobserverinit-rootmargin" target="_blank" rel="noopener noreferrer"><code>rootMargin</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>å±æ€§ã€‚è¯¥å±æ€§ç”¨æ¥æ‰©å±•æˆ–ç¼©å°<code>rootBounds</code>è¿™ä¸ªçŸ©å½¢çš„å¤§å°ï¼Œä»è€Œå½±å“<code>intersectionRect</code>äº¤å‰åŒºåŸŸçš„å¤§å°ã€‚å®ƒçš„å†™æ³•ç±»ä¼¼äº CSS çš„<code>margin</code>å±æ€§ï¼Œæ¯”å¦‚<code>0px 0px 0px 0px</code>ï¼Œä¾æ¬¡è¡¨ç¤º topã€rightã€bottom å’Œ left å››ä¸ªæ–¹å‘çš„å€¼ã€‚</p><p>ä¸Šä¾‹çš„<code>0px 0px -200px 0px</code>ï¼Œè¡¨ç¤ºå®¹å™¨çš„ä¸‹è¾¹ç¼˜å‘ä¸Šæ”¶ç¼©200åƒç´ ï¼Œå¯¼è‡´é¡µé¢å‘ä¸‹æ»šåŠ¨æ—¶ï¼Œç›®æ ‡å…ƒç´ çš„é¡¶éƒ¨è¿›å…¥å¯è§†åŒºåŸŸ200åƒç´ ä»¥åï¼Œæ‰ä¼šè§¦å‘å›è°ƒå‡½æ•°ã€‚</p><p>è¿™æ ·è®¾ç½®ä»¥åï¼Œä¸ç®¡æ˜¯çª—å£æ»šåŠ¨æˆ–è€…å®¹å™¨å†…æ»šåŠ¨ï¼Œåªè¦ç›®æ ‡å…ƒç´ å¯è§æ€§å˜åŒ–ï¼Œéƒ½ä¼šè§¦å‘è§‚å¯Ÿå™¨ã€‚</p><h3 id="å®ä¾‹" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹" aria-hidden="true">#</a> å®ä¾‹</h3><h4 id="æƒ°æ€§åŠ è½½-lazy-load" tabindex="-1"><a class="header-anchor" href="#æƒ°æ€§åŠ è½½-lazy-load" aria-hidden="true">#</a> æƒ°æ€§åŠ è½½ï¼ˆlazy loadï¼‰</h4><p>æœ‰æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›æŸäº›é™æ€èµ„æºï¼ˆæ¯”å¦‚å›¾ç‰‡ï¼‰ï¼Œåªæœ‰ç”¨æˆ·å‘ä¸‹æ»šåŠ¨ï¼Œå®ƒä»¬è¿›å…¥è§†å£æ—¶æ‰åŠ è½½ï¼Œè¿™æ ·å¯ä»¥èŠ‚çœå¸¦å®½ï¼Œæé«˜ç½‘é¡µæ€§èƒ½ã€‚è¿™å°±å«åšâ€œæƒ°æ€§åŠ è½½â€ã€‚</p><p>æœ‰äº† IntersectionObserver APIï¼Œå®ç°èµ·æ¥å°±å¾ˆå®¹æ˜“äº†ã€‚å›¾åƒçš„ HTML ä»£ç å¯ä»¥å†™æˆä¸‹é¢è¿™æ ·ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>placeholder.png<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>img-1.jpg<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>placeholder.png<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>img-2.jpg<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>placeholder.png<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>img-3.jpg<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå›¾åƒé»˜è®¤æ˜¾ç¤ºä¸€ä¸ªå ä½ç¬¦ï¼Œ<code>data-src</code>å±æ€§æ˜¯æƒ°æ€§åŠ è½½çš„çœŸæ­£å›¾åƒã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token parameter">selector</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IntersectionObserver</span><span class="token punctuation">(</span>
  <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">entries</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    entries<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">entry</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      entry<span class="token punctuation">.</span>target<span class="token punctuation">.</span>src <span class="token operator">=</span> entry<span class="token punctuation">.</span>target<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>src<span class="token punctuation">;</span>
      observer<span class="token punctuation">.</span><span class="token function">unobserve</span><span class="token punctuation">(</span>entry<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">query</span><span class="token punctuation">(</span><span class="token string">&#39;.lazy-loaded&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œåªæœ‰å›¾åƒå¼€å§‹å¯è§æ—¶ï¼Œæ‰ä¼šåŠ è½½çœŸæ­£çš„å›¾åƒæ–‡ä»¶ã€‚</p><h4 id="æ— é™æ»šåŠ¨" tabindex="-1"><a class="header-anchor" href="#æ— é™æ»šåŠ¨" aria-hidden="true">#</a> æ— é™æ»šåŠ¨</h4><p>æ— é™æ»šåŠ¨ï¼ˆinfinite scrollï¼‰æŒ‡çš„æ˜¯ï¼Œéšç€ç½‘é¡µæ»šåŠ¨åˆ°åº•éƒ¨ï¼Œä¸æ–­åŠ è½½æ–°çš„å†…å®¹åˆ°é¡µé¢ï¼Œå®ƒçš„å®ç°ä¹Ÿå¾ˆç®€å•ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> intersectionObserver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IntersectionObserver</span><span class="token punctuation">(</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">entries</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¦‚æœä¸å¯è§ï¼Œå°±è¿”å›</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>entries<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>intersectionRatio <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token function">loadItems</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Loaded new items&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å¼€å§‹è§‚å¯Ÿ</span>
intersectionObserver<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>
  document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;.scrollerFooter&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ— é™æ»šåŠ¨æ—¶ï¼Œæœ€å¥½åƒä¸Šä¾‹é‚£æ ·ï¼Œé¡µé¢åº•éƒ¨æœ‰ä¸€ä¸ªé¡µå°¾æ ï¼ˆåˆç§°<a href="sentinels">sentinels</a>ï¼Œä¸Šä¾‹æ˜¯<code>.scrollerFooter</code>ï¼‰ã€‚ä¸€æ—¦é¡µå°¾æ å¯è§ï¼Œå°±è¡¨ç¤ºç”¨æˆ·åˆ°è¾¾äº†é¡µé¢åº•éƒ¨ï¼Œä»è€ŒåŠ è½½æ–°çš„æ¡ç›®æ”¾åœ¨é¡µå°¾æ å‰é¢ã€‚å¦åˆ™å°±éœ€è¦æ¯ä¸€æ¬¡é¡µé¢åŠ å…¥æ–°å†…å®¹æ—¶ï¼Œéƒ½è°ƒç”¨<code>observe()</code>æ–¹æ³•ï¼Œå¯¹æ–°å¢å†…å®¹çš„åº•éƒ¨å»ºç«‹è§‚å¯Ÿã€‚</p><h4 id="è§†é¢‘è‡ªåŠ¨æ’­æ”¾" tabindex="-1"><a class="header-anchor" href="#è§†é¢‘è‡ªåŠ¨æ’­æ”¾" aria-hidden="true">#</a> è§†é¢‘è‡ªåŠ¨æ’­æ”¾</h4><p>ä¸‹é¢æ˜¯ä¸€ä¸ªè§†é¢‘å…ƒç´ ï¼Œå¸Œæœ›å®ƒå®Œå…¨è¿›å…¥è§†å£çš„æ—¶å€™è‡ªåŠ¨æ’­æ”¾ï¼Œç¦»å¼€è§†å£çš„æ—¶å€™è‡ªåŠ¨æš‚åœã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>video</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>foo.mp4<span class="token punctuation">&quot;</span></span> <span class="token attr-name">controls</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>video</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä¸‹é¢æ˜¯ JS ä»£ç ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">let</span> video <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;video&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> isPaused <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IntersectionObserver</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">entries<span class="token punctuation">,</span> observer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  entries<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">entry</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>entry<span class="token punctuation">.</span>intersectionRatio <span class="token operator">!=</span> <span class="token number">1</span>  <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>video<span class="token punctuation">.</span>paused<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      video<span class="token punctuation">.</span><span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      isPaused <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>isPaused<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      video<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      isPaused<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">threshold</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>video<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>IntersectionObserver()</code>çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯é…ç½®å¯¹è±¡ï¼Œå®ƒçš„<code>threshold</code>å±æ€§ç­‰äº<code>1</code>ï¼Œå³ç›®æ ‡å…ƒç´ å®Œå…¨å¯è§æ—¶è§¦å‘å›è°ƒå‡½æ•°ã€‚</p><h3 id="å‚è€ƒé“¾æ¥-4" tabindex="-1"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥-4" aria-hidden="true">#</a> å‚è€ƒé“¾æ¥</h3><ul><li><a href="https://developers.google.com/web/updates/2016/04/intersectionobserver" target="_blank" rel="noopener noreferrer">IntersectionObserverâ€™s Coming into View<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://github.com/WICG/IntersectionObserver/blob/gh-pages/explainer.md" target="_blank" rel="noopener noreferrer">Intersection Observers Explained<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://css-tricks.com/a-few-functional-uses-for-intersection-observer-to-know-when-an-element-is-in-view/" target="_blank" rel="noopener noreferrer">A Few Functional Uses for Intersection Observer to Know When an Element is in View<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, Preethi</li></ul><h2 id="intl-relativetimeformat" tabindex="-1"><a class="header-anchor" href="#intl-relativetimeformat" aria-hidden="true">#</a> Intl.RelativeTimeFormat</h2><p>å¾ˆå¤šæ—¥æœŸåº“æ”¯æŒæ˜¾ç¤ºç›¸å¯¹æ—¶é—´ï¼Œæ¯”å¦‚â€œæ˜¨å¤©â€ã€â€œäº”åˆ†é’Ÿå‰â€ã€â€œä¸¤ä¸ªæœˆä¹‹å‰â€ç­‰ç­‰ã€‚ç”±äºä¸åŒçš„è¯­è¨€ï¼Œæ—¥æœŸæ˜¾ç¤ºçš„æ ¼å¼å’Œç›¸å…³è¯è¯­éƒ½ä¸åŒï¼Œé€ æˆè¿™äº›åº“çš„ä½“ç§¯éå¸¸å¤§ã€‚</p><p>ç°åœ¨ï¼Œæµè§ˆå™¨æä¾›å†…ç½®çš„ Intl.RelativeTimeFormat APIï¼Œå¯ä»¥ä¸ä½¿ç”¨è¿™äº›åº“ï¼Œç›´æ¥æ˜¾ç¤ºç›¸å¯¹æ—¶é—´ã€‚</p><h3 id="åŸºæœ¬ç”¨æ³•-1" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ç”¨æ³•-1" aria-hidden="true">#</a> åŸºæœ¬ç”¨æ³•</h3><p><code>Intl.RelativeTimeFormat()</code>æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œæ¥å—ä¸€ä¸ªè¯­è¨€ä»£ç ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªç›¸å¯¹æ—¶é—´çš„å®ä¾‹å¯¹è±¡ã€‚å¦‚æœçœç•¥å‚æ•°ï¼Œåˆ™é»˜è®¤ä¼ å…¥å½“å‰è¿è¡Œæ—¶çš„è¯­è¨€ä»£ç ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> rtf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intl<span class="token punctuation">.</span>RelativeTimeFormat</span><span class="token punctuation">(</span><span class="token string">&#39;en&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">3.14</span><span class="token punctuation">,</span> <span class="token string">&#39;second&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;in 3.14 seconds&quot;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token string">&#39;minute&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;15 minutes ago&quot;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">&#39;hour&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;in 8 hours&quot;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&#39;day&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;2 days ago&quot;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&#39;week&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;in 3 weeks&quot;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">&#39;month&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;5 months ago&quot;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&#39;quarter&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;in 2 quarters&quot;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">42</span><span class="token punctuation">,</span> <span class="token string">&#39;year&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;42 years ago&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç æŒ‡å®šä½¿ç”¨è‹±è¯­æ˜¾ç¤ºç›¸å¯¹æ—¶é—´ã€‚</p><p>ä¸‹é¢æ˜¯ä½¿ç”¨è¥¿ç­ç‰™è¯­æ˜¾ç¤ºç›¸å¯¹æ—¶é—´çš„ä¾‹å­ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> rtf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intl<span class="token punctuation">.</span>RelativeTimeFormat</span><span class="token punctuation">(</span><span class="token string">&#39;es&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">3.14</span><span class="token punctuation">,</span> <span class="token string">&#39;second&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;dentro de 3,14 segundos&quot;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token string">&#39;minute&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;hace 15 minutos&quot;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">&#39;hour&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;dentro de 8 horas&quot;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&#39;day&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;hace 2 dÃ­as&quot;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&#39;week&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;dentro de 3 semanas&quot;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">&#39;month&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;hace 5 meses&quot;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&#39;quarter&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;dentro de 2 trimestres&quot;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">42</span><span class="token punctuation">,</span> <span class="token string">&#39;year&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;hace 42 aÃ±os&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>Intl.RelativeTimeFormat()</code>è¿˜å¯ä»¥æ¥å—ä¸€ä¸ªé…ç½®å¯¹è±¡ï¼Œä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ï¼Œç”¨æ¥ç²¾ç¡®æŒ‡å®šç›¸å¯¹æ—¶é—´å®ä¾‹çš„è¡Œä¸ºã€‚é…ç½®å¯¹è±¡å…±æœ‰ä¸‹é¢è¿™äº›å±æ€§ã€‚</p><ul><li>options.styleï¼šè¡¨ç¤ºè¿”å›å­—ç¬¦ä¸²çš„é£æ ¼ï¼Œå¯èƒ½çš„å€¼æœ‰<code>long</code>ï¼ˆé»˜è®¤å€¼ï¼Œæ¯”å¦‚â€œin 1 monthâ€ï¼‰ã€<code>short</code>ï¼ˆæ¯”å¦‚â€œin 1 mo.â€ï¼‰ã€<code>narrow</code>ï¼ˆæ¯”å¦‚â€œin 1 mo.â€ï¼‰ã€‚å¯¹äºä¸€éƒ¨åˆ†è¯­è¨€æ¥è¯´ï¼Œ<code>narrow</code>é£æ ¼å’Œ<code>short</code>é£æ ¼æ˜¯ç±»ä¼¼çš„ã€‚</li><li>options.localeMatcherï¼šè¡¨ç¤ºåŒ¹é…è¯­è¨€å‚æ•°çš„ç®—æ³•ï¼Œå¯èƒ½çš„å€¼æœ‰<code>best fit</code>ï¼ˆé»˜è®¤å€¼ï¼‰å’Œ<code>lookup</code>ã€‚</li><li>options.numericï¼šè¡¨ç¤ºè¿”å›å­—ç¬¦ä¸²æ˜¯æ•°å­—æ˜¾ç¤ºï¼Œè¿˜æ˜¯æ–‡å­—æ˜¾ç¤ºï¼Œå¯èƒ½çš„å€¼æœ‰<code>always</code>ï¼ˆé»˜è®¤å€¼ï¼Œæ€»æ˜¯æ–‡å­—æ˜¾ç¤ºï¼‰å’Œ<code>auto</code>ï¼ˆè‡ªåŠ¨è½¬æ¢ï¼‰ã€‚</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// ä¸‹é¢çš„é…ç½®å¯¹è±¡ï¼Œä¼ å…¥çš„éƒ½æ˜¯é»˜è®¤å€¼</span>
<span class="token keyword">const</span> rtf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intl<span class="token punctuation">.</span>RelativeTimeFormat</span><span class="token punctuation">(</span><span class="token string">&#39;en&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">localeMatcher</span><span class="token operator">:</span> <span class="token string">&#39;best fit&#39;</span><span class="token punctuation">,</span> <span class="token comment">// å…¶ä»–å€¼ï¼š&#39;lookup&#39;</span>
  <span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token string">&#39;long&#39;</span><span class="token punctuation">,</span> <span class="token comment">// å…¶ä»–å€¼ï¼š&#39;short&#39; or &#39;narrow&#39;</span>
  <span class="token literal-property property">numeric</span><span class="token operator">:</span> <span class="token string">&#39;always&#39;</span><span class="token punctuation">,</span> <span class="token comment">// å…¶ä»–å€¼ï¼š&#39;auto&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Now, letâ€™s try some special cases!</span>

rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;day&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;1 day ago&quot;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&#39;day&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;in 0 days&quot;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;day&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;in 1 day&quot;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;week&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;1 week ago&quot;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&#39;week&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;in 0 weeks&quot;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;week&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;in 1 week&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ˜¾ç¤ºçš„æ˜¯â€œ1 day agoâ€ï¼Œè€Œä¸æ˜¯â€œyesterdayâ€ï¼›æ˜¾ç¤ºçš„æ˜¯â€œin 0 weeksâ€ï¼Œè€Œä¸æ˜¯â€œthis weekâ€ã€‚è¿™æ˜¯å› ä¸ºé»˜è®¤æƒ…å†µä¸‹ï¼Œç›¸å¯¹æ—¶é—´æ˜¾ç¤ºçš„æ˜¯æ•°å€¼å½¢å¼ï¼Œè€Œä¸æ˜¯æ–‡å­—å½¢å¼ã€‚</p><p>æ”¹å˜è¿™ä¸ªè¡Œä¸ºï¼Œå¯ä»¥æŠŠé…ç½®å¯¹è±¡çš„<code>numeric</code>å±æ€§æ”¹æˆ<code>auto</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> rtf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intl<span class="token punctuation">.</span>RelativeTimeFormat</span><span class="token punctuation">(</span><span class="token string">&#39;en&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">numeric</span><span class="token operator">:</span> <span class="token string">&#39;auto&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;day&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;yesterday&quot;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&#39;day&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;today&quot;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;day&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;tomorrow&quot;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;week&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;last week&quot;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&#39;week&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;this week&quot;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;week&#39;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;next week&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="intl-relativetimeformat-prototype-format" tabindex="-1"><a class="header-anchor" href="#intl-relativetimeformat-prototype-format" aria-hidden="true">#</a> Intl.RelativeTimeFormat.prototype.format()</h3><p>ç›¸å¯¹æ—¶é—´å®ä¾‹å¯¹è±¡çš„<code>format</code>æ–¹æ³•ï¼Œæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œä¾æ¬¡ä¸ºæ—¶é—´é—´éš”çš„æ•°å€¼å’Œå•ä½ã€‚å…¶ä¸­ï¼Œâ€œå•ä½â€æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¯ä»¥æ¥å—ä»¥ä¸‹å…«ä¸ªå€¼ã€‚</p><ul><li>year</li><li>quarter</li><li>month</li><li>week</li><li>day</li><li>hour</li><li>minute</li><li>second</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">let</span> rtf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intl<span class="token punctuation">.</span>RelativeTimeFormat</span><span class="token punctuation">(</span><span class="token string">&#39;en&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;day&quot;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;yesterday&quot;</span>
rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">2.15</span><span class="token punctuation">,</span> <span class="token string">&quot;day&quot;</span><span class="token punctuation">)</span> <span class="token comment">// &quot;in 2.15 days</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="intl-relativetimeformat-prototype-formattoparts" tabindex="-1"><a class="header-anchor" href="#intl-relativetimeformat-prototype-formattoparts" aria-hidden="true">#</a> Intl.RelativeTimeFormat.prototype.formatToParts()</h3><p>ç›¸å¯¹æ—¶é—´å®ä¾‹å¯¹è±¡çš„<code>formatToParts()</code>æ–¹æ³•çš„å‚æ•°è·Ÿ<code>format()</code>æ–¹æ³•ä¸€æ ·ï¼Œä½†æ˜¯è¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œç”¨æ¥ç²¾ç¡®æ§åˆ¶ç›¸å¯¹æ—¶é—´çš„æ¯ä¸ªéƒ¨åˆ†ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> rtf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intl<span class="token punctuation">.</span>RelativeTimeFormat</span><span class="token punctuation">(</span><span class="token string">&#39;en&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">numeric</span><span class="token operator">:</span> <span class="token string">&#39;auto&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;day&#39;</span><span class="token punctuation">)</span> 
<span class="token comment">// &quot;yesterday&quot;</span>
rtf<span class="token punctuation">.</span><span class="token function">formatToParts</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;day&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// [{ type: &quot;literal&quot;, value: &quot;yesterday&quot; }]</span>

rtf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&#39;week&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// &quot;in 3 weeks&quot;</span>
rtf<span class="token punctuation">.</span><span class="token function">formatToParts</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&#39;week&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// [</span>
<span class="token comment">//   { type: &#39;literal&#39;, value: &#39;in &#39; },</span>
<span class="token comment">//   { type: &#39;integer&#39;, value: &#39;3&#39;, unit: &#39;week&#39; },</span>
<span class="token comment">//   { type: &#39;literal&#39;, value: &#39; weeks&#39; }</span>
<span class="token comment">// ]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿”å›æ•°ç»„çš„æ¯ä¸ªæˆå‘˜éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ‹¥æœ‰ä¸¤ä¸ªå±æ€§ã€‚</p><ul><li>typeï¼šå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºè¾“å‡ºå€¼çš„ç±»å‹ã€‚</li><li>valueï¼šå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºè¾“å‡ºçš„å†…å®¹ã€‚</li><li>unitï¼šå¦‚æœè¾“å‡ºå†…å®¹è¡¨ç¤ºä¸€ä¸ªæ•°å€¼ï¼ˆå³<code>type</code>å±æ€§ä¸æ˜¯<code>literal</code>ï¼‰ï¼Œé‚£ä¹ˆè¿˜ä¼šæœ‰<code>unit</code>å±æ€§ï¼Œè¡¨ç¤ºæ•°å€¼çš„å•ä½ã€‚</li></ul><h3 id="å‚è€ƒé“¾æ¥-5" tabindex="-1"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥-5" aria-hidden="true">#</a> å‚è€ƒé“¾æ¥</h3><ul><li><a href="https://developers.google.com/web/updates/2018/10/intl-relativetimeformat" target="_blank" rel="noopener noreferrer">The Intl.RelativeTimeFormat API<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, Mathias Bynens</li><li><a href="https://github.com/tc39/proposal-intl-relative-time##api" target="_blank" rel="noopener noreferrer">Intl.RelativeTimeFormat API Specification<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, TC39</li></ul><h2 id="offline-åº”ç”¨" tabindex="-1"><a class="header-anchor" href="#offline-åº”ç”¨" aria-hidden="true">#</a> Offline åº”ç”¨</h2><p>Web åº”ç”¨ä¸ä»…å¯ä»¥åœ¨æµè§ˆå™¨ç¼“å­˜èµ„æºæ–‡ä»¶ï¼ˆHTMLã€CSSã€JS è„šæœ¬ã€å›¾ç‰‡ç­‰ï¼‰ï¼Œè¿˜å¯ä»¥æŠŠåº”ç”¨æœ¬èº«å‚¨å­˜åˆ°æµè§ˆå™¨ã€‚</p><p>ç¼“å­˜çš„èµ„æºæ–‡ä»¶å¿…é¡»åœ¨çº¿ä½¿ç”¨ï¼Œåªæœ‰å…ˆä»æœåŠ¡å™¨åŠ è½½ç½‘é¡µï¼Œç„¶åæ‰èƒ½ä½¿ç”¨æœ¬åœ°ç¼“å­˜ï¼›ä½†æ˜¯ï¼Œåº”ç”¨ä¸€æ—¦å‚¨å­˜ï¼Œå°±å¯ä»¥ç¦»çº¿ä½¿ç”¨ã€‚å¦å¤–ï¼Œç”¨æˆ·å¸¸è§„æ€§åœ°æ¸…é™¤æµè§ˆå™¨ç¼“å­˜ï¼Œå¹¶ä¸ä¼šæ¸…é™¤å‚¨å­˜çš„åº”ç”¨ï¼Œé™¤éç”¨æˆ·æ˜¾å¼åœ°å¸è½½æˆ–åˆ é™¤å®ƒä»¬ã€‚</p><p>ä¸ºäº†å¼€å¯ç¦»çº¿å‚¨å­˜ï¼Œå¿…é¡»åˆ›å»ºä¸€ä¸ª manifest æ–‡ä»¶ã€‚è¯¥æ–‡ä»¶åˆ—å‡ºäº†æ‰€æœ‰éœ€è¦å‚¨å­˜çš„æ–‡ä»¶ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>CACHE MANIFEST
myapp.html
myapp.js
myapp.css
/images/front_end/background.png
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Manifest æ–‡ä»¶çš„ç¬¬ä¸€è¡Œå¿…é¡»æ˜¯<code>CACHE MANIFEST</code>ã€‚ç„¶åï¼Œæ¯ä¸€è¡Œåˆ—å‡ºä¸€ä¸ªéœ€è¦å‚¨å­˜çš„æ–‡ä»¶ï¼Œå®ƒä»¬çš„ä½ç½®éƒ½æ˜¯ç›¸å¯¹äº Manifest æ–‡ä»¶çš„ä½ç½®ã€‚ç©ºè¡Œä¼šè¢«å¿½ç•¥ï¼Œä»¥<code>##</code>å¼€å¤´çš„è¡Œæ˜¯æ³¨é‡Šï¼Œä¹Ÿä¼šè¢«å¿½ç•¥ã€‚</p><p>è¿™ä¸ªæ–‡ä»¶çš„åç¼€åä¸€èˆ¬æ˜¯<code>.appcache</code>ã€‚å®ƒçš„ MIME ç±»å‹å¿…é¡»æ˜¯<code>text/cache-manifest</code>ï¼Œå¦‚æœæœåŠ¡å™¨å°†å…¶è®¾ä¸ºå…¶ä»–ç±»å‹ï¼Œå°±ä¸ä¼šè¢«æµè§ˆå™¨ç¼“å­˜ã€‚</p><p>ç¼–å†™å®Œè¿™ä¸ªæ–‡ä»¶ä»¥åï¼Œè¦å°†<code>&lt;html&gt;</code>å…ƒç´ çš„<code>manifest</code>å±æ€§æŒ‡å‘å®ƒã€‚æµè§ˆå™¨åŠ è½½è¿™ä¸ªç½‘é¡µçš„æ—¶å€™ï¼Œå°±ä¼šè¯»å–è¿™ä¸ª Manifest æ–‡ä»¶ï¼Œç¦»çº¿å‚¨å­˜è¿™ä¸ªç½‘é¡µå’Œç›¸å…³çš„èµ„æºã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">HTML</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">manifest</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myapp.appcache<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœä¸€ä¸ª Web åº”ç”¨æœ‰å¤šä¸ªç½‘é¡µéœ€è¦ç¦»çº¿å‚¨å­˜ï¼Œé‚£ä¹ˆæ¯ä¸ªç½‘é¡µéƒ½åº”è¯¥å°†<code>manifest</code>å±æ€§æŒ‡å‘è¿™ä¸ªæ–‡ä»¶ã€‚ä¸€æ—¦è¢«å‚¨å­˜ï¼Œä»¥ååŠ è½½è¯¥ç½‘é¡µçš„æ—¶å€™ï¼Œå°±ä¼šä»ç¼“å­˜é‡Œé¢åŠ è½½ã€‚è¿™æ—¶ï¼Œåªæœ‰ Manifest æ–‡ä»¶é‡Œé¢åˆ—å‡ºçš„æ–‡ä»¶ä¼šè¢«åŠ è½½ï¼Œå…¶ä»–æ–‡ä»¶ä¸ä¼šã€‚å¦‚æœè¿™æ—¶æµè§ˆå™¨åœ¨çº¿ï¼Œæµè§ˆå™¨å°±ä¼šå»æ£€æŸ¥ Manifest æ–‡ä»¶æ˜¯å¦æœ‰æ–°ç‰ˆæœ¬ï¼Œå¦‚æœæœ‰æ–°ç‰ˆæœ¬ï¼Œå°±ä¼šé‡æ–°å‚¨å­˜å’Œæ›´æ–°è¯¥æ–‡ä»¶åˆ—å‡ºçš„èµ„æºã€‚æœ€æ–¹ä¾¿çš„åŠæ³•æ˜¯åœ¨ Manifest æ–‡ä»¶é‡Œé¢ç”¨æ³¨é‡Šåˆ—å‡ºç‰ˆæœ¬å·ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>CACHE MANIFEST
## MyApp version 1
MyApp.html
MyApp.js
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœéœ€è¦åˆ é™¤ç¦»çº¿å‚¨å­˜ï¼Œåªè¦åˆ é™¤ Manifest æ–‡ä»¶ï¼Œè®©å…¶è¿”å› 404 çŠ¶æ€ç å³å¯ã€‚</p><p>ç¦»çº¿å‚¨å­˜æ›´æ–°å®Œæˆï¼Œä¼šè§¦å‘æµè§ˆå™¨çš„<code>updateready</code>äº‹ä»¶ï¼Œå¯ä»¥å¯¹è¿™ä¸ªäº‹ä»¶æŒ‡å®šç›‘å¬å‡½æ•°ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>window<span class="token punctuation">.</span>applicationCache<span class="token punctuation">.</span><span class="token function-variable function">onupdateready</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> reload <span class="token operator">=</span> <span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">&#39;æ–°ç‰ˆæœ¬ä¸‹è½½å®Œæˆã€‚æ˜¯å¦éœ€è¦é‡æ–°åŠ è½½ï¼Ÿ&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>reload<span class="token punctuation">)</span> location<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è„šæœ¬å¯ä»¥æ³¨å†Œ<code>online</code>å’Œ<code>offline</code>äº‹ä»¶çš„ç›‘å¬å‡½æ•°ï¼Œé€šè¿‡<code>navigator.onLine</code>å±æ€§ï¼Œåˆ¤æ–­æµè§ˆå™¨æ˜¯å¦åœ¨çº¿ä»è€Œè¿›è¡Œæ•°æ®åŒæ­¥ã€‚</p><p>æ¯æ¬¡æµè§ˆå™¨åŠ è½½ä¸€ä¸ªå…·æœ‰<code>manifest</code>å±æ€§çš„ç½‘é¡µï¼Œæµè§ˆå™¨å°±ä¼šè§¦å‘ä¸€ä¸ª<code>checking</code>äº‹ä»¶ï¼Œç„¶åå»åŠ è½½ Manifest æ–‡ä»¶ã€‚</p><ul><li>å¦‚æœåº”ç”¨å·²ç»å‚¨å­˜ï¼Œå¹¶ä¸” Manifest æ–‡ä»¶æ²¡æœ‰å˜åŒ–ï¼Œé‚£ä¹ˆè§¦å‘<code>noupdate</code>äº‹ä»¶ã€‚</li><li>å¦‚æœåº”ç”¨å·²ç»å‚¨å­˜ï¼Œå¹¶ä¸” Manifest æ–‡ä»¶æœ‰å˜åŒ–ï¼Œé‚£ä¹ˆè§¦å‘<code>downloading</code>äº‹ä»¶ï¼Œæµè§ˆå™¨é‡æ–°ä¸‹è½½æ‰€æœ‰ç¦»çº¿èµ„æºã€‚ä¸‹è½½è¿‡ç¨‹ä¸­ï¼Œè§¦å‘<code>progress</code>äº‹ä»¶ï¼Œä¸‹è½½ç»“æŸè§¦å‘<code>updateready</code>äº‹ä»¶ã€‚</li><li>å¦‚æœåº”ç”¨æ²¡æœ‰å‚¨å­˜ï¼Œä¸‹è½½ç»“æŸå°†è§¦å‘<code>cached</code>äº‹ä»¶ã€‚</li><li>å¦‚æœç¦»çº¿ï¼Œæ— æ³•æ£€æŸ¥ Manifest æ–‡ä»¶ï¼Œæµè§ˆå™¨ä¼šè§¦å‘ä¸€ä¸ª<code>error</code>äº‹ä»¶ã€‚</li><li>å¦‚æœæµè§ˆå™¨åœ¨çº¿ï¼Œè€Œä¸”åº”ç”¨å·²ç»å‚¨å­˜ï¼Œä½†æ˜¯ Manifest æ–‡ä»¶è¿”å› 404ï¼Œæµè§ˆå™¨è§¦å‘<code>obsolete</code>äº‹ä»¶ï¼Œå°†å‚¨å­˜çš„åº”ç”¨ç§»é™¤ã€‚</li></ul><p>æ‰€æœ‰è¿™äº›äº‹ä»¶éƒ½æ˜¯å¯ä»¥å–æ¶ˆçš„ã€‚ç›‘å¬å‡½æ•°å¯ä»¥è¿”å›<code>false</code>ï¼Œå–æ¶ˆè¿™äº›äº‹ä»¶çš„é»˜è®¤åŠ¨ä½œã€‚</p><p><code>applicationCache. status</code>å±æ€§è¿”å›ç¦»çº¿å‚¨å­˜çš„çŠ¶æ€ã€‚</p><ul><li>ApplicationCache.UNCACHED (0) This application does not have a manifest attribute: it is not cached.</li><li>ApplicationCache.IDLE (1) The manifest has been checked and this application is cached and up to date.</li><li>ApplicationCache.CHECKING (2) The browser is checking the manifest file.</li><li>ApplicationCache.DOWNLOADING (3) The browser is downloading and caching files listed in the manifest.</li><li>ApplicationCache.UPDATEREADY (4) A new version of the application has been downloaded and cached.</li><li>ApplicationCache.OBSOLETE (5) The manifest no longer exists and the cache will be deleted.</li></ul><h2 id="page-lifecycle-api" tabindex="-1"><a class="header-anchor" href="#page-lifecycle-api" aria-hidden="true">#</a> Page Lifecycle API</h2><p>Androidã€iOS å’Œæœ€æ–°çš„ Windows ç³»ç»Ÿå¯ä»¥éšæ—¶è‡ªä¸»åœ°åœæ­¢åå°è¿›ç¨‹ï¼ŒåŠæ—¶é‡Šæ”¾ç³»ç»Ÿèµ„æºã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç½‘é¡µå¯èƒ½éšæ—¶è¢«ç³»ç»Ÿä¸¢å¼ƒæ‰ã€‚ä»¥å‰çš„æµè§ˆå™¨ API å®Œå…¨æ²¡æœ‰è€ƒè™‘åˆ°è¿™ç§æƒ…å†µï¼Œå¯¼è‡´å¼€å‘è€…æ ¹æœ¬æ²¡æœ‰åŠæ³•ç›‘å¬åˆ°ç³»ç»Ÿä¸¢å¼ƒé¡µé¢ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒW3C æ–°åˆ¶å®šäº†ä¸€ä¸ª Page Lifecycle APIï¼Œç»Ÿä¸€äº†ç½‘é¡µä»è¯ç”Ÿåˆ°å¸è½½çš„è¡Œä¸ºæ¨¡å¼ï¼Œå¹¶ä¸”å®šä¹‰äº†æ–°çš„äº‹ä»¶ï¼Œå…è®¸å¼€å‘è€…å“åº”ç½‘é¡µçŠ¶æ€çš„å„ç§è½¬æ¢ã€‚</p><p>æœ‰äº†è¿™ä¸ª APIï¼Œå¼€å‘è€…å°±å¯ä»¥é¢„æµ‹ç½‘é¡µä¸‹ä¸€æ­¥çš„çŠ¶æ€ï¼Œä»è€Œè¿›è¡Œå„ç§é’ˆå¯¹æ€§çš„å¤„ç†ã€‚Chrome 68 æ”¯æŒè¿™ä¸ª APIï¼Œå¯¹äºè€å¼æµè§ˆå™¨å¯ä»¥ä½¿ç”¨è°·æ­Œå¼€å‘çš„å…¼å®¹åº“ <a href="https://github.com/GoogleChromeLabs/page-lifecycle" target="_blank" rel="noopener noreferrer">PageLifecycle.js<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ã€‚</p><h3 id="ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ" tabindex="-1"><a class="header-anchor" href="#ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ" aria-hidden="true">#</a> ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ</h3><p>ç½‘é¡µçš„ç”Ÿå‘½å‘¨æœŸåˆ†æˆå…­ä¸ªé˜¶æ®µï¼Œæ¯ä¸ªæ—¶åˆ»åªå¯èƒ½å¤„äºå…¶ä¸­ä¸€ä¸ªé˜¶æ®µã€‚</p><p><img src="https://xiaou-1305448902.cos.ap-nanjing.myqcloud.com/img/202308071415532.png" alt="" loading="lazy"></p><p><strong>ï¼ˆ1ï¼‰Active é˜¶æ®µ</strong></p><p>åœ¨ Active é˜¶æ®µï¼Œç½‘é¡µå¤„äºå¯è§çŠ¶æ€ï¼Œä¸”æ‹¥æœ‰è¾“å…¥ç„¦ç‚¹ã€‚</p><p><strong>ï¼ˆ2ï¼‰Passive é˜¶æ®µ</strong></p><p>åœ¨ Passive é˜¶æ®µï¼Œç½‘é¡µå¯è§ï¼Œä½†æ²¡æœ‰è¾“å…¥ç„¦ç‚¹ï¼Œæ— æ³•æ¥å—è¾“å…¥ã€‚UI æ›´æ–°ï¼ˆæ¯”å¦‚åŠ¨ç”»ï¼‰ä»ç„¶åœ¨æ‰§è¡Œã€‚è¯¥é˜¶æ®µåªå¯èƒ½å‘ç”Ÿåœ¨æ¡Œé¢åŒæ—¶æœ‰å¤šä¸ªçª—å£çš„æƒ…å†µã€‚</p><p><strong>ï¼ˆ3ï¼‰Hidden é˜¶æ®µ</strong></p><p>åœ¨ Hidden é˜¶æ®µï¼Œç”¨æˆ·çš„æ¡Œé¢è¢«å…¶ä»–çª—å£å æ®ï¼Œç½‘é¡µä¸å¯è§ï¼Œä½†å°šæœªå†»ç»“ã€‚UI æ›´æ–°ä¸å†æ‰§è¡Œã€‚</p><p><strong>ï¼ˆ4ï¼‰Terminated é˜¶æ®µ</strong></p><p>åœ¨ Terminated é˜¶æ®µï¼Œç”±äºç”¨æˆ·ä¸»åŠ¨å…³é—­çª—å£ï¼Œæˆ–è€…åœ¨åŒä¸€ä¸ªçª—å£å‰å¾€å…¶ä»–é¡µé¢ï¼Œå¯¼è‡´å½“å‰é¡µé¢å¼€å§‹è¢«æµè§ˆå™¨å¸è½½å¹¶ä»å†…å­˜ä¸­æ¸…é™¤ã€‚æ³¨æ„ï¼Œè¿™ä¸ªé˜¶æ®µæ€»æ˜¯åœ¨ Hidden é˜¶æ®µä¹‹åå‘ç”Ÿï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç”¨æˆ·ä¸»åŠ¨ç¦»å¼€å½“å‰é¡µé¢ï¼Œæ€»æ˜¯å…ˆè¿›å…¥ Hidden é˜¶æ®µï¼Œå†è¿›å…¥ Terminated é˜¶æ®µã€‚</p><p>è¿™ä¸ªé˜¶æ®µä¼šå¯¼è‡´ç½‘é¡µå¸è½½ï¼Œä»»ä½•æ–°ä»»åŠ¡éƒ½ä¸ä¼šåœ¨è¿™ä¸ªé˜¶æ®µå¯åŠ¨ï¼Œå¹¶ä¸”å¦‚æœè¿è¡Œæ—¶é—´å¤ªé•¿ï¼Œæ­£åœ¨è¿›è¡Œçš„ä»»åŠ¡å¯èƒ½ä¼šè¢«ç»ˆæ­¢ã€‚</p><p><strong>ï¼ˆ5ï¼‰Frozen é˜¶æ®µ</strong></p><p>å¦‚æœç½‘é¡µå¤„äº Hidden é˜¶æ®µçš„æ—¶é—´è¿‡ä¹…ï¼Œç”¨æˆ·åˆä¸å…³é—­ç½‘é¡µï¼Œæµè§ˆå™¨å°±æœ‰å¯èƒ½å†»ç»“ç½‘é¡µï¼Œä½¿å…¶è¿›å…¥ Frozen é˜¶æ®µã€‚ä¸è¿‡ï¼Œä¹Ÿæœ‰å¯èƒ½ï¼Œå¤„äºå¯è§çŠ¶æ€çš„é¡µé¢é•¿æ—¶é—´æ²¡æœ‰æ“ä½œï¼Œä¹Ÿä¼šè¿›å…¥ Frozen é˜¶æ®µã€‚</p><p>è¿™ä¸ªé˜¶æ®µçš„ç‰¹å¾æ˜¯ï¼Œç½‘é¡µä¸ä¼šå†è¢«åˆ†é… CPU è®¡ç®—èµ„æºã€‚å®šæ—¶å™¨ã€å›è°ƒå‡½æ•°ã€ç½‘ç»œè¯·æ±‚ã€DOM æ“ä½œéƒ½ä¸ä¼šæ‰§è¡Œï¼Œä¸è¿‡æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡ä¼šæ‰§è¡Œå®Œã€‚æµè§ˆå™¨å¯èƒ½ä¼šå…è®¸ Frozen é˜¶æ®µçš„é¡µé¢ï¼Œå‘¨æœŸæ€§å¤è‹ä¸€å°æ®µæ—¶é—´ï¼ŒçŸ­æš‚å˜å› Hidden çŠ¶æ€ï¼Œå…è®¸ä¸€å°éƒ¨åˆ†ä»»åŠ¡æ‰§è¡Œã€‚</p><p><strong>ï¼ˆ6ï¼‰Discarded é˜¶æ®µ</strong></p><p>å¦‚æœç½‘é¡µé•¿æ—¶é—´å¤„äº Frozen é˜¶æ®µï¼Œç”¨æˆ·åˆä¸å”¤é†’é¡µé¢ï¼Œé‚£ä¹ˆå°±ä¼šè¿›å…¥ Discarded é˜¶æ®µï¼Œå³æµè§ˆå™¨è‡ªåŠ¨å¸è½½ç½‘é¡µï¼Œæ¸…é™¤è¯¥ç½‘é¡µçš„å†…å­˜å ç”¨ã€‚ä¸è¿‡ï¼ŒPassive é˜¶æ®µçš„ç½‘é¡µå¦‚æœé•¿æ—¶é—´æ²¡æœ‰äº’åŠ¨ï¼Œä¹Ÿå¯èƒ½ç›´æ¥è¿›å…¥ Discarded é˜¶æ®µã€‚</p><p>è¿™ä¸€èˆ¬æ˜¯åœ¨ç”¨æˆ·æ²¡æœ‰ä»‹å…¥çš„æƒ…å†µä¸‹ï¼Œç”±ç³»ç»Ÿå¼ºåˆ¶æ‰§è¡Œã€‚ä»»ä½•ç±»å‹çš„æ–°ä»»åŠ¡æˆ– JavaScript ä»£ç ï¼Œéƒ½ä¸èƒ½åœ¨æ­¤é˜¶æ®µæ‰§è¡Œï¼Œå› ä¸ºè¿™æ—¶é€šå¸¸å¤„åœ¨èµ„æºé™åˆ¶çš„çŠ¶å†µä¸‹ã€‚</p><p>ç½‘é¡µè¢«æµè§ˆå™¨è‡ªåŠ¨ Discarded ä»¥åï¼Œå®ƒçš„ Tab çª—å£è¿˜æ˜¯åœ¨çš„ã€‚å¦‚æœç”¨æˆ·é‡æ–°è®¿é—®è¿™ä¸ª Tab é¡µï¼Œæµè§ˆå™¨å°†ä¼šé‡æ–°å‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œå†ä¸€æ¬¡é‡æ–°åŠ è½½ç½‘é¡µï¼Œå›åˆ° Active é˜¶æ®µã€‚</p><h3 id="å¸¸è§åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#å¸¸è§åœºæ™¯" aria-hidden="true">#</a> å¸¸è§åœºæ™¯</h3><p>ä»¥ä¸‹æ˜¯å‡ ä¸ªå¸¸è§åœºæ™¯çš„ç½‘é¡µç”Ÿå‘½å‘¨æœŸå˜åŒ–ã€‚</p><p>ï¼ˆ1ï¼‰ç”¨æˆ·æ‰“å¼€ç½‘é¡µåï¼Œåˆåˆ‡æ¢åˆ°å…¶ä»– Appï¼Œä½†åªè¿‡äº†ä¸€ä¼šåˆå›åˆ°ç½‘é¡µã€‚</p><p>ç½‘é¡µç”± Active å˜æˆ Hiddenï¼Œåˆå˜å› Activeã€‚</p><p>ï¼ˆ2ï¼‰ç”¨æˆ·æ‰“å¼€ç½‘é¡µåï¼Œåˆåˆ‡æ¢åˆ°å…¶ä»– Appï¼Œå¹¶ä¸”é•¿æ—¶å€™ä½¿ç”¨åè€…ï¼Œå¯¼è‡´ç³»ç»Ÿè‡ªåŠ¨ä¸¢å¼ƒç½‘é¡µã€‚</p><p>ç½‘é¡µç”± Active å˜æˆ Hiddenï¼Œå†å˜æˆ Frozenï¼Œæœ€å Discardedã€‚</p><p>ï¼ˆ3ï¼‰ç”¨æˆ·æ‰“å¼€ç½‘é¡µåï¼Œåˆåˆ‡æ¢åˆ°å…¶ä»– Appï¼Œç„¶åä»ä»»åŠ¡ç®¡ç†å™¨é‡Œé¢å°†æµè§ˆå™¨è¿›ç¨‹æ¸…é™¤ã€‚</p><p>ç½‘é¡µç”± Active å˜æˆ Hiddenï¼Œç„¶å Terminatedã€‚</p><p>ï¼ˆ4ï¼‰ç³»ç»Ÿä¸¢å¼ƒäº†æŸä¸ª Tab é‡Œé¢çš„é¡µé¢åï¼Œç”¨æˆ·é‡æ–°æ‰“å¼€è¿™ä¸ª Tabã€‚</p><p>ç½‘é¡µç”± Discarded å˜æˆ Activeã€‚</p><h3 id="äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#äº‹ä»¶" aria-hidden="true">#</a> äº‹ä»¶</h3><p>ç”Ÿå‘½å‘¨æœŸçš„å„ä¸ªé˜¶æ®µéƒ½æœ‰è‡ªå·±çš„äº‹ä»¶ï¼Œä»¥ä¾›å¼€å‘è€…æŒ‡å®šç›‘å¬å‡½æ•°ã€‚è¿™äº›äº‹ä»¶é‡Œé¢ï¼Œåªæœ‰ä¸¤ä¸ªæ˜¯æ–°å®šä¹‰çš„ï¼ˆ<code>freeze</code>äº‹ä»¶å’Œ<code>resume</code>äº‹ä»¶ï¼‰ï¼Œå…¶å®ƒéƒ½æ˜¯ç°æœ‰çš„ã€‚</p><p>æ³¨æ„ï¼Œç½‘é¡µçš„ç”Ÿå‘½å‘¨æœŸäº‹ä»¶æ˜¯åœ¨æ‰€æœ‰å¸§ï¼ˆframeï¼‰è§¦å‘ï¼Œä¸ç®¡æ˜¯åº•å±‚çš„å¸§ï¼Œè¿˜æ˜¯å†…åµŒçš„å¸§ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå†…åµŒçš„<code>&lt;iframe&gt;</code>ç½‘é¡µè·Ÿé¡¶å±‚ç½‘é¡µä¸€æ ·ï¼Œéƒ½ä¼šåŒæ—¶ç›‘å¬åˆ°ä¸‹é¢çš„äº‹ä»¶ã€‚</p><h4 id="focus-äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#focus-äº‹ä»¶" aria-hidden="true">#</a> focus äº‹ä»¶</h4><p><code>focus</code>äº‹ä»¶åœ¨é¡µé¢è·å¾—è¾“å…¥ç„¦ç‚¹æ—¶è§¦å‘ï¼Œæ¯”å¦‚ç½‘é¡µä» Passive é˜¶æ®µå˜ä¸º Active é˜¶æ®µã€‚</p><h4 id="blur-äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#blur-äº‹ä»¶" aria-hidden="true">#</a> blur äº‹ä»¶</h4><p><code>blur</code>äº‹ä»¶åœ¨é¡µé¢å¤±å»è¾“å…¥ç„¦ç‚¹æ—¶è§¦å‘ï¼Œæ¯”å¦‚ç½‘é¡µä» Active é˜¶æ®µå˜ä¸º Passive é˜¶æ®µã€‚</p><h4 id="visibilitychange-äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#visibilitychange-äº‹ä»¶" aria-hidden="true">#</a> visibilitychange äº‹ä»¶</h4><p><code>visibilitychange</code>äº‹ä»¶åœ¨ç½‘é¡µå¯è§çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶è§¦å‘ï¼Œä¸€èˆ¬å‘ç”Ÿåœ¨ä»¥ä¸‹å‡ ç§åœºæ™¯ã€‚</p><blockquote><ul><li>ç”¨æˆ·éšè—é¡µé¢ï¼ˆåˆ‡æ¢ Tabã€æœ€å°åŒ–æµè§ˆå™¨ï¼‰ï¼Œé¡µé¢ç”± Active é˜¶æ®µå˜æˆ Hidden é˜¶æ®µã€‚</li><li>ç”¨æˆ·é‡æ–°è®¿é—®éšè—çš„é¡µé¢ï¼Œé¡µé¢ç”± Hidden é˜¶æ®µå˜æˆ Active é˜¶æ®µã€‚</li><li>ç”¨æˆ·å…³é—­é¡µé¢ï¼Œé¡µé¢ä¼šå…ˆè¿›å…¥ Hidden é˜¶æ®µï¼Œç„¶åè¿›å…¥ Terminated é˜¶æ®µã€‚</li></ul></blockquote><p>å¯ä»¥é€šè¿‡<code>document.onvisibilitychange</code>å±æ€§æŒ‡å®šè¿™ä¸ªäº‹ä»¶çš„å›è°ƒå‡½æ•°ã€‚</p><h4 id="freeze-äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#freeze-äº‹ä»¶" aria-hidden="true">#</a> freeze äº‹ä»¶</h4><p><code>freeze</code>äº‹ä»¶åœ¨ç½‘é¡µè¿›å…¥ Frozen é˜¶æ®µæ—¶è§¦å‘ã€‚</p><p>å¯ä»¥é€šè¿‡<code>document.onfreeze</code>å±æ€§æŒ‡å®šåœ¨è¿›å…¥ Frozen é˜¶æ®µæ—¶è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">handleFreeze</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Handle transition to FROZEN</span>
<span class="token punctuation">}</span>
document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;freeze&#39;</span><span class="token punctuation">,</span> handleFreeze<span class="token punctuation">)</span><span class="token punctuation">;</span>

## æˆ–è€…
document<span class="token punctuation">.</span><span class="token function-variable function">onfreeze</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> â€¦ <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªäº‹ä»¶çš„ç›‘å¬å‡½æ•°ï¼Œæœ€é•¿åªèƒ½è¿è¡Œ500æ¯«ç§’ã€‚å¹¶ä¸”åªèƒ½å¤ç”¨å·²ç»æ‰“å¼€çš„ç½‘ç»œè¿æ¥ï¼Œä¸èƒ½å‘èµ·æ–°çš„ç½‘ç»œè¯·æ±‚ã€‚</p><p>æ³¨æ„ï¼Œä» Frozen é˜¶æ®µè¿›å…¥ Discarded é˜¶æ®µï¼Œä¸ä¼šè§¦å‘ä»»ä½•äº‹ä»¶ï¼Œæ— æ³•æŒ‡å®šå›è°ƒå‡½æ•°ï¼Œåªèƒ½åœ¨è¿›å…¥ Frozen é˜¶æ®µæ—¶æŒ‡å®šå›è°ƒå‡½æ•°ã€‚</p><h4 id="resume-äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#resume-äº‹ä»¶" aria-hidden="true">#</a> resume äº‹ä»¶</h4><p><code>resume</code>äº‹ä»¶åœ¨ç½‘é¡µç¦»å¼€ Frozen é˜¶æ®µï¼Œå˜ä¸º Active / Passive / Hidden é˜¶æ®µæ—¶è§¦å‘ã€‚</p><p><code>document.onresume</code>å±æ€§æŒ‡çš„æ˜¯é¡µé¢ç¦»å¼€ Frozen é˜¶æ®µã€è¿›å…¥å¯ç”¨çŠ¶æ€æ—¶è°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">handleResume</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// handle state transition FROZEN -&gt; ACTIVE</span>
<span class="token punctuation">}</span>
document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;resume&quot;</span><span class="token punctuation">,</span> handleResume<span class="token punctuation">)</span><span class="token punctuation">;</span>

## æˆ–è€…
document<span class="token punctuation">.</span><span class="token function-variable function">onresume</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> â€¦ <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="pageshow-äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#pageshow-äº‹ä»¶" aria-hidden="true">#</a> pageshow äº‹ä»¶</h4><p><code>pageshow</code>äº‹ä»¶åœ¨ç”¨æˆ·åŠ è½½ç½‘é¡µæ—¶è§¦å‘ã€‚è¿™æ—¶ï¼Œæœ‰å¯èƒ½æ˜¯å…¨æ–°çš„é¡µé¢åŠ è½½ï¼Œä¹Ÿå¯èƒ½æ˜¯ä»ç¼“å­˜ä¸­è·å–çš„é¡µé¢ã€‚å¦‚æœæ˜¯ä»ç¼“å­˜ä¸­è·å–ï¼Œåˆ™è¯¥äº‹ä»¶å¯¹è±¡çš„<code>event.persisted</code>å±æ€§ä¸º<code>true</code>ï¼Œå¦åˆ™ä¸º<code>false</code>ã€‚</p><p>è¿™ä¸ªäº‹ä»¶çš„åå­—æœ‰ç‚¹è¯¯å¯¼ï¼Œå®ƒè·Ÿé¡µé¢çš„å¯è§æ€§å…¶å®æ¯«æ— å…³ç³»ï¼Œåªè·Ÿæµè§ˆå™¨çš„ History è®°å½•çš„å˜åŒ–æœ‰å…³ã€‚</p><h4 id="pagehide-äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#pagehide-äº‹ä»¶" aria-hidden="true">#</a> pagehide äº‹ä»¶</h4><p><code>pagehide</code>äº‹ä»¶åœ¨ç”¨æˆ·ç¦»å¼€å½“å‰ç½‘é¡µã€è¿›å…¥å¦ä¸€ä¸ªç½‘é¡µæ—¶è§¦å‘ã€‚å®ƒçš„å‰ææ˜¯æµè§ˆå™¨çš„ History è®°å½•å¿…é¡»å‘ç”Ÿå˜åŒ–ï¼Œè·Ÿç½‘é¡µæ˜¯å¦å¯è§æ— å…³ã€‚</p><p>å¦‚æœæµè§ˆå™¨èƒ½å¤Ÿå°†å½“å‰é¡µé¢æ·»åŠ åˆ°ç¼“å­˜ä»¥ä¾›ç¨åé‡ç”¨ï¼Œåˆ™äº‹ä»¶å¯¹è±¡çš„<code>event.persisted</code>å±æ€§ä¸º<code>true</code>ã€‚ å¦‚æœä¸º<code>true</code>ã€‚å¦‚æœé¡µé¢æ·»åŠ åˆ°äº†ç¼“å­˜ï¼Œåˆ™é¡µé¢è¿›å…¥ Frozen çŠ¶æ€ï¼Œå¦åˆ™è¿›å…¥ Terminatied çŠ¶æ€ã€‚</p><h4 id="beforeunload-äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#beforeunload-äº‹ä»¶" aria-hidden="true">#</a> beforeunload äº‹ä»¶</h4><p><code>beforeunload</code>äº‹ä»¶åœ¨çª—å£æˆ–æ–‡æ¡£å³å°†å¸è½½æ—¶è§¦å‘ã€‚è¯¥äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œæ–‡æ¡£ä»ç„¶å¯è§ï¼Œæ­¤æ—¶å¸è½½ä»å¯å–æ¶ˆã€‚ç»è¿‡è¿™ä¸ªäº‹ä»¶ï¼Œç½‘é¡µè¿›å…¥ Terminated çŠ¶æ€ã€‚</p><h4 id="unload-äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#unload-äº‹ä»¶" aria-hidden="true">#</a> unload äº‹ä»¶</h4><p><code>unload</code>äº‹ä»¶åœ¨é¡µé¢æ­£åœ¨å¸è½½æ—¶è§¦å‘ã€‚ç»è¿‡è¿™ä¸ªäº‹ä»¶ï¼Œç½‘é¡µè¿›å…¥ Terminated çŠ¶æ€ã€‚</p><h3 id="è·å–å½“å‰é˜¶æ®µ" tabindex="-1"><a class="header-anchor" href="#è·å–å½“å‰é˜¶æ®µ" aria-hidden="true">#</a> è·å–å½“å‰é˜¶æ®µ</h3><p>å¦‚æœç½‘é¡µå¤„äº Activeã€Passive æˆ– Hidden é˜¶æ®µï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„ä»£ç ï¼Œè·å¾—ç½‘é¡µå½“å‰çš„çŠ¶æ€ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">getState</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>visibilityState <span class="token operator">===</span> <span class="token string">&#39;hidden&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&#39;hidden&#39;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">hasFocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&#39;active&#39;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token string">&#39;passive&#39;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœç½‘é¡µå¤„äº Frozen å’Œ Terminated çŠ¶æ€ï¼Œç”±äºå®šæ—¶å™¨ä»£ç ä¸ä¼šæ‰§è¡Œï¼Œåªèƒ½é€šè¿‡äº‹ä»¶ç›‘å¬åˆ¤æ–­çŠ¶æ€ã€‚è¿›å…¥ Frozen é˜¶æ®µï¼Œå¯ä»¥ç›‘å¬<code>freeze</code>äº‹ä»¶ï¼›è¿›å…¥ Terminated é˜¶æ®µï¼Œå¯ä»¥ç›‘å¬<code>pagehide</code>äº‹ä»¶ã€‚</p><h3 id="document-wasdiscarded" tabindex="-1"><a class="header-anchor" href="#document-wasdiscarded" aria-hidden="true">#</a> document.wasDiscarded</h3><p>å¦‚æœæŸä¸ªé€‰é¡¹å¡å¤„äº Frozen é˜¶æ®µï¼Œå°±éšæ—¶æœ‰å¯èƒ½è¢«ç³»ç»Ÿä¸¢å¼ƒï¼Œè¿›å…¥ Discarded é˜¶æ®µã€‚å¦‚æœåæ¥ç”¨æˆ·å†æ¬¡ç‚¹å‡»è¯¥é€‰é¡¹å¡ï¼Œæµè§ˆå™¨ä¼šé‡æ–°åŠ è½½è¯¥é¡µé¢ã€‚</p><p>è¿™æ—¶ï¼Œå¼€å‘è€…å¯ä»¥é€šè¿‡åˆ¤æ–­<code>document.wasDiscarded</code>å±æ€§ï¼Œäº†è§£å…ˆå‰çš„ç½‘é¡µæ˜¯å¦è¢«ä¸¢å¼ƒäº†ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>wasDiscarded<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è¯¥ç½‘é¡µå·²ç»ä¸æ˜¯åŸæ¥çš„çŠ¶æ€äº†ï¼Œæ›¾ç»è¢«æµè§ˆå™¨ä¸¢å¼ƒè¿‡</span>
    <span class="token comment">// æ¢å¤ä»¥å‰çš„çŠ¶æ€</span>
    <span class="token function">getPersistedState</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>discardedClientId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åŒæ—¶ï¼Œ<code>window</code>å¯¹è±¡ä¸Šä¼šæ–°å¢<code>window.clientId</code>å’Œ<code>window.discardedClientId</code>ä¸¤ä¸ªå±æ€§ï¼Œç”¨æ¥æ¢å¤ä¸¢å¼ƒå‰çš„çŠ¶æ€ã€‚</p><h3 id="å‚è€ƒé“¾æ¥-6" tabindex="-1"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥-6" aria-hidden="true">#</a> å‚è€ƒé“¾æ¥</h3><ul><li><a href="https://developers.google.com/web/updates/2018/07/page-lifecycle-api" target="_blank" rel="noopener noreferrer">Page Lifecycle API<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, Philip Walton</li><li><a href="https://github.com/WICG/page-lifecycle" target="_blank" rel="noopener noreferrer">Lifecycle API for Web Pages<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, W3C</li><li><a href="https://wicg.github.io/page-lifecycle/spec.html" target="_blank" rel="noopener noreferrer">Page Lifecycle 1 Editorâ€™s Draft<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, W3C</li></ul><h2 id="page-visibility-api" tabindex="-1"><a class="header-anchor" href="#page-visibility-api" aria-hidden="true">#</a> Page Visibility API</h2><h3 id="ç®€ä»‹-2" tabindex="-1"><a class="header-anchor" href="#ç®€ä»‹-2" aria-hidden="true">#</a> ç®€ä»‹</h3><p>æœ‰æ—¶å€™ï¼Œå¼€å‘è€…éœ€è¦çŸ¥é“ï¼Œç”¨æˆ·æ­£åœ¨ç¦»å¼€é¡µé¢ã€‚å¸¸ç”¨çš„æ–¹æ³•æ˜¯ç›‘å¬ä¸‹é¢ä¸‰ä¸ªäº‹ä»¶ã€‚</p><blockquote><ul><li><code>pagehide</code></li><li><code>beforeunload</code></li><li><code>unload</code></li></ul></blockquote><p>ä½†æ˜¯ï¼Œè¿™äº›äº‹ä»¶åœ¨æ‰‹æœºä¸Šå¯èƒ½ä¸ä¼šè§¦å‘ï¼Œé¡µé¢å°±ç›´æ¥å…³é—­äº†ã€‚å› ä¸ºæ‰‹æœºç³»ç»Ÿå¯ä»¥å°†ä¸€ä¸ªè¿›ç¨‹ç›´æ¥è½¬å…¥åå°ï¼Œç„¶åæ€æ­»ã€‚</p><blockquote><ul><li>ç”¨æˆ·ç‚¹å‡»äº†ä¸€æ¡ç³»ç»Ÿé€šçŸ¥ï¼Œåˆ‡æ¢åˆ°å¦ä¸€ä¸ª Appã€‚</li><li>ç”¨æˆ·è¿›å…¥ä»»åŠ¡åˆ‡æ¢çª—å£ï¼Œåˆ‡æ¢åˆ°å¦ä¸€ä¸ª Appã€‚</li><li>ç”¨æˆ·ç‚¹å‡»äº† Home æŒ‰é’®ï¼Œåˆ‡æ¢å›ä¸»å±å¹•ã€‚</li><li>æ“ä½œç³»ç»Ÿè‡ªåŠ¨åˆ‡æ¢åˆ°å¦ä¸€ä¸ª Appï¼ˆæ¯”å¦‚ï¼Œæ”¶åˆ°ä¸€ä¸ªç”µè¯ï¼‰ã€‚</li></ul></blockquote><p>ä¸Šé¢è¿™äº›æƒ…å†µï¼Œéƒ½ä¼šå¯¼è‡´æ‰‹æœºå°†æµè§ˆå™¨è¿›ç¨‹åˆ‡æ¢åˆ°åå°ï¼Œç„¶åä¸ºäº†èŠ‚çœèµ„æºï¼Œå¯èƒ½å°±ä¼šæ€æ­»æµè§ˆå™¨è¿›ç¨‹ã€‚</p><p>ä»¥å‰ï¼Œé¡µé¢è¢«ç³»ç»Ÿåˆ‡æ¢ï¼Œä»¥åŠç³»ç»Ÿæ¸…é™¤æµè§ˆå™¨è¿›ç¨‹ï¼Œæ˜¯æ— æ³•ç›‘å¬åˆ°çš„ã€‚å¼€å‘è€…æƒ³è¦æŒ‡å®šï¼Œä»»ä½•ä¸€ç§é¡µé¢å¸è½½æƒ…å†µä¸‹éƒ½ä¼šæ‰§è¡Œçš„ä»£ç ï¼Œä¹Ÿæ˜¯æ— æ³•åšåˆ°çš„ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°±è¯ç”Ÿäº† Page Visibility APIã€‚ä¸ç®¡æ‰‹æœºæˆ–æ¡Œé¢ç”µè„‘ï¼Œæ‰€æœ‰æƒ…å†µä¸‹ï¼Œè¿™ä¸ª API éƒ½ä¼šç›‘å¬åˆ°é¡µé¢çš„å¯è§æ€§å‘ç”Ÿå˜åŒ–ã€‚</p><p>è¿™ä¸ªæ–°çš„ API çš„æ„ä¹‰åœ¨äºï¼Œé€šè¿‡ç›‘å¬ç½‘é¡µçš„å¯è§æ€§ï¼Œå¯ä»¥é¢„åˆ¤ç½‘é¡µçš„å¸è½½ï¼Œè¿˜å¯ä»¥ç”¨æ¥èŠ‚çœèµ„æºï¼Œå‡ç¼“ç”µèƒ½çš„æ¶ˆè€—ã€‚æ¯”å¦‚ï¼Œä¸€æ—¦ç”¨æˆ·ä¸çœ‹ç½‘é¡µï¼Œä¸‹é¢è¿™äº›ç½‘é¡µè¡Œä¸ºéƒ½æ˜¯å¯ä»¥æš‚åœçš„ã€‚</p><blockquote><ul><li>å¯¹æœåŠ¡å™¨çš„è½®è¯¢</li><li>ç½‘é¡µåŠ¨ç”»</li><li>æ­£åœ¨æ’­æ”¾çš„éŸ³é¢‘æˆ–è§†é¢‘</li></ul></blockquote><h3 id="document-visibilitystate" tabindex="-1"><a class="header-anchor" href="#document-visibilitystate" aria-hidden="true">#</a> document.visibilityState</h3><p>è¿™ä¸ª API ä¸»è¦åœ¨<code>document</code>å¯¹è±¡ä¸Šï¼Œæ–°å¢äº†ä¸€ä¸ª<code>document.visibilityState</code>å±æ€§ã€‚è¯¥å±æ€§è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºé¡µé¢å½“å‰çš„å¯è§æ€§çŠ¶æ€ï¼Œå…±æœ‰ä¸‰ä¸ªå¯èƒ½çš„å€¼ã€‚</p><blockquote><ul><li><code>hidden</code>ï¼šé¡µé¢å½»åº•ä¸å¯è§ã€‚</li><li><code>visible</code>ï¼šé¡µé¢è‡³å°‘ä¸€éƒ¨åˆ†å¯è§ã€‚</li><li><code>prerender</code>ï¼šé¡µé¢å³å°†æˆ–æ­£åœ¨æ¸²æŸ“ï¼Œå¤„äºä¸å¯è§çŠ¶æ€ã€‚</li></ul></blockquote><p>å…¶ä¸­ï¼Œ<code>hidden</code>çŠ¶æ€å’Œ<code>visible</code>çŠ¶æ€æ˜¯æ‰€æœ‰æµè§ˆå™¨éƒ½å¿…é¡»æ”¯æŒçš„ã€‚<code>prerender</code>çŠ¶æ€åªåœ¨æ”¯æŒâ€œé¢„æ¸²æŸ“â€çš„æµè§ˆå™¨ä¸Šæ‰ä¼šå‡ºç°ï¼Œæ¯”å¦‚ Chrome æµè§ˆå™¨å°±æœ‰é¢„æ¸²æŸ“åŠŸèƒ½ï¼Œå¯ä»¥åœ¨ç”¨æˆ·ä¸å¯è§çš„çŠ¶æ€ä¸‹ï¼Œé¢„å…ˆæŠŠé¡µé¢æ¸²æŸ“å‡ºæ¥ï¼Œç­‰åˆ°ç”¨æˆ·è¦æµè§ˆçš„æ—¶å€™ï¼Œç›´æ¥å±•ç¤ºæ¸²æŸ“å¥½çš„ç½‘é¡µã€‚</p><p>åªè¦é¡µé¢å¯è§ï¼Œå“ªæ€•åªéœ²å‡ºä¸€ä¸ªè§’ï¼Œ<code>document.visibilityState</code>å±æ€§å°±è¿”å›<code>visible</code>ã€‚åªæœ‰ä»¥ä¸‹å››ç§æƒ…å†µï¼Œæ‰ä¼šè¿”å›<code>hidden</code>ã€‚</p><blockquote><ul><li>æµè§ˆå™¨æœ€å°åŒ–ã€‚</li><li>æµè§ˆå™¨æ²¡æœ‰æœ€å°åŒ–ï¼Œä½†æ˜¯å½“å‰é¡µé¢åˆ‡æ¢æˆäº†èƒŒæ™¯é¡µã€‚</li><li>æµè§ˆå™¨å°†è¦å¸è½½ï¼ˆunloadï¼‰é¡µé¢ã€‚</li><li>æ“ä½œç³»ç»Ÿè§¦å‘é”å±å±å¹•ã€‚</li></ul></blockquote><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸Šé¢å››ç§åœºæ™¯æ¶µç›–äº†é¡µé¢å¯èƒ½è¢«å¸è½½çš„æ‰€æœ‰æƒ…å†µã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé¡µé¢å¸è½½ä¹‹å‰ï¼Œ<code>document.visibilityState</code>å±æ€§ä¸€å®šä¼šå˜æˆ<code>hidden</code>ã€‚äº‹å®ä¸Šï¼Œè¿™ä¹Ÿæ˜¯è®¾è®¡è¿™ä¸ª API çš„ä¸»è¦ç›®çš„ã€‚</p><p>å¦å¤–ï¼Œæ—©æœŸç‰ˆæœ¬çš„ APIï¼Œè¿™ä¸ªå±æ€§è¿˜æœ‰ç¬¬å››ä¸ªå€¼<code>unloaded</code>ï¼Œè¡¨ç¤ºé¡µé¢å³å°†å¸è½½ï¼Œç°åœ¨å·²ç»è¢«åºŸå¼ƒäº†ã€‚</p><p>æ³¨æ„ï¼Œ<code>document.visibilityState</code>å±æ€§åªé’ˆå¯¹é¡¶å±‚çª—å£ï¼Œå†…åµŒçš„<code>&lt;iframe&gt;</code>é¡µé¢çš„<code>document.visibilityState</code>å±æ€§ç”±é¡¶å±‚çª—å£å†³å®šã€‚ä½¿ç”¨ CSS å±æ€§éšè—<code>&lt;iframe&gt;</code>é¡µé¢ï¼ˆæ¯”å¦‚<code>display: none;</code>ï¼‰ï¼Œå¹¶ä¸ä¼šå½±å“å†…åµŒé¡µé¢çš„å¯è§æ€§ã€‚</p><h3 id="document-hidden" tabindex="-1"><a class="header-anchor" href="#document-hidden" aria-hidden="true">#</a> document.hidden</h3><p>ç”±äºå†å²åŸå› ï¼Œè¿™ä¸ª API è¿˜å®šä¹‰äº†<code>document.hidden</code>å±æ€§ã€‚è¯¥å±æ€§åªè¯»ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå½“å‰é¡µé¢æ˜¯å¦å¯è§ã€‚</p><p>å½“<code>document.visibilityState</code>å±æ€§è¿”å›<code>visible</code>æ—¶ï¼Œ<code>document.hidden</code>å±æ€§è¿”å›<code>false</code>ï¼›å…¶ä»–æƒ…å†µä¸‹ï¼Œéƒ½è¿”å›<code>true</code>ã€‚</p><p>è¯¥å±æ€§åªæ˜¯å‡ºäºå†å²åŸå› è€Œä¿ç•™çš„ï¼Œåªè¦æœ‰å¯èƒ½ï¼Œéƒ½åº”è¯¥ä½¿ç”¨<code>document.visibilityState</code>å±æ€§ï¼Œè€Œä¸æ˜¯ä½¿ç”¨è¿™ä¸ªå±æ€§ã€‚</p><h3 id="visibilitychange-äº‹ä»¶-1" tabindex="-1"><a class="header-anchor" href="#visibilitychange-äº‹ä»¶-1" aria-hidden="true">#</a> visibilitychange äº‹ä»¶</h3><p>åªè¦<code>document.visibilityState</code>å±æ€§å‘ç”Ÿå˜åŒ–ï¼Œå°±ä¼šè§¦å‘<code>visibilitychange</code>äº‹ä»¶ã€‚å› æ­¤ï¼Œå¯ä»¥é€šè¿‡ç›‘å¬è¿™ä¸ªäº‹ä»¶ï¼ˆé€šè¿‡<code>document.addEventListener()</code>æ–¹æ³•æˆ–<code>document.onvisibilitychange</code>å±æ€§ï¼‰ï¼Œè·Ÿè¸ªé¡µé¢å¯è§æ€§çš„å˜åŒ–ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;visibilitychange&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ç”¨æˆ·ç¦»å¼€äº†å½“å‰é¡µé¢</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>visibilityState <span class="token operator">===</span> <span class="token string">&#39;hidden&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        document<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">&#39;é¡µé¢ä¸å¯è§&#39;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ç”¨æˆ·æ‰“å¼€æˆ–å›åˆ°é¡µé¢</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>visibilityState <span class="token operator">===</span> <span class="token string">&#39;visible&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        document<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">&#39;é¡µé¢å¯è§&#39;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç æ˜¯ Page Visibility API çš„æœ€åŸºæœ¬ç”¨æ³•ï¼Œå¯ä»¥ç›‘å¬å¯è§æ€§å˜åŒ–ã€‚</p><p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ï¼Œä¸€æ—¦é¡µé¢ä¸å¯è§ï¼Œå°±æš‚åœè§†é¢‘æ’­æ”¾ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> vidElem <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;video-demo&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;visibilitychange&#39;</span><span class="token punctuation">,</span> startStopVideo<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">startStopVideo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>visibilityState <span class="token operator">===</span> <span class="token string">&#39;hidden&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        vidElem<span class="token punctuation">.</span><span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>visibilityState <span class="token operator">===</span> <span class="token string">&#39;visible&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        vidElem<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="é¡µé¢å¸è½½" tabindex="-1"><a class="header-anchor" href="#é¡µé¢å¸è½½" aria-hidden="true">#</a> é¡µé¢å¸è½½</h3><p>ä¸‹é¢ä¸“é—¨è®¨è®ºä¸€ä¸‹ï¼Œå¦‚ä½•æ­£ç¡®ç›‘å¬é¡µé¢å¸è½½ã€‚</p><p>é¡µé¢å¸è½½å¯ä»¥åˆ†æˆä¸‰ç§æƒ…å†µã€‚</p><blockquote><ul><li>é¡µé¢å¯è§æ—¶ï¼Œç”¨æˆ·å…³é—­ Tab é¡µæˆ–æµè§ˆå™¨çª—å£ã€‚</li><li>é¡µé¢å¯è§æ—¶ï¼Œç”¨æˆ·åœ¨å½“å‰çª—å£å‰å¾€å¦ä¸€ä¸ªé¡µé¢ã€‚</li><li>é¡µé¢ä¸å¯è§æ—¶ï¼Œç”¨æˆ·æˆ–ç³»ç»Ÿå…³é—­æµè§ˆå™¨çª—å£ã€‚</li></ul></blockquote><p>è¿™ä¸‰ç§æƒ…å†µï¼Œéƒ½ä¼šè§¦å‘<code>visibilitychange</code>äº‹ä»¶ã€‚å‰ä¸¤ç§æƒ…å†µï¼Œè¯¥äº‹ä»¶åœ¨ç”¨æˆ·ç¦»å¼€é¡µé¢æ—¶è§¦å‘ï¼›æœ€åä¸€ç§æƒ…å†µï¼Œè¯¥äº‹ä»¶åœ¨é¡µé¢ä»å¯è§çŠ¶æ€å˜ä¸ºä¸å¯è§çŠ¶æ€æ—¶è§¦å‘ã€‚</p><p>ç”±æ­¤å¯è§ï¼Œ<code>visibilitychange</code>äº‹ä»¶æ¯”<code>pagehide</code>ã€<code>beforeunload</code>ã€<code>unload</code>äº‹ä»¶æ›´å¯é ï¼Œæ‰€æœ‰æƒ…å†µä¸‹éƒ½ä¼šè§¦å‘ï¼ˆä»<code>visible</code>å˜ä¸º<code>hidden</code>ï¼‰ã€‚å› æ­¤ï¼Œå¯ä»¥åªç›‘å¬è¿™ä¸ªäº‹ä»¶ï¼Œè¿è¡Œé¡µé¢å¸è½½æ—¶éœ€è¦è¿è¡Œçš„ä»£ç ï¼Œä¸ç”¨ç›‘å¬åé¢é‚£ä¸‰ä¸ªäº‹ä»¶ã€‚</p><p>ç”šè‡³å¯ä»¥è¿™æ ·è¯´ï¼Œ<code>unload</code>äº‹ä»¶åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½ä¸å¿…ç›‘å¬ï¼Œ<code>beforeunload</code>äº‹ä»¶åªæœ‰ä¸€ç§é€‚ç”¨åœºæ™¯ï¼Œå°±æ˜¯ç”¨æˆ·ä¿®æ”¹äº†è¡¨å•ï¼Œæ²¡æœ‰æäº¤å°±ç¦»å¼€å½“å‰é¡µé¢ã€‚å¦ä¸€æ–¹é¢ï¼ŒæŒ‡å®šäº†è¿™ä¸¤ä¸ªäº‹ä»¶çš„ç›‘å¬å‡½æ•°ï¼Œæµè§ˆå™¨å°±ä¸ä¼šç¼“å­˜å½“å‰é¡µé¢ã€‚</p><h3 id="å‚è€ƒé“¾æ¥-7" tabindex="-1"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥-7" aria-hidden="true">#</a> å‚è€ƒé“¾æ¥</h3><ul><li><a href="https://w3c.github.io/page-visibility/" target="_blank" rel="noopener noreferrer">Page Visibility Level 2<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, W3C</li><li><a href="http://davidwalsh.name/page-visibility" target="_blank" rel="noopener noreferrer">Page Visibility API<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, David Walsh</li><li><a href="http://www.html5rocks.com/en/tutorials/pagevisibility/intro/" target="_blank" rel="noopener noreferrer">Using the pageVisbility API<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, Joe Marini</li><li><a href="http://blogs.msdn.com/b/ie/archive/2011/07/08/using-pc-hardware-more-efficiently-in-html5-new-web-performance-apis-part-2.aspx" target="_blank" rel="noopener noreferrer">Using PC Hardware more efficiently in HTML5: New Web Performance APIs, Part 2<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, Jatinder Mann</li><li><a href="https://www.igvita.com/2015/11/20/dont-lose-user-and-app-state-use-page-visibility/" target="_blank" rel="noopener noreferrer">Don&#39;t lose user and app state, use Page Visibility<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, Ilya Grigorik</li></ul><h2 id="point-lock-api" tabindex="-1"><a class="header-anchor" href="#point-lock-api" aria-hidden="true">#</a> Point lock API</h2><p>ä¸ç”¨é‡Šæ”¾æŒ‰é’®ï¼Œå°±é”å®šé¼ æ ‡ã€‚</p><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Pointer_Lock_API" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/en-US/docs/Web/API/Pointer_Lock_API<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="server-sent-events" tabindex="-1"><a class="header-anchor" href="#server-sent-events" aria-hidden="true">#</a> Server-Sent Events</h2><h3 id="ç®€ä»‹-3" tabindex="-1"><a class="header-anchor" href="#ç®€ä»‹-3" aria-hidden="true">#</a> ç®€ä»‹</h3><p>æœåŠ¡å™¨å‘å®¢æˆ·ç«¯æ¨é€æ•°æ®ï¼Œæœ‰å¾ˆå¤šè§£å†³æ–¹æ¡ˆã€‚é™¤äº†â€œè½®è¯¢â€ å’Œ WebSocketï¼ŒHTML 5 è¿˜æä¾›äº† Server-Sent Eventsï¼ˆä»¥ä¸‹ç®€ç§° SSEï¼‰ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼ŒHTTP åè®®åªèƒ½å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼ŒæœåŠ¡å™¨ä¸èƒ½ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€ã€‚ä½†æ˜¯æœ‰ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œå°±æ˜¯æœåŠ¡å™¨å‘å®¢æˆ·ç«¯å£°æ˜ï¼Œæ¥ä¸‹æ¥è¦å‘é€çš„æ˜¯æµä¿¡æ¯ï¼ˆstreamingï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå‘é€çš„ä¸æ˜¯ä¸€æ¬¡æ€§çš„æ•°æ®åŒ…ï¼Œè€Œæ˜¯ä¸€ä¸ªæ•°æ®æµï¼Œä¼šè¿ç»­ä¸æ–­åœ°å‘é€è¿‡æ¥ã€‚è¿™æ—¶ï¼Œå®¢æˆ·ç«¯ä¸ä¼šå…³é—­è¿æ¥ï¼Œä¼šä¸€ç›´ç­‰ç€æœåŠ¡å™¨å‘è¿‡æ¥çš„æ–°çš„æ•°æ®æµã€‚æœ¬è´¨ä¸Šï¼Œè¿™ç§é€šä¿¡å°±æ˜¯ä»¥æµä¿¡æ¯çš„æ–¹å¼ï¼Œå®Œæˆä¸€æ¬¡ç”¨æ—¶å¾ˆé•¿çš„ä¸‹è½½ã€‚</p><p>SSE å°±æ˜¯åˆ©ç”¨è¿™ç§æœºåˆ¶ï¼Œä½¿ç”¨æµä¿¡æ¯å‘æµè§ˆå™¨æ¨é€ä¿¡æ¯ã€‚å®ƒåŸºäº HTTP åè®®ï¼Œç›®å‰é™¤äº† IE/Edgeï¼Œå…¶ä»–æµè§ˆå™¨éƒ½æ”¯æŒã€‚</p><h3 id="ä¸-websocket-çš„æ¯”è¾ƒ" tabindex="-1"><a class="header-anchor" href="#ä¸-websocket-çš„æ¯”è¾ƒ" aria-hidden="true">#</a> ä¸ WebSocket çš„æ¯”è¾ƒ</h3><p>SSE ä¸ WebSocket ä½œç”¨ç›¸ä¼¼ï¼Œéƒ½æ˜¯å»ºç«‹æµè§ˆå™¨ä¸æœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡æ¸ é“ï¼Œç„¶åæœåŠ¡å™¨å‘æµè§ˆå™¨æ¨é€ä¿¡æ¯ã€‚</p><p>æ€»ä½“æ¥è¯´ï¼ŒWebSocket æ›´å¼ºå¤§å’Œçµæ´»ã€‚å› ä¸ºå®ƒæ˜¯å…¨åŒå·¥é€šé“ï¼Œå¯ä»¥åŒå‘é€šä¿¡ï¼›SSE æ˜¯å•å‘é€šé“ï¼Œåªèƒ½æœåŠ¡å™¨å‘æµè§ˆå™¨å‘é€ï¼Œå› ä¸º streaming æœ¬è´¨ä¸Šå°±æ˜¯ä¸‹è½½ã€‚å¦‚æœæµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€ä¿¡æ¯ï¼Œå°±å˜æˆäº†å¦ä¸€æ¬¡ HTTP è¯·æ±‚ã€‚</p><p>ä½†æ˜¯ï¼ŒSSE ä¹Ÿæœ‰è‡ªå·±çš„ä¼˜ç‚¹ã€‚</p><ul><li>SSE ä½¿ç”¨ HTTP åè®®ï¼Œç°æœ‰çš„æœåŠ¡å™¨è½¯ä»¶éƒ½æ”¯æŒã€‚WebSocket æ˜¯ä¸€ä¸ªç‹¬ç«‹åè®®ã€‚</li><li>SSE å±äºè½»é‡çº§ï¼Œä½¿ç”¨ç®€å•ï¼›WebSocket åè®®ç›¸å¯¹å¤æ‚ã€‚</li><li>SSE é»˜è®¤æ”¯æŒæ–­çº¿é‡è¿ï¼ŒWebSocket éœ€è¦è‡ªå·±å®ç°æ–­çº¿é‡è¿ã€‚</li><li>SSE ä¸€èˆ¬åªç”¨æ¥ä¼ é€æ–‡æœ¬ï¼ŒäºŒè¿›åˆ¶æ•°æ®éœ€è¦ç¼–ç åä¼ é€ï¼ŒWebSocket é»˜è®¤æ”¯æŒä¼ é€äºŒè¿›åˆ¶æ•°æ®ã€‚</li><li>SSE æ”¯æŒè‡ªå®šä¹‰å‘é€çš„æ¶ˆæ¯ç±»å‹ã€‚</li></ul><p>å› æ­¤ï¼Œä¸¤è€…å„æœ‰ç‰¹ç‚¹ï¼Œé€‚åˆä¸åŒçš„åœºåˆã€‚</p><h3 id="å®¢æˆ·ç«¯-api" tabindex="-1"><a class="header-anchor" href="#å®¢æˆ·ç«¯-api" aria-hidden="true">#</a> å®¢æˆ·ç«¯ API</h3><h4 id="eventsource-å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#eventsource-å¯¹è±¡" aria-hidden="true">#</a> EventSource å¯¹è±¡</h4><p>SSE çš„å®¢æˆ·ç«¯ API éƒ¨ç½²åœ¨<code>EventSource</code>å¯¹è±¡ä¸Šã€‚ä¸‹é¢çš„ä»£ç å¯ä»¥æ£€æµ‹æµè§ˆå™¨æ˜¯å¦æ”¯æŒ SSEã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&#39;EventSource&#39;</span> <span class="token keyword">in</span> window<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨ SSE æ—¶ï¼Œæµè§ˆå™¨é¦–å…ˆç”Ÿæˆä¸€ä¸ª<code>EventSource</code>å®ä¾‹ï¼Œå‘æœåŠ¡å™¨å‘èµ·è¿æ¥ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> source <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventSource</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä¸Šé¢çš„<code>url</code>å¯ä»¥ä¸å½“å‰ç½‘å€åŒåŸŸï¼Œä¹Ÿå¯ä»¥è·¨åŸŸã€‚è·¨åŸŸæ—¶ï¼Œå¯ä»¥æŒ‡å®šç¬¬äºŒä¸ªå‚æ•°ï¼Œæ‰“å¼€<code>withCredentials</code>å±æ€§ï¼Œè¡¨ç¤ºæ˜¯å¦ä¸€èµ·å‘é€ Cookieã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> source <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventSource</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">withCredentials</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="readystate-å±æ€§" tabindex="-1"><a class="header-anchor" href="#readystate-å±æ€§" aria-hidden="true">#</a> readyState å±æ€§</h4><p><code>EventSource</code>å®ä¾‹çš„<code>readyState</code>å±æ€§ï¼Œè¡¨æ˜è¿æ¥çš„å½“å‰çŠ¶æ€ã€‚è¯¥å±æ€§åªè¯»ï¼Œå¯ä»¥å–ä»¥ä¸‹å€¼ã€‚</p><ul><li>0ï¼šç›¸å½“äºå¸¸é‡<code>EventSource.CONNECTING</code>ï¼Œè¡¨ç¤ºè¿æ¥è¿˜æœªå»ºç«‹ï¼Œæˆ–è€…æ–­çº¿æ­£åœ¨é‡è¿ã€‚</li><li>1ï¼šç›¸å½“äºå¸¸é‡<code>EventSource.OPEN</code>ï¼Œè¡¨ç¤ºè¿æ¥å·²ç»å»ºç«‹ï¼Œå¯ä»¥æ¥å—æ•°æ®ã€‚</li><li>2ï¼šç›¸å½“äºå¸¸é‡<code>EventSource.CLOSED</code>ï¼Œè¡¨ç¤ºè¿æ¥å·²æ–­ï¼Œä¸”ä¸ä¼šé‡è¿ã€‚</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> source <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventSource</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>source<span class="token punctuation">.</span>readyState<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="url-å±æ€§" tabindex="-1"><a class="header-anchor" href="#url-å±æ€§" aria-hidden="true">#</a> url å±æ€§</h4><p><code>EventSource</code>å®ä¾‹çš„<code>url</code>å±æ€§è¿”å›è¿æ¥çš„ç½‘å€ï¼Œè¯¥å±æ€§åªè¯»ã€‚</p><h4 id="withcredentials-å±æ€§" tabindex="-1"><a class="header-anchor" href="#withcredentials-å±æ€§" aria-hidden="true">#</a> withCredentials å±æ€§</h4><p><code>EventSource</code>å®ä¾‹çš„<code>withCredentials</code>å±æ€§è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå½“å‰å®ä¾‹æ˜¯å¦å¼€å¯ CORS çš„<code>withCredentials</code>ã€‚è¯¥å±æ€§åªè¯»ï¼Œé»˜è®¤æ˜¯<code>false</code>ã€‚</p><h4 id="onopen-å±æ€§" tabindex="-1"><a class="header-anchor" href="#onopen-å±æ€§" aria-hidden="true">#</a> onopen å±æ€§</h4><p>è¿æ¥ä¸€æ—¦å»ºç«‹ï¼Œå°±ä¼šè§¦å‘<code>open</code>äº‹ä»¶ï¼Œå¯ä»¥åœ¨<code>onopen</code>å±æ€§å®šä¹‰å›è°ƒå‡½æ•°ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>source<span class="token punctuation">.</span><span class="token function-variable function">onopen</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// å¦ä¸€ç§å†™æ³•</span>
source<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;open&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="onmessage-å±æ€§" tabindex="-1"><a class="header-anchor" href="#onmessage-å±æ€§" aria-hidden="true">#</a> onmessage å±æ€§</h4><p>å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨å‘æ¥çš„æ•°æ®ï¼Œå°±ä¼šè§¦å‘<code>message</code>äº‹ä»¶ï¼Œå¯ä»¥åœ¨<code>onmessage</code>å±æ€§å®šä¹‰å›è°ƒå‡½æ•°ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>source<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> data <span class="token operator">=</span> event<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
    <span class="token keyword">var</span> origin <span class="token operator">=</span> event<span class="token punctuation">.</span>origin<span class="token punctuation">;</span>
    <span class="token keyword">var</span> lastEventId <span class="token operator">=</span> event<span class="token punctuation">.</span>lastEventId<span class="token punctuation">;</span>
    <span class="token comment">// handle message</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// å¦ä¸€ç§å†™æ³•</span>
source<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;message&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> data <span class="token operator">=</span> event<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
    <span class="token keyword">var</span> origin <span class="token operator">=</span> event<span class="token punctuation">.</span>origin<span class="token punctuation">;</span>
    <span class="token keyword">var</span> lastEventId <span class="token operator">=</span> event<span class="token punctuation">.</span>lastEventId<span class="token punctuation">;</span>
    <span class="token comment">// handle message</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‚æ•°å¯¹è±¡<code>event</code>æœ‰å¦‚ä¸‹å±æ€§ã€‚</p><ul><li><code>data</code>ï¼šæœåŠ¡å™¨ç«¯ä¼ å›çš„æ•°æ®ï¼ˆæ–‡æœ¬æ ¼å¼ï¼‰ã€‚</li><li><code>origin</code>ï¼š æœåŠ¡å™¨ URL çš„åŸŸåéƒ¨åˆ†ï¼Œå³åè®®ã€åŸŸåå’Œç«¯å£ï¼Œè¡¨ç¤ºæ¶ˆæ¯çš„æ¥æºã€‚</li><li><code>lastEventId</code>ï¼šæ•°æ®çš„ç¼–å·ï¼Œç”±æœåŠ¡å™¨ç«¯å‘é€ã€‚å¦‚æœæ²¡æœ‰ç¼–å·ï¼Œè¿™ä¸ªå±æ€§ä¸ºç©ºã€‚</li></ul><h4 id="onerror-å±æ€§" tabindex="-1"><a class="header-anchor" href="#onerror-å±æ€§" aria-hidden="true">#</a> onerror å±æ€§</h4><p>å¦‚æœå‘ç”Ÿé€šä¿¡é”™è¯¯ï¼ˆæ¯”å¦‚è¿æ¥ä¸­æ–­ï¼‰ï¼Œå°±ä¼šè§¦å‘<code>error</code>äº‹ä»¶ï¼Œå¯ä»¥åœ¨<code>onerror</code>å±æ€§å®šä¹‰å›è°ƒå‡½æ•°ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>source<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// handle error event</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// å¦ä¸€ç§å†™æ³•</span>
source<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;error&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// handle error event</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="è‡ªå®šä¹‰äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰äº‹ä»¶" aria-hidden="true">#</a> è‡ªå®šä¹‰äº‹ä»¶</h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨å‘æ¥çš„æ•°æ®ï¼Œæ€»æ˜¯è§¦å‘æµè§ˆå™¨<code>EventSource</code>å®ä¾‹çš„<code>message</code>äº‹ä»¶ã€‚å¼€å‘è€…è¿˜å¯ä»¥è‡ªå®šä¹‰ SSE äº‹ä»¶ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå‘é€å›æ¥çš„æ•°æ®ä¸ä¼šè§¦å‘<code>message</code>äº‹ä»¶ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>source<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;foo&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> data <span class="token operator">=</span> event<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
    <span class="token keyword">var</span> origin <span class="token operator">=</span> event<span class="token punctuation">.</span>origin<span class="token punctuation">;</span>
    <span class="token keyword">var</span> lastEventId <span class="token operator">=</span> event<span class="token punctuation">.</span>lastEventId<span class="token punctuation">;</span>
    <span class="token comment">// handle message</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œæµè§ˆå™¨å¯¹ SSE çš„<code>foo</code>äº‹ä»¶è¿›è¡Œç›‘å¬ã€‚å¦‚ä½•å®ç°æœåŠ¡å™¨å‘é€<code>foo</code>äº‹ä»¶ï¼Œè¯·çœ‹ä¸‹æ–‡ã€‚</p><h4 id="close-æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#close-æ–¹æ³•" aria-hidden="true">#</a> close() æ–¹æ³•</h4><p><code>close</code>æ–¹æ³•ç”¨äºå…³é—­ SSE è¿æ¥ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>source<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="æœåŠ¡å™¨å®ç°" tabindex="-1"><a class="header-anchor" href="#æœåŠ¡å™¨å®ç°" aria-hidden="true">#</a> æœåŠ¡å™¨å®ç°</h3><h4 id="æ•°æ®æ ¼å¼" tabindex="-1"><a class="header-anchor" href="#æ•°æ®æ ¼å¼" aria-hidden="true">#</a> æ•°æ®æ ¼å¼</h4><p>æœåŠ¡å™¨å‘æµè§ˆå™¨å‘é€çš„ SSE æ•°æ®ï¼Œå¿…é¡»æ˜¯ UTF-8 ç¼–ç çš„æ–‡æœ¬ï¼Œå…·æœ‰å¦‚ä¸‹çš„ HTTP å¤´ä¿¡æ¯ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>Content-Type: text/event-stream
Cache-Control: no-cache
Connection: keep-alive
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä¸‰è¡Œä¹‹ä¸­ï¼Œç¬¬ä¸€è¡Œçš„<code>Content-Type</code>å¿…é¡»æŒ‡å®š MIME ç±»å‹ä¸º<code>event-steam</code>ã€‚</p><p>æ¯ä¸€æ¬¡å‘é€çš„ä¿¡æ¯ï¼Œç”±è‹¥å¹²ä¸ª<code>message</code>ç»„æˆï¼Œæ¯ä¸ª<code>message</code>ä¹‹é—´ç”¨<code>\n\n</code>åˆ†éš”ã€‚æ¯ä¸ª<code>message</code>å†…éƒ¨ç”±è‹¥å¹²è¡Œç»„æˆï¼Œæ¯ä¸€è¡Œéƒ½æ˜¯å¦‚ä¸‹æ ¼å¼ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>[field]: value\n
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä¸Šé¢çš„<code>field</code>å¯ä»¥å–å››ä¸ªå€¼ã€‚</p><ul><li>data</li><li>event</li><li>id</li><li>retry</li></ul><p>æ­¤å¤–ï¼Œè¿˜å¯ä»¥æœ‰å†’å·å¼€å¤´çš„è¡Œï¼Œè¡¨ç¤ºæ³¨é‡Šã€‚é€šå¸¸ï¼ŒæœåŠ¡å™¨æ¯éš”ä¸€æ®µæ—¶é—´å°±ä¼šå‘æµè§ˆå™¨å‘é€ä¸€ä¸ªæ³¨é‡Šï¼Œä¿æŒè¿æ¥ä¸ä¸­æ–­ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>: This is a comment
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>: this is a test stream\n\n

data: some text\n\n

data: another message\n
data: with two lines \n\n
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="data-å­—æ®µ" tabindex="-1"><a class="header-anchor" href="#data-å­—æ®µ" aria-hidden="true">#</a> data å­—æ®µ</h4><p>æ•°æ®å†…å®¹ç”¨<code>data</code>å­—æ®µè¡¨ç¤ºã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>data:  message\n\n
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¦‚æœæ•°æ®å¾ˆé•¿ï¼Œå¯ä»¥åˆ†æˆå¤šè¡Œï¼Œæœ€åä¸€è¡Œç”¨<code>\n\n</code>ç»“å°¾ï¼Œå‰é¢è¡Œéƒ½ç”¨<code>\n</code>ç»“å°¾ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>data: begin message\n
data: continue message\n\n
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸‹é¢æ˜¯ä¸€ä¸ªå‘é€ JSON æ•°æ®çš„ä¾‹å­ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>data: {\n
data: &quot;foo&quot;: &quot;bar&quot;,\n
data: &quot;baz&quot;, 555\n
data: }\n\n
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="id-å­—æ®µ" tabindex="-1"><a class="header-anchor" href="#id-å­—æ®µ" aria-hidden="true">#</a> id å­—æ®µ</h4><p>æ•°æ®æ ‡è¯†ç¬¦ç”¨<code>id</code>å­—æ®µè¡¨ç¤ºï¼Œç›¸å½“äºæ¯ä¸€æ¡æ•°æ®çš„ç¼–å·ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>id: msg1\n
data: message\n\n
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æµè§ˆå™¨ç”¨<code>lastEventId</code>å±æ€§è¯»å–è¿™ä¸ªå€¼ã€‚ä¸€æ—¦è¿æ¥æ–­çº¿ï¼Œæµè§ˆå™¨ä¼šå‘é€ä¸€ä¸ª HTTP å¤´ï¼Œé‡Œé¢åŒ…å«ä¸€ä¸ªç‰¹æ®Šçš„<code>Last-Event-ID</code>å¤´ä¿¡æ¯ï¼Œå°†è¿™ä¸ªå€¼å‘é€å›æ¥ï¼Œç”¨æ¥å¸®åŠ©æœåŠ¡å™¨ç«¯é‡å»ºè¿æ¥ã€‚å› æ­¤ï¼Œè¿™ä¸ªå¤´ä¿¡æ¯å¯ä»¥è¢«è§†ä¸ºä¸€ç§åŒæ­¥æœºåˆ¶ã€‚</p><h4 id="event-å­—æ®µ" tabindex="-1"><a class="header-anchor" href="#event-å­—æ®µ" aria-hidden="true">#</a> event å­—æ®µ</h4><p><code>event</code>å­—æ®µè¡¨ç¤ºè‡ªå®šä¹‰çš„äº‹ä»¶ç±»å‹ï¼Œé»˜è®¤æ˜¯<code>message</code>äº‹ä»¶ã€‚æµè§ˆå™¨å¯ä»¥ç”¨<code>addEventListener()</code>ç›‘å¬è¯¥äº‹ä»¶ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>event: foo\n
data: a foo event\n\n

data: an unnamed event\n\n

event: bar\n
data: a bar event\n\n
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„ä»£ç åˆ›é€ äº†ä¸‰æ¡ä¿¡æ¯ã€‚ç¬¬ä¸€æ¡çš„åå­—æ˜¯<code>foo</code>ï¼Œè§¦å‘æµè§ˆå™¨çš„<code>foo</code>äº‹ä»¶ï¼›ç¬¬äºŒæ¡æœªå–åï¼Œè¡¨ç¤ºé»˜è®¤ç±»å‹ï¼Œè§¦å‘æµè§ˆå™¨çš„<code>message</code>äº‹ä»¶ï¼›ç¬¬ä¸‰æ¡æ˜¯<code>bar</code>ï¼Œè§¦å‘æµè§ˆå™¨çš„<code>bar</code>äº‹ä»¶ã€‚</p><p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>event: userconnect
data: {&quot;username&quot;: &quot;bobby&quot;, &quot;time&quot;: &quot;02:33:48&quot;}

event: usermessage
data: {&quot;username&quot;: &quot;bobby&quot;, &quot;time&quot;: &quot;02:34:11&quot;, &quot;text&quot;: &quot;Hi everyone.&quot;}

event: userdisconnect
data: {&quot;username&quot;: &quot;bobby&quot;, &quot;time&quot;: &quot;02:34:23&quot;}

event: usermessage
data: {&quot;username&quot;: &quot;sean&quot;, &quot;time&quot;: &quot;02:34:36&quot;, &quot;text&quot;: &quot;Bye, bobby.&quot;}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="retry-å­—æ®µ" tabindex="-1"><a class="header-anchor" href="#retry-å­—æ®µ" aria-hidden="true">#</a> retry å­—æ®µ</h4><p>æœåŠ¡å™¨å¯ä»¥ç”¨<code>retry</code>å­—æ®µï¼ŒæŒ‡å®šæµè§ˆå™¨é‡æ–°å‘èµ·è¿æ¥çš„æ—¶é—´é—´éš”ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>retry: 10000\n
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä¸¤ç§æƒ…å†µä¼šå¯¼è‡´æµè§ˆå™¨é‡æ–°å‘èµ·è¿æ¥ï¼šä¸€ç§æ˜¯æ—¶é—´é—´éš”åˆ°æœŸï¼ŒäºŒæ˜¯ç”±äºç½‘ç»œé”™è¯¯ç­‰åŸå› ï¼Œå¯¼è‡´è¿æ¥å‡ºé”™ã€‚</p><h3 id="node-æœåŠ¡å™¨å®ä¾‹" tabindex="-1"><a class="header-anchor" href="#node-æœåŠ¡å™¨å®ä¾‹" aria-hidden="true">#</a> Node æœåŠ¡å™¨å®ä¾‹</h3><p>SSE è¦æ±‚æœåŠ¡å™¨ä¸æµè§ˆå™¨ä¿æŒè¿æ¥ã€‚å¯¹äºä¸åŒçš„æœåŠ¡å™¨è½¯ä»¶æ¥è¯´ï¼Œæ‰€æ¶ˆè€—çš„èµ„æºæ˜¯ä¸ä¸€æ ·çš„ã€‚Apache æœåŠ¡å™¨ï¼Œæ¯ä¸ªè¿æ¥å°±æ˜¯ä¸€ä¸ªçº¿ç¨‹ï¼Œå¦‚æœè¦ç»´æŒå¤§é‡è¿æ¥ï¼ŒåŠ¿å¿…è¦æ¶ˆè€—å¤§é‡èµ„æºã€‚Node åˆ™æ˜¯æ‰€æœ‰è¿æ¥éƒ½ä½¿ç”¨åŒä¸€ä¸ªçº¿ç¨‹ï¼Œå› æ­¤æ¶ˆè€—çš„èµ„æºä¼šå°å¾—å¤šï¼Œä½†æ˜¯è¿™è¦æ±‚æ¯ä¸ªè¿æ¥ä¸èƒ½åŒ…å«å¾ˆè€—æ—¶çš„æ“ä½œï¼Œæ¯”å¦‚ç£ç›˜çš„ IO è¯»å†™ã€‚</p><p>ä¸‹é¢æ˜¯ Node çš„ SSE æœåŠ¡å™¨<a href="http://cjihrig.com/blog/server-sent-events-in-node-js/" target="_blank" rel="noopener noreferrer">å®ä¾‹<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;http&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> fileName <span class="token operator">=</span> <span class="token string">&quot;.&quot;</span> <span class="token operator">+</span> req<span class="token punctuation">.</span>url<span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>fileName <span class="token operator">===</span> <span class="token string">&quot;./stream&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token string-property property">&quot;Content-Type&quot;</span><span class="token operator">:</span><span class="token string">&quot;text/event-stream&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;Cache-Control&quot;</span><span class="token operator">:</span><span class="token string">&quot;no-cache&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;Connection&quot;</span><span class="token operator">:</span><span class="token string">&quot;keep-alive&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;Access-Control-Allow-Origin&quot;</span><span class="token operator">:</span> <span class="token string">&#39;*&#39;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;retry: 10000\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;event: connecttime\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;data: &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\n\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;data: &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\n\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        interval <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;data: &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\n\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        req<span class="token punctuation">.</span>connection<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token string">&quot;close&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">clearInterval</span><span class="token punctuation">(</span>interval<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8844</span><span class="token punctuation">,</span> <span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å‚è€ƒé“¾æ¥-8" tabindex="-1"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥-8" aria-hidden="true">#</a> å‚è€ƒé“¾æ¥</h3><ul><li>Colin Ihrig, <a href="http://jspro.com/apis/implementing-push-technology-using-server-sent-events/" target="_blank" rel="noopener noreferrer">Implementing Push Technology Using Server-Sent Events<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Colin Ihrigï¼Œ<a href="http://cjihrig.com/blog/the-server-side-of-server-sent-events/" target="_blank" rel="noopener noreferrer">The Server Side of Server-Sent Events<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Eric Bidelman, <a href="http://www.html5rocks.com/en/tutorials/eventsource/basics/" target="_blank" rel="noopener noreferrer">Stream Updates with Server-Sent Events<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>MDNï¼Œ<a href="https://developer.mozilla.org/en-US/docs/Server-sent_events/Using_server-sent_events" target="_blank" rel="noopener noreferrer">Using server-sent events<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="http://Segment.io" target="_blank" rel="noopener noreferrer">Segment.io<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, <a href="https://segment.io/blog/2014-04-03-server-sent-events-the-simplest-realtime-browser-spec/" target="_blank" rel="noopener noreferrer">Server-Sent Events: The simplest realtime browser spec<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h2 id="service-worker" tabindex="-1"><a class="header-anchor" href="#service-worker" aria-hidden="true">#</a> Service Worker</h2><h3 id="å«ä¹‰" tabindex="-1"><a class="header-anchor" href="#å«ä¹‰" aria-hidden="true">#</a> å«ä¹‰</h3><p>Service Worker é¦–å…ˆæ˜¯ä¸€ä¸ªè¿è¡Œåœ¨åå°çš„ Worker çº¿ç¨‹ï¼Œç„¶åå®ƒä¼šé•¿æœŸè¿è¡Œï¼Œå……å½“ä¸€ä¸ªæœåŠ¡ï¼Œå¾ˆé€‚åˆé‚£äº›ä¸éœ€è¦ç½‘é¡µæˆ–ç”¨æˆ·äº’åŠ¨çš„åŠŸèƒ½ã€‚å®ƒçš„æœ€å¸¸è§ç”¨é€”å°±æ˜¯æ‹¦æˆªå’Œå¤„ç†ç½‘ç»œè¯·æ±‚ã€‚</p><p>Service Worker æ˜¯ä¸€ä¸ªåå°è¿è¡Œçš„è„šæœ¬ï¼Œå……å½“ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ï¼Œæ‹¦æˆªç”¨æˆ·å‘å‡ºçš„ç½‘ç»œè¯·æ±‚ï¼Œæ¯”å¦‚åŠ è½½è„šæœ¬å’Œå›¾ç‰‡ã€‚Service Worker å¯ä»¥ä¿®æ”¹ç”¨æˆ·çš„è¯·æ±‚ï¼Œæˆ–è€…ç›´æ¥å‘ç”¨æˆ·å‘å‡ºå›åº”ï¼Œä¸ç”¨è”ç³»æœåŠ¡å™¨ï¼Œè¿™ä½¿å¾—ç”¨æˆ·å¯ä»¥åœ¨ç¦»çº¿æƒ…å†µä¸‹ä½¿ç”¨ç½‘ç»œåº”ç”¨ã€‚å®ƒè¿˜å¯ä»¥åœ¨æœ¬åœ°ç¼“å­˜èµ„æºæ–‡ä»¶ï¼Œç›´æ¥ä»ç¼“å­˜åŠ è½½æ–‡ä»¶ï¼Œå› æ­¤å¯ä»¥åŠ å¿«è®¿é—®é€Ÿåº¦ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&#39;serviceWorker&#39;</span> <span class="token keyword">in</span> navigator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;load&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        navigator<span class="token punctuation">.</span>serviceWorker<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">&#39;/service-worker.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ç¡®è®¤æµè§ˆå™¨æ”¯æŒ Service Worker ä»¥åï¼Œä¼šæ³¨å†Œä¸€ä¸ª Service Workerã€‚</p><p>ä¸ºäº†èŠ‚çœå†…å­˜ï¼ŒService worker åœ¨ä¸ä½¿ç”¨çš„æ—¶å€™æ˜¯ä¼‘çœ çš„ã€‚å®ƒä¹Ÿä¸ä¼šä¿å­˜æ•°æ®ï¼Œæ‰€ä»¥é‡æ–°å¯åŠ¨çš„æ—¶å€™ï¼Œä¸ºäº†æ‹¿åˆ°æ•°æ®ï¼Œæœ€å¥½æŠŠæ•°æ®æ”¾åœ¨ IndexedDb é‡Œé¢ã€‚</p><p>Service Worker æ˜¯äº‹ä»¶é©±åŠ¨çš„ã€‚</p><p>ä¸‹é¢æ˜¯æ‹¦æˆªè¯·æ±‚çš„ä¾‹å­ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;fetch&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    event<span class="token punctuation">.</span><span class="token function">waitUntil</span><span class="token punctuation">(</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>request<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&#39;/product&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> productId <span class="token operator">=</span> event<span class="token punctuation">.</span>data<span class="token punctuation">.</span>productId
        <span class="token keyword">let</span> productCount <span class="token operator">=</span> <span class="token function">getProductData</span><span class="token punctuation">(</span>productId<span class="token punctuation">)</span>
        indexedDB<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&#39;store&#39;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">db</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> productStore <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">createObjectStore</span><span class="token punctuation">(</span><span class="token string">&#39;products&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">keyPath</span><span class="token operator">:</span> <span class="token string">&#39;id&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
            productStore<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> productId<span class="token punctuation">,</span> <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token operator">++</span>productCount <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Service Worker ä¸èƒ½ç›´æ¥æ“ä½œ DOMã€‚</p><h3 id="ä½¿ç”¨æ­¥éª¤" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨æ­¥éª¤" aria-hidden="true">#</a> ä½¿ç”¨æ­¥éª¤</h3><h4 id="ç™»è®°" tabindex="-1"><a class="header-anchor" href="#ç™»è®°" aria-hidden="true">#</a> ç™»è®°</h4><p>ä½¿ç”¨ service worker çš„ç¬¬ä¸€æ­¥ï¼Œå°±æ˜¯å‘Šè¯‰æµè§ˆå™¨ï¼Œéœ€è¦æ³¨å†Œä¸€ä¸ª service worker è„šæœ¬ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>navigator<span class="token punctuation">.</span>serviceWorker<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">&#39;sw.js&#39;</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&#39;æ³¨å†ŒæˆåŠŸ&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;æ³¨å†Œå¤±è´¥&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç çš„<code>sw.js</code>å°±æ˜¯éœ€è¦æµè§ˆå™¨æ³¨å†Œçš„ service worker è„šæœ¬ã€‚æ³¨æ„ï¼Œè¿™ä¸ªè„šæœ¬å¿…é¡»ä¸å½“å‰ç½‘å€åŒåŸŸï¼Œservice worker ä¸æ”¯æŒè·¨åŸŸè„šæœ¬ã€‚å¦å¤–ï¼Œ<code>sw.js</code>å¿…é¡»æ˜¯ä» HTTPS åè®®åŠ è½½çš„ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒService worker åªå¯¹æ ¹ç›®å½•<code>/</code>ç”Ÿæ•ˆï¼Œå¦‚æœè¦æ”¹å˜ç”Ÿæ•ˆèŒƒå›´ï¼Œå¯ä»¥è¿è¡Œä¸‹é¢çš„ä»£ç ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>navigator<span class="token punctuation">.</span>serviceWorker<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>
    <span class="token string">&#39;/service-worker.js&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">scope</span><span class="token operator">:</span> <span class="token string">&#39;/products/fashion&#39;</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å®‰è£…" tabindex="-1"><a class="header-anchor" href="#å®‰è£…" aria-hidden="true">#</a> å®‰è£…</h4><p>ä¸€æ—¦ç™»è®°æˆåŠŸï¼Œæ¥ä¸‹æ¥éƒ½æ˜¯ service worker è„šæœ¬çš„å·¥ä½œã€‚ä¸‹é¢çš„ä»£ç éƒ½æ˜¯å†™åœ¨ service worker è„šæœ¬é‡Œé¢çš„ã€‚</p><p>ç™»è®°åï¼Œå°±ä¼šè§¦å‘<code>install</code>äº‹ä»¶ã€‚service worker è„šæœ¬éœ€è¦ç›‘å¬è¿™ä¸ªäº‹ä»¶ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;install&#39;</span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

    event<span class="token punctuation">.</span><span class="token function">waitUntil</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&#39;å®‰è£…å®Œæˆ&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>event.waitUntil()</code>æ–¹æ³•ä¸ºäº‹ä»¶å®ŒæˆåæŒ‡å®šå›è°ƒå‡½æ•°ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;install&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token constant">CACHE_NAME</span> <span class="token operator">=</span> <span class="token string">&#39;xyz-cache&#39;</span>
    <span class="token keyword">let</span> urlsToCache <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token string">&#39;/&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;/styles/main.css&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;/scripts/bundle.js&#39;</span>
    <span class="token punctuation">]</span>
    event<span class="token punctuation">.</span><span class="token function">waitUntil</span><span class="token punctuation">(</span>
        caches<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token constant">CACHE_NAME</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">then</span> <span class="token punctuation">(</span><span class="token parameter">cache</span> <span class="token operator">=&gt;</span> cache<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>urlsToCache<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ¿€æ´»" tabindex="-1"><a class="header-anchor" href="#æ¿€æ´»" aria-hidden="true">#</a> æ¿€æ´»</h4><p>å®‰è£…å®Œæˆåï¼Œservice worker å°±ä¼šç­‰å¾…æ¿€æ´»ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;activate&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> cacheWhitelist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;products-v2&#39;</span><span class="token punctuation">]</span>

    event<span class="token punctuation">.</span><span class="token function">waitUntil</span><span class="token punctuation">(</span>
        caches<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span> <span class="token punctuation">(</span><span class="token parameter">cacheNames</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>
                cacheNames<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span> <span class="token parameter">cacheName</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>cacheWhitelist<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>cacheName<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">return</span> caches<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>cacheName<span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="service-worker-ä¸ç½‘é¡µçš„é€šä¿¡" tabindex="-1"><a class="header-anchor" href="#service-worker-ä¸ç½‘é¡µçš„é€šä¿¡" aria-hidden="true">#</a> Service Worker ä¸ç½‘é¡µçš„é€šä¿¡</h3><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;activate&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    event<span class="token punctuation">.</span><span class="token function">waitUntil</span><span class="token punctuation">(</span>
        self<span class="token punctuation">.</span>clients<span class="token punctuation">.</span><span class="token function">matchAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token parameter">client</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            client<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">&#39;Hey, from service worker! I\&#39;m listening to your fetch requests.&#39;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token string">&#39;service-worker&#39;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼ŒService Worker ç›‘å¬<code>activate</code>äº‹ä»¶ï¼Œç„¶åå‘å®¢æˆ·ç«¯å‘é€ä¸€æ¡ä¿¡æ¯ã€‚</p><p>å®¢æˆ·ç«¯éœ€è¦éƒ¨ç½²æ¶ˆæ¯ç›‘å¬ä»£ç ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;message&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>source <span class="token operator">==</span> <span class="token string">&#39;service-worker&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>msg<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å‚è€ƒé“¾æ¥-9" tabindex="-1"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥-9" aria-hidden="true">#</a> å‚è€ƒé“¾æ¥</h3><ul><li><a href="https://frontendian.co/service-workers" target="_blank" rel="noopener noreferrer">Service Workers<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, by Ryan Miller</li></ul><h2 id="svg-å›¾åƒ" tabindex="-1"><a class="header-anchor" href="#svg-å›¾åƒ" aria-hidden="true">#</a> SVG å›¾åƒ</h2><h3 id="æ¦‚è¿°-1" tabindex="-1"><a class="header-anchor" href="#æ¦‚è¿°-1" aria-hidden="true">#</a> æ¦‚è¿°</h3><p>SVG æ˜¯ä¸€ç§åŸºäº XML è¯­æ³•çš„å›¾åƒæ ¼å¼ï¼Œå…¨ç§°æ˜¯å¯ç¼©æ”¾çŸ¢é‡å›¾ï¼ˆScalable Vector Graphicsï¼‰ã€‚å…¶ä»–å›¾åƒæ ¼å¼éƒ½æ˜¯åŸºäºåƒç´ å¤„ç†çš„ï¼ŒSVG åˆ™æ˜¯å±äºå¯¹å›¾åƒçš„å½¢çŠ¶æè¿°ï¼Œæ‰€ä»¥å®ƒæœ¬è´¨ä¸Šæ˜¯æ–‡æœ¬æ–‡ä»¶ï¼Œä½“ç§¯è¾ƒå°ï¼Œä¸”ä¸ç®¡æ”¾å¤§å¤šå°‘å€éƒ½ä¸ä¼šå¤±çœŸã€‚</p><p>SVG æ–‡ä»¶å¯ä»¥ç›´æ¥æ’å…¥ç½‘é¡µï¼Œæˆä¸º DOM çš„ä¸€éƒ¨åˆ†ï¼Œç„¶åç”¨ JavaScript å’Œ CSS è¿›è¡Œæ“ä½œã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span>
        <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mysvg<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2000/svg<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0 0 800 600<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">preserveAspectRatio</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xMidYMid meet<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mycircle<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>400<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>300<span class="token punctuation">&quot;</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢æ˜¯ SVG ä»£ç ç›´æ¥æ’å…¥ç½‘é¡µçš„ä¾‹å­ã€‚</p><p>SVG ä»£ç ä¹Ÿå¯ä»¥å†™åœ¨ä¸€ä¸ªç‹¬ç«‹æ–‡ä»¶ä¸­ï¼Œç„¶åç”¨<code>&lt;img&gt;</code>ã€<code>&lt;object&gt;</code>ã€<code>&lt;embed&gt;</code>ã€<code>&lt;iframe&gt;</code>ç­‰æ ‡ç­¾æ’å…¥ç½‘é¡µã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>circle.svg<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>object</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>object<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>circle.svg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image/svg+xml<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>object</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>embed</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>embed<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>icon.svg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image/svg+xml<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>iframe<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>icon.svg<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>CSS ä¹Ÿå¯ä»¥ä½¿ç”¨ SVG æ–‡ä»¶ã€‚</p><div class="language-css line-numbers-mode" data-ext="css"><pre class="language-css"><code><span class="token selector">.logo</span> <span class="token punctuation">{</span>
    <span class="token property">background</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>icon.svg<span class="token punctuation">)</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>SVG æ–‡ä»¶è¿˜å¯ä»¥è½¬ä¸º BASE64 ç¼–ç ï¼Œç„¶åä½œä¸º Data URI å†™å…¥ç½‘é¡µã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>data:image/svg+xml;base64,[data]<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="è¯­æ³•" tabindex="-1"><a class="header-anchor" href="#è¯­æ³•" aria-hidden="true">#</a> è¯­æ³•</h3><h4 id="svg-æ ‡ç­¾" tabindex="-1"><a class="header-anchor" href="#svg-æ ‡ç­¾" aria-hidden="true">#</a> <code>&lt;svg&gt;</code>æ ‡ç­¾</h4><p>SVG ä»£ç éƒ½æ”¾åœ¨é¡¶å±‚æ ‡ç­¾<code>&lt;svg&gt;</code>ä¹‹ä¸­ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100%<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100%<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mycircle<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>&lt;svg&gt;</code>çš„<code>width</code>å±æ€§å’Œ<code>height</code>å±æ€§ï¼ŒæŒ‡å®šäº† SVG å›¾åƒåœ¨ HTML å…ƒç´ ä¸­æ‰€å æ®çš„å®½åº¦å’Œé«˜åº¦ã€‚é™¤äº†ç›¸å¯¹å•ä½ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨ç»å¯¹å•ä½ï¼ˆå•ä½ï¼šåƒç´ ï¼‰ã€‚å¦‚æœä¸æŒ‡å®šè¿™ä¸¤ä¸ªå±æ€§ï¼ŒSVG å›¾åƒçš„å¤§å°é»˜è®¤ä¸º300åƒç´ ï¼ˆå®½ï¼‰x 150åƒç´ ï¼ˆé«˜ï¼‰ã€‚</p><p>å¦‚æœåªæƒ³å±•ç¤º SVG å›¾åƒçš„ä¸€éƒ¨åˆ†ï¼Œå°±è¦æŒ‡å®š<code>viewBox</code>å±æ€§ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span> <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50 50 50 50<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mycircle<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>&lt;viewBox&gt;</code>å±æ€§çš„å€¼æœ‰å››ä¸ªæ•°å­—ï¼Œåˆ†åˆ«æ˜¯å·¦ä¸Šè§’çš„æ¨ªåæ ‡å’Œçºµåæ ‡ã€è§†å£çš„å®½åº¦å’Œé«˜åº¦ã€‚ä¸Šé¢ä»£ç ä¸­ï¼ŒSVG å›¾åƒæ˜¯100åƒç´ å®½ x 100åƒç´ é«˜ï¼Œ<code>viewBox</code>å±æ€§æŒ‡å®šè§†å£ä»<code>(50, 50)</code>è¿™ä¸ªç‚¹å¼€å§‹ã€‚æ‰€ä»¥ï¼Œå®é™…çœ‹åˆ°çš„æ˜¯å³ä¸‹è§’çš„å››åˆ†ä¹‹ä¸€åœ†ã€‚</p><p>æ³¨æ„ï¼Œè§†å£å¿…é¡»é€‚é…æ‰€åœ¨çš„ç©ºé—´ã€‚ä¸Šé¢ä»£ç ä¸­ï¼Œè§†å£çš„å¤§å°æ˜¯ 50 x 50ï¼Œç”±äº SVG å›¾åƒçš„å¤§å°æ˜¯ 100 x 100ï¼Œæ‰€ä»¥è§†å£ä¼šæ”¾å¤§å»é€‚é… SVG å›¾åƒçš„å¤§å°ï¼Œå³æ”¾å¤§äº†å››å€ã€‚</p><p>å¦‚æœä¸æŒ‡å®š<code>width</code>å±æ€§å’Œ<code>height</code>å±æ€§ï¼ŒåªæŒ‡å®š<code>viewBox</code>å±æ€§ï¼Œåˆ™ç›¸å½“äºåªç»™å®š SVG å›¾åƒçš„é•¿å®½æ¯”ã€‚è¿™æ—¶ï¼ŒSVG å›¾åƒçš„å¤§å°é»˜è®¤æ˜¯æ‰€åœ¨çš„ HTML å…ƒç´ çš„å¤§å°ã€‚</p><h4 id="circle-æ ‡ç­¾" tabindex="-1"><a class="header-anchor" href="#circle-æ ‡ç­¾" aria-hidden="true">#</a> <code>&lt;circle&gt;</code>æ ‡ç­¾</h4><p><code>&lt;circle&gt;</code>æ ‡ç­¾ä»£è¡¨åœ†å½¢ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>300<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>180<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>30<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>25<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>90<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>25<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>red<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>150<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>25<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fancy<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„ä»£ç å®šä¹‰äº†ä¸‰ä¸ªåœ†ã€‚<code>&lt;circle&gt;</code>æ ‡ç­¾çš„<code>cx</code>ã€<code>cy</code>ã€<code>r</code>å±æ€§åˆ†åˆ«ä¸ºæ¨ªåæ ‡ã€çºµåæ ‡å’ŒåŠå¾„ï¼Œå•ä½ä¸ºåƒç´ ã€‚åæ ‡éƒ½æ˜¯ç›¸å¯¹äº<code>&lt;svg&gt;</code>ç”»å¸ƒçš„å·¦ä¸Šè§’åŸç‚¹ã€‚</p><p><code>class</code>å±æ€§ç”¨æ¥æŒ‡å®šå¯¹åº”çš„ CSS ç±»ã€‚</p><div class="language-css line-numbers-mode" data-ext="css"><pre class="language-css"><code><span class="token selector">.red</span> <span class="token punctuation">{</span>
    <span class="token property">fill</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.fancy</span> <span class="token punctuation">{</span>
    <span class="token property">fill</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
    <span class="token property">stroke</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span>
    <span class="token property">stroke-width</span><span class="token punctuation">:</span> 3pt<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>SVG çš„ CSS å±æ€§ä¸ç½‘é¡µå…ƒç´ æœ‰æ‰€ä¸åŒã€‚</p><blockquote><ul><li>fillï¼šå¡«å……è‰²</li><li>strokeï¼šæè¾¹è‰²</li><li>stroke-widthï¼šè¾¹æ¡†å®½åº¦</li></ul></blockquote><h4 id="line-æ ‡ç­¾" tabindex="-1"><a class="header-anchor" href="#line-æ ‡ç­¾" aria-hidden="true">#</a> <code>&lt;line&gt;</code>æ ‡ç­¾</h4><p><code>&lt;line&gt;</code>æ ‡ç­¾ç”¨æ¥ç»˜åˆ¶ç›´çº¿ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>300<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>180<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>line</span> <span class="token attr-name">x1</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">y1</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">x2</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>200<span class="token punctuation">&quot;</span></span> <span class="token attr-name">y2</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stroke:rgb(0,0,0);stroke-width:5<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>&lt;line&gt;</code>æ ‡ç­¾çš„<code>x1</code>å±æ€§å’Œ<code>y1</code>å±æ€§ï¼Œè¡¨ç¤ºçº¿æ®µèµ·ç‚¹çš„æ¨ªåæ ‡å’Œçºµåæ ‡ï¼›<code>x2</code>å±æ€§å’Œ<code>y2</code>å±æ€§ï¼Œè¡¨ç¤ºçº¿æ®µç»ˆç‚¹çš„æ¨ªåæ ‡å’Œçºµåæ ‡ï¼›<code>style</code>å±æ€§è¡¨ç¤ºçº¿æ®µçš„æ ·å¼ã€‚</p><h4 id="polyline-æ ‡ç­¾" tabindex="-1"><a class="header-anchor" href="#polyline-æ ‡ç­¾" aria-hidden="true">#</a> <code>&lt;polyline&gt;</code>æ ‡ç­¾</h4><p><code>&lt;polyline&gt;</code>æ ‡ç­¾ç”¨äºç»˜åˆ¶ä¸€æ ¹æŠ˜çº¿ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>300<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>180<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>polyline</span> <span class="token attr-name">points</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>3,3 30,28 3,53<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>none<span class="token punctuation">&quot;</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>black<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>&lt;polyline&gt;</code>çš„<code>points</code>å±æ€§æŒ‡å®šäº†æ¯ä¸ªç«¯ç‚¹çš„åæ ‡ï¼Œæ¨ªåæ ‡ä¸çºµåæ ‡ä¹‹é—´ä¸é€—å·åˆ†éš”ï¼Œç‚¹ä¸ç‚¹ä¹‹é—´ç”¨ç©ºæ ¼åˆ†éš”ã€‚</p><h4 id="rect-æ ‡ç­¾" tabindex="-1"><a class="header-anchor" href="#rect-æ ‡ç­¾" aria-hidden="true">#</a> <code>&lt;rect&gt;</code>æ ‡ç­¾</h4><p><code>&lt;rect&gt;</code>æ ‡ç­¾ç”¨äºç»˜åˆ¶çŸ©å½¢ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>300<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>180<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>200<span class="token punctuation">&quot;</span></span> <span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stroke: ##70d5dd; fill: ##dd524b<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>&lt;rect&gt;</code>çš„<code>x</code>å±æ€§å’Œ<code>y</code>å±æ€§ï¼ŒæŒ‡å®šäº†çŸ©å½¢å·¦ä¸Šè§’ç«¯ç‚¹çš„æ¨ªåæ ‡å’Œçºµåæ ‡ï¼›<code>width</code>å±æ€§å’Œ<code>height</code>å±æ€§æŒ‡å®šäº†çŸ©å½¢çš„å®½åº¦å’Œé«˜åº¦ï¼ˆå•ä½åƒç´ ï¼‰ã€‚</p><h4 id="ellipse-æ ‡ç­¾" tabindex="-1"><a class="header-anchor" href="#ellipse-æ ‡ç­¾" aria-hidden="true">#</a> <code>&lt;ellipse&gt;</code>æ ‡ç­¾</h4><p><code>&lt;ellipse&gt;</code>æ ‡ç­¾ç”¨äºç»˜åˆ¶æ¤­åœ†ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>300<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>180<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ellipse</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>60<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>60<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ry</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>40<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>20<span class="token punctuation">&quot;</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>black<span class="token punctuation">&quot;</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>silver<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>&lt;ellipse&gt;</code>çš„<code>cx</code>å±æ€§å’Œ<code>cy</code>å±æ€§ï¼ŒæŒ‡å®šäº†æ¤­åœ†ä¸­å¿ƒçš„æ¨ªåæ ‡å’Œçºµåæ ‡ï¼ˆå•ä½åƒç´ ï¼‰ï¼›<code>rx</code>å±æ€§å’Œ<code>ry</code>å±æ€§ï¼ŒæŒ‡å®šäº†æ¤­åœ†æ¨ªå‘è½´å’Œçºµå‘è½´çš„åŠå¾„ï¼ˆå•ä½åƒç´ ï¼‰ã€‚</p><h4 id="polygon-æ ‡ç­¾" tabindex="-1"><a class="header-anchor" href="#polygon-æ ‡ç­¾" aria-hidden="true">#</a> <code>&lt;polygon&gt;</code>æ ‡ç­¾</h4><p><code>&lt;polygon&gt;</code>æ ‡ç­¾ç”¨äºç»˜åˆ¶å¤šè¾¹å½¢ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>300<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>180<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>polygon</span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>green<span class="token punctuation">&quot;</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>orange<span class="token punctuation">&quot;</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">points</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0,0 100,0 100,100 0,100 0,0<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>&lt;polygon&gt;</code>çš„<code>points</code>å±æ€§æŒ‡å®šäº†æ¯ä¸ªç«¯ç‚¹çš„åæ ‡ï¼Œæ¨ªåæ ‡ä¸çºµåæ ‡ä¹‹é—´ä¸é€—å·åˆ†éš”ï¼Œç‚¹ä¸ç‚¹ä¹‹é—´ç”¨ç©ºæ ¼åˆ†éš”ã€‚</p><h4 id="path-æ ‡ç­¾" tabindex="-1"><a class="header-anchor" href="#path-æ ‡ç­¾" aria-hidden="true">#</a> <code>&lt;path&gt;</code>æ ‡ç­¾</h4><p><code>&lt;path&gt;</code>æ ‡ç­¾ç”¨äºåˆ¶è·¯å¾„ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>300<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>180<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>
  M 18,3
  L 46,3
  L 46,40
  L 61,40
  L 32,68
  L 3,40
  L 18,40
  Z
<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>path</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>&lt;path&gt;</code>çš„<code>d</code>å±æ€§è¡¨ç¤ºç»˜åˆ¶é¡ºåºï¼Œå®ƒçš„å€¼æ˜¯ä¸€ä¸ªé•¿å­—ç¬¦ä¸²ï¼Œæ¯ä¸ªå­—æ¯è¡¨ç¤ºä¸€ä¸ªç»˜åˆ¶åŠ¨ä½œï¼Œåé¢è·Ÿç€åæ ‡ã€‚</p><blockquote><ul><li>Mï¼šç§»åŠ¨åˆ°ï¼ˆmovetoï¼‰</li><li>Lï¼šç”»ç›´çº¿åˆ°ï¼ˆlinetoï¼‰</li><li>Zï¼šé—­åˆè·¯å¾„</li></ul></blockquote><h4 id="text-æ ‡ç­¾" tabindex="-1"><a class="header-anchor" href="#text-æ ‡ç­¾" aria-hidden="true">#</a> <code>&lt;text&gt;</code>æ ‡ç­¾</h4><p><code>&lt;text&gt;</code>æ ‡ç­¾ç”¨äºç»˜åˆ¶æ–‡æœ¬ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>300<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>180<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>25<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Hello World<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>&lt;text&gt;</code>çš„<code>x</code>å±æ€§å’Œ<code>y</code>å±æ€§ï¼Œè¡¨ç¤ºæ–‡æœ¬åŒºå—åŸºçº¿ï¼ˆbaselineï¼‰èµ·ç‚¹çš„æ¨ªåæ ‡å’Œçºµåæ ‡ã€‚æ–‡å­—çš„æ ·å¼å¯ä»¥ç”¨<code>class</code>æˆ–<code>style</code>å±æ€§æŒ‡å®šã€‚</p><h4 id="use-æ ‡ç­¾" tabindex="-1"><a class="header-anchor" href="#use-æ ‡ç­¾" aria-hidden="true">#</a> <code>&lt;use&gt;</code>æ ‡ç­¾</h4><p><code>&lt;use&gt;</code>æ ‡ç­¾ç”¨äºå¤åˆ¶ä¸€ä¸ªå½¢çŠ¶ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0 0 30 10<span class="token punctuation">&quot;</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2000/svg<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myCircle<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5<span class="token punctuation">&quot;</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>use</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>##myCircle<span class="token punctuation">&quot;</span></span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>10<span class="token punctuation">&quot;</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>blue<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>use</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>##myCircle<span class="token punctuation">&quot;</span></span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>20<span class="token punctuation">&quot;</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>white<span class="token punctuation">&quot;</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>blue<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>&lt;use&gt;</code>çš„<code>href</code>å±æ€§æŒ‡å®šæ‰€è¦å¤åˆ¶çš„èŠ‚ç‚¹ï¼Œ<code>x</code>å±æ€§å’Œ<code>y</code>å±æ€§æ˜¯<code>&lt;use&gt;</code>å·¦ä¸Šè§’çš„åæ ‡ã€‚å¦å¤–ï¼Œè¿˜å¯ä»¥æŒ‡å®š<code>width</code>å’Œ<code>height</code>åæ ‡ã€‚</p><h4 id="g-æ ‡ç­¾" tabindex="-1"><a class="header-anchor" href="#g-æ ‡ç­¾" aria-hidden="true">#</a> <code>&lt;g&gt;</code>æ ‡ç­¾</h4><p><code>&lt;g&gt;</code>æ ‡ç­¾ç”¨äºå°†å¤šä¸ªå½¢çŠ¶ç»„æˆä¸€ä¸ªç»„ï¼ˆgroupï¼‰ï¼Œæ–¹ä¾¿å¤ç”¨ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>300<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>g</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myCircle<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>25<span class="token punctuation">&quot;</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>20<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>åœ†å½¢<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>20<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>g</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>use</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>##myCircle<span class="token punctuation">&quot;</span></span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>blue<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>use</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>##myCircle<span class="token punctuation">&quot;</span></span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>200<span class="token punctuation">&quot;</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>white<span class="token punctuation">&quot;</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>blue<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="defs-æ ‡ç­¾" tabindex="-1"><a class="header-anchor" href="#defs-æ ‡ç­¾" aria-hidden="true">#</a> <code>&lt;defs&gt;</code>æ ‡ç­¾</h4><p><code>&lt;defs&gt;</code>æ ‡ç­¾ç”¨äºè‡ªå®šä¹‰å½¢çŠ¶ï¼Œå®ƒå†…éƒ¨çš„ä»£ç ä¸ä¼šæ˜¾ç¤ºï¼Œä»…ä¾›å¼•ç”¨ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>300<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>g</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myCircle<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>25<span class="token punctuation">&quot;</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>20<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>åœ†å½¢<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>20<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>g</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>use</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>##myCircle<span class="token punctuation">&quot;</span></span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>use</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>##myCircle<span class="token punctuation">&quot;</span></span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>blue<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>use</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>##myCircle<span class="token punctuation">&quot;</span></span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>200<span class="token punctuation">&quot;</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>white<span class="token punctuation">&quot;</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>blue<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="pattern-æ ‡ç­¾" tabindex="-1"><a class="header-anchor" href="#pattern-æ ‡ç­¾" aria-hidden="true">#</a> <code>&lt;pattern&gt;</code>æ ‡ç­¾</h4><p><code>&lt;pattern&gt;</code>æ ‡ç­¾ç”¨äºè‡ªå®šä¹‰ä¸€ä¸ªå½¢çŠ¶ï¼Œè¯¥å½¢çŠ¶å¯ä»¥è¢«å¼•ç”¨æ¥å¹³é“ºä¸€ä¸ªåŒºåŸŸã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>500<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>500<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dots<span class="token punctuation">&quot;</span></span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span> <span class="token attr-name">patternUnits</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userSpaceOnUse<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>##bee9e8<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>35<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100%<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100%<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>url(##dots)<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>&lt;pattern&gt;</code>æ ‡ç­¾å°†ä¸€ä¸ªåœ†å½¢å®šä¹‰ä¸º<code>dots</code>æ¨¡å¼ã€‚<code>patternUnits=&quot;userSpaceOnUse&quot;</code>è¡¨ç¤º<code>&lt;pattern&gt;</code>çš„å®½åº¦å’Œé•¿åº¦æ˜¯å®é™…çš„åƒç´ å€¼ã€‚ç„¶åï¼ŒæŒ‡å®šè¿™ä¸ªæ¨¡å¼å»å¡«å……ä¸‹é¢çš„çŸ©å½¢ã€‚</p><h4 id="image-æ ‡ç­¾" tabindex="-1"><a class="header-anchor" href="#image-æ ‡ç­¾" aria-hidden="true">#</a> <code>&lt;image&gt;</code>æ ‡ç­¾</h4><p><code>&lt;image&gt;</code>æ ‡ç­¾ç”¨äºæ’å…¥å›¾ç‰‡æ–‡ä»¶ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0 0 100 100<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name"><span class="token namespace">xlink:</span>href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>path/to/image.jpg<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50%<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50%<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>&lt;image&gt;</code>çš„<code>xlink:href</code>å±æ€§è¡¨ç¤ºå›¾åƒçš„æ¥æºã€‚</p><h4 id="animate-æ ‡ç­¾" tabindex="-1"><a class="header-anchor" href="#animate-æ ‡ç­¾" aria-hidden="true">#</a> <code>&lt;animate&gt;</code>æ ‡ç­¾</h4><p><code>&lt;animate&gt;</code>æ ‡ç­¾ç”¨äºäº§ç”ŸåŠ¨ç”»æ•ˆæœã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>500px<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>500px<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>##feac5e<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animate</span> <span class="token attr-name">attributeName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>x<span class="token punctuation">&quot;</span></span> <span class="token attr-name">from</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>500<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2s<span class="token punctuation">&quot;</span></span> <span class="token attr-name">repeatCount</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>indefinite<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rect</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼ŒçŸ©å½¢ä¼šä¸æ–­ç§»åŠ¨ï¼Œäº§ç”ŸåŠ¨ç”»æ•ˆæœã€‚</p><p><code>&lt;animate&gt;</code>çš„å±æ€§å«ä¹‰å¦‚ä¸‹ã€‚</p><blockquote><ul><li>attributeNameï¼šå‘ç”ŸåŠ¨ç”»æ•ˆæœçš„å±æ€§åã€‚</li><li>fromï¼šå•æ¬¡åŠ¨ç”»çš„åˆå§‹å€¼ã€‚</li><li>toï¼šå•æ¬¡åŠ¨ç”»çš„ç»“æŸå€¼ã€‚</li><li>durï¼šå•æ¬¡åŠ¨ç”»çš„æŒç»­æ—¶é—´ã€‚</li><li>repeatCountï¼šåŠ¨ç”»çš„å¾ªç¯æ¨¡å¼ã€‚</li></ul></blockquote><p>å¯ä»¥åœ¨å¤šä¸ªå±æ€§ä¸Šé¢å®šä¹‰åŠ¨ç”»ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animate</span> <span class="token attr-name">attributeName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>x<span class="token punctuation">&quot;</span></span> <span class="token attr-name">from</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>500<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2s<span class="token punctuation">&quot;</span></span> <span class="token attr-name">repeatCount</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>indefinite<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animate</span> <span class="token attr-name">attributeName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width<span class="token punctuation">&quot;</span></span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>500<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2s<span class="token punctuation">&quot;</span></span> <span class="token attr-name">repeatCount</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>indefinite<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="animatetransform-æ ‡ç­¾" tabindex="-1"><a class="header-anchor" href="#animatetransform-æ ‡ç­¾" aria-hidden="true">#</a> <code>&lt;animateTransform&gt;</code>æ ‡ç­¾</h4><p><code>&lt;animate&gt;</code>æ ‡ç­¾å¯¹ CSS çš„<code>transform</code>å±æ€§ä¸èµ·ä½œç”¨ï¼Œå¦‚æœéœ€è¦å˜å½¢ï¼Œå°±è¦ä½¿ç”¨<code>&lt;animateTransform&gt;</code>æ ‡ç­¾ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>500px<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>500px<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>250<span class="token punctuation">&quot;</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>250<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>##4bc0c8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animateTransform</span> <span class="token attr-name">attributeName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>transform<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>rotate<span class="token punctuation">&quot;</span></span> <span class="token attr-name">begin</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0s<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>10s<span class="token punctuation">&quot;</span></span> <span class="token attr-name">from</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0 200 200<span class="token punctuation">&quot;</span></span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>360 400 400<span class="token punctuation">&quot;</span></span> <span class="token attr-name">repeatCount</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>indefinite<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rect</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>&lt;animateTransform&gt;</code>çš„æ•ˆæœä¸ºæ—‹è½¬ï¼ˆ<code>rotate</code>ï¼‰ï¼Œè¿™æ—¶<code>from</code>å’Œ<code>to</code>å±æ€§å€¼æœ‰ä¸‰ä¸ªæ•°å­—ï¼Œç¬¬ä¸€ä¸ªæ•°å­—æ˜¯è§’åº¦å€¼ï¼Œç¬¬äºŒä¸ªå€¼å’Œç¬¬ä¸‰ä¸ªå€¼æ˜¯æ—‹è½¬ä¸­å¿ƒçš„åæ ‡ã€‚<code>from=&quot;0 200 200&quot;</code>è¡¨ç¤ºå¼€å§‹æ—¶ï¼Œè§’åº¦ä¸º0ï¼Œå›´ç»•<code>(200, 200)</code>å¼€å§‹æ—‹è½¬ï¼›<code>to=&quot;360 400 400&quot;</code>è¡¨ç¤ºç»“æŸæ—¶ï¼Œè§’åº¦ä¸º360ï¼Œå›´ç»•<code>(400, 400)</code>æ—‹è½¬ã€‚</p><h3 id="javascript-æ“ä½œ" tabindex="-1"><a class="header-anchor" href="#javascript-æ“ä½œ" aria-hidden="true">#</a> JavaScript æ“ä½œ</h3><h4 id="dom-æ“ä½œ" tabindex="-1"><a class="header-anchor" href="#dom-æ“ä½œ" aria-hidden="true">#</a> DOM æ“ä½œ</h4><p>å¦‚æœ SVG ä»£ç ç›´æ¥å†™åœ¨ HTML ç½‘é¡µä¹‹ä¸­ï¼Œå®ƒå°±æˆä¸ºç½‘é¡µ DOM çš„ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥ç›´æ¥ç”¨ DOM æ“ä½œã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span>
        <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mysvg<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2000/svg<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0 0 800 600<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">preserveAspectRatio</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xMidYMid meet<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mycircle<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>400<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>300<span class="token punctuation">&quot;</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç æ’å…¥ç½‘é¡µä¹‹åï¼Œå°±å¯ä»¥ç”¨ CSS å®šåˆ¶æ ·å¼ã€‚</p><div class="language-css line-numbers-mode" data-ext="css"><pre class="language-css"><code><span class="token selector">circle</span> <span class="token punctuation">{</span>
    <span class="token property">stroke-width</span><span class="token punctuation">:</span> 5<span class="token punctuation">;</span>
    <span class="token property">stroke</span><span class="token punctuation">:</span> ##f00<span class="token punctuation">;</span>
    <span class="token property">fill</span><span class="token punctuation">:</span> ##ff0<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">circle:hover</span> <span class="token punctuation">{</span>
    <span class="token property">stroke</span><span class="token punctuation">:</span> ##090<span class="token punctuation">;</span>
    <span class="token property">fill</span><span class="token punctuation">:</span> ##fff<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åï¼Œå¯ä»¥ç”¨ JavaScript ä»£ç æ“ä½œ SVGã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> mycircle <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;mycircle&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

mycircle<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;circle clicked - enlarging&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    mycircle<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;r&#39;</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç æŒ‡å®šï¼Œå¦‚æœç‚¹å‡»å›¾å½¢ï¼Œå°±æ”¹å†™<code>circle</code>å…ƒç´ çš„<code>r</code>å±æ€§ã€‚</p><h4 id="è·å–-svg-dom" tabindex="-1"><a class="header-anchor" href="#è·å–-svg-dom" aria-hidden="true">#</a> è·å– SVG DOM</h4><p>ä½¿ç”¨<code>&lt;object&gt;</code>ã€<code>&lt;iframe&gt;</code>ã€<code>&lt;embed&gt;</code>æ ‡ç­¾æ’å…¥ SVG æ–‡ä»¶ï¼Œå¯ä»¥è·å– SVG DOMã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> svgObject <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;object&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>contentDocument<span class="token punctuation">;</span>
<span class="token keyword">var</span> svgIframe <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;iframe&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>contentDocument<span class="token punctuation">;</span>
<span class="token keyword">var</span> svgEmbed <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;embed&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSVGDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼Œå¦‚æœä½¿ç”¨<code>&lt;img&gt;</code>æ ‡ç­¾æ’å…¥ SVG æ–‡ä»¶ï¼Œå°±æ— æ³•è·å– SVG DOMã€‚</p><h4 id="è¯»å–-svg-æºç " tabindex="-1"><a class="header-anchor" href="#è¯»å–-svg-æºç " aria-hidden="true">#</a> è¯»å– SVG æºç </h4><p>ç”±äº SVG æ–‡ä»¶å°±æ˜¯ä¸€æ®µ XML æ–‡æœ¬ï¼Œå› æ­¤å¯ä»¥é€šè¿‡è¯»å– XML ä»£ç çš„æ–¹å¼ï¼Œè¯»å– SVG æºç ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>svg-container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span>
            <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2000/svg<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">xmlns:</span>xlink</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/1999/xlink<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">xml:</span>space</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>preserve<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>500<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>440<span class="token punctuation">&quot;</span></span>
    <span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- svg code --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨<code>XMLSerializer</code>å®ä¾‹çš„<code>serializeToString()</code>æ–¹æ³•ï¼Œè·å– SVG å…ƒç´ çš„ä»£ç ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> svgString <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">serializeToString</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;svg&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="svg-å›¾åƒè½¬ä¸º-canvas-å›¾åƒ" tabindex="-1"><a class="header-anchor" href="#svg-å›¾åƒè½¬ä¸º-canvas-å›¾åƒ" aria-hidden="true">#</a> SVG å›¾åƒè½¬ä¸º Canvas å›¾åƒ</h4><p>é¦–å…ˆï¼Œéœ€è¦æ–°å»ºä¸€ä¸ª<code>Image</code>å¯¹è±¡ï¼Œå°† SVG å›¾åƒæŒ‡å®šåˆ°è¯¥<code>Image</code>å¯¹è±¡çš„<code>src</code>å±æ€§ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> svg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>svgString<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;image/svg+xml;charset=utf-8&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> <span class="token constant">DOMURL</span> <span class="token operator">=</span> self<span class="token punctuation">.</span><span class="token constant">URL</span> <span class="token operator">||</span> self<span class="token punctuation">.</span>webkitURL <span class="token operator">||</span> self<span class="token punctuation">;</span>
<span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token constant">DOMURL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>svg<span class="token punctuation">)</span><span class="token punctuation">;</span>

img<span class="token punctuation">.</span>src <span class="token operator">=</span> url<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åï¼Œå½“å›¾åƒåŠ è½½å®Œæˆåï¼Œå†å°†å®ƒç»˜åˆ¶åˆ°<code>&lt;canvas&gt;</code>å…ƒç´ ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;canvas&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&#39;2d&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®ä¾‹-æŠ˜çº¿å›¾" tabindex="-1"><a class="header-anchor" href="#å®ä¾‹-æŠ˜çº¿å›¾" aria-hidden="true">#</a> å®ä¾‹ï¼šæŠ˜çº¿å›¾</h3><p>ä¸‹é¢å°†ä¸€å¼ æ•°æ®è¡¨æ ¼ç”»æˆæŠ˜çº¿å›¾ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>Date |Amount
-----|------
2014-01-01 | $10
2014-02-01 | $20
2014-03-01 | $40
2014-04-01 | $80
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„å›¾å½¢ï¼Œå¯ä»¥ç”»æˆä¸€ä¸ªåæ ‡ç³»ï¼Œ<code>Date</code>ä½œä¸ºæ¨ªè½´ï¼Œ<code>Amount</code>ä½œä¸ºçºµè½´ï¼Œå››è¡Œæ•°æ®ç”»æˆä¸€ä¸ªæ•°æ®ç‚¹ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>350<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>160<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>g</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>layer<span class="token punctuation">&quot;</span></span> <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>translate(60,10)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span>   <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>105<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>90<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>90<span class="token punctuation">&quot;</span></span>  <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>180<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>60<span class="token punctuation">&quot;</span></span>  <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>270<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span>   <span class="token punctuation">/&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>g</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>y axis<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>line</span> <span class="token attr-name">x1</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">y1</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">x2</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">y2</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>120<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>-40<span class="token punctuation">&quot;</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>105<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>$10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>-40<span class="token punctuation">&quot;</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span>   <span class="token attr-name">dy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>$80<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>g</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>g</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>x axis<span class="token punctuation">&quot;</span></span> <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>translate(0, 120)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>line</span> <span class="token attr-name">x1</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">y1</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">x2</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>270<span class="token punctuation">&quot;</span></span> <span class="token attr-name">y2</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>-30<span class="token punctuation">&quot;</span></span>   <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>20<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>January 2014<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>240<span class="token punctuation">&quot;</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>20<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>April<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>g</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>g</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å‚è€ƒé“¾æ¥-10" tabindex="-1"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥-10" aria-hidden="true">#</a> å‚è€ƒé“¾æ¥</h3><ul><li>Jon McPartland, <a href="http://bigbitecreative.com/introduction-svg-animation/" target="_blank" rel="noopener noreferrer">An introduction to SVG animation<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Alexander Goedde, <a href="http://tavendo.com/blog/post/super-vector-graphics/" target="_blank" rel="noopener noreferrer">SVG - Super Vector Graphics<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Joseph Wegner, <a href="http://flippinawesome.org/2014/02/03/learning-svg/" target="_blank" rel="noopener noreferrer">Learning SVG<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>biovisualize, <a href="http://bl.ocks.org/biovisualize/8187844" target="_blank" rel="noopener noreferrer">Direct svg to canvas to png conversion<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Tyler Sticka, <a href="https://cloudfour.com/thinks/cropping-image-thumbnails-with-svg/" target="_blank" rel="noopener noreferrer">Cropping Image Thumbnails with SVG<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Adi Purdila, <a href="https://webdesign.tutsplus.com/tutorials/how-to-create-a-loader-icon-with-svg-animations--cms-31542" target="_blank" rel="noopener noreferrer">How to Create a Loader Icon With SVG Animations<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h2 id="web-share-api" tabindex="-1"><a class="header-anchor" href="#web-share-api" aria-hidden="true">#</a> Web Share API</h2><h3 id="æ¦‚è¿°-2" tabindex="-1"><a class="header-anchor" href="#æ¦‚è¿°-2" aria-hidden="true">#</a> æ¦‚è¿°</h3><p>ç½‘é¡µå†…å®¹å¦‚æœè¦åˆ†äº«åˆ°å…¶ä»–åº”ç”¨ï¼Œé€šå¸¸è¦è‡ªå·±å®ç°åˆ†äº«æ¥å£ï¼Œé€ä¸€ç»™å‡ºç›®æ ‡åº”ç”¨çš„è¿æ¥æ–¹å¼ã€‚è¿™æ ·å¾ˆéº»çƒ¦ï¼Œä¹Ÿå¯¹ç½‘é¡µæ€§èƒ½æœ‰ä¸€å®šå½±å“ã€‚Web Share API å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è€Œæå‡ºçš„ï¼Œå…è®¸ç½‘é¡µè°ƒç”¨æ“ä½œç³»ç»Ÿçš„åˆ†äº«æ¥å£ï¼Œå®è´¨æ˜¯ Web App ä¸æœ¬æœºçš„åº”ç”¨ç¨‹åºäº¤æ¢ä¿¡æ¯çš„ä¸€ç§æ–¹å¼ã€‚</p><p>è¿™ä¸ª API ä¸ä»…å¯ä»¥æ”¹å–„ç½‘é¡µæ€§èƒ½ï¼Œè€Œä¸”ä¸é™åˆ¶åˆ†äº«ç›®æ ‡çš„æ•°é‡å’Œç±»å‹ã€‚ç¤¾äº¤åª’ä½“åº”ç”¨ã€ç”µå­é‚®ä»¶ã€å³æ—¶æ¶ˆæ¯ã€ä»¥åŠæœ¬åœ°ç³»ç»Ÿå®‰è£…çš„ã€ä¸”æ¥å—åˆ†äº«çš„åº”ç”¨ï¼Œéƒ½ä¼šå‡ºç°åœ¨ç³»ç»Ÿçš„åˆ†äº«å¼¹çª—ï¼Œè¿™å¯¹æ‰‹æœºç½‘é¡µå°¤å…¶æœ‰ç”¨ã€‚å¦å¤–ï¼Œä½¿ç”¨è¿™ä¸ªæ¥å£åªéœ€è¦ä¸€ä¸ªåˆ†äº«æŒ‰é’®ï¼Œè€Œä¼ ç»Ÿçš„ç½‘é¡µåˆ†äº«æœ‰å¤šä¸ªåˆ†äº«ç›®æ ‡ï¼Œå°±æœ‰å¤šå°‘ä¸ªåˆ†äº«æŒ‰é’®ã€‚</p><p>ç›®å‰ï¼Œæ¡Œé¢çš„ Safari æµè§ˆå™¨ï¼Œæ‰‹æœºçš„å®‰å“ Chrome æµè§ˆå™¨å’Œ iOS Safari æµè§ˆå™¨ï¼Œæ”¯æŒè¿™ä¸ª APIã€‚</p><p>è¿™ä¸ª API è¦æ±‚ç½‘ç«™å¿…é¡»å¯ç”¨ HTTPS åè®®ï¼Œä½†æ˜¯æœ¬åœ° Localhost å¼€å‘å¯ä»¥ä½¿ç”¨ HTTP åè®®ã€‚å¦å¤–ï¼Œè¿™ä¸ª API ä¸èƒ½ç›´æ¥è°ƒç”¨ï¼Œåªèƒ½ç”¨æ¥å“åº”ç”¨æˆ·çš„æ“ä½œï¼ˆæ¯”å¦‚<code>click</code>äº‹ä»¶ï¼‰ã€‚</p><h3 id="æ¥å£ç»†èŠ‚" tabindex="-1"><a class="header-anchor" href="#æ¥å£ç»†èŠ‚" aria-hidden="true">#</a> æ¥å£ç»†èŠ‚</h3><p>è¯¥æ¥å£éƒ¨ç½²åœ¨<code>navigator.share</code>ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æ£€æŸ¥æœ¬æœºæ˜¯å¦æ”¯æŒè¯¥æ¥å£ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>navigator<span class="token punctuation">.</span>share<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ”¯æŒ</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// ä¸æ”¯æŒ</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>navigator.share</code>æ˜¯ä¸€ä¸ªå‡½æ•°æ–¹æ³•ï¼Œæ¥å—ä¸€ä¸ªé…ç½®å¯¹è±¡ä½œä¸ºå‚æ•°ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>navigator<span class="token punctuation">.</span><span class="token function">share</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&#39;WebShare API Demo&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;https://codepen.io/ayoisaiah/pen/YbNazJ&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">&#39;æˆ‘æ­£åœ¨çœ‹ã€ŠWeb Share APIã€‹&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é…ç½®å¯¹è±¡æœ‰ä¸‰ä¸ªå±æ€§ï¼Œéƒ½æ˜¯å¯é€‰çš„ï¼Œä½†è‡³å°‘å¿…é¡»æŒ‡å®šä¸€ä¸ªã€‚</p><ul><li><code>title</code>ï¼šåˆ†äº«æ–‡æ¡£çš„æ ‡é¢˜ã€‚</li><li><code>url</code>ï¼šåˆ†äº«çš„ URLã€‚</li><li><code>text</code>ï¼šåˆ†äº«çš„å†…å®¹ã€‚</li></ul><p>ä¸€èˆ¬æ¥è¯´ï¼Œ<code>url</code>æ˜¯å½“å‰ç½‘é¡µçš„ç½‘å€ï¼Œ<code>title</code>æ˜¯å½“å‰ç½‘é¡µçš„æ ‡é¢˜ï¼Œå¯ä»¥é‡‡ç”¨ä¸‹é¢çš„å†™æ³•è·å–ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> title <span class="token operator">=</span> document<span class="token punctuation">.</span>title<span class="token punctuation">;</span>
<span class="token keyword">const</span> url <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;link[rel=canonical]&#39;</span><span class="token punctuation">)</span> <span class="token operator">?</span>
    document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;link[rel=canonical]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>href <span class="token operator">:</span>
    document<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>navigator.share</code>çš„è¿”å›å€¼æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ã€‚è¿™ä¸ªæ–¹æ³•è°ƒç”¨ä¹‹åï¼Œä¼šç«‹åˆ»å¼¹å‡ºç³»ç»Ÿçš„åˆ†äº«å¼¹çª—ï¼Œç”¨æˆ·æ“ä½œå®Œæ¯•ä¹‹åï¼ŒPromise å¯¹è±¡å°±ä¼šå˜ä¸º<code>resolved</code>çŠ¶æ€ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>navigator<span class="token punctuation">.</span><span class="token function">share</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&#39;WebShare API Demo&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;https://codepen.io/ayoisaiah/pen/YbNazJ&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Thanks for sharing!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;Sharing error&#39;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç”±äºè¿”å›å€¼æ˜¯ Promise å¯¹è±¡ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ä½¿ç”¨<code>await</code>å‘½ä»¤ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>shareButton<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">await</span> navigator<span class="token punctuation">.</span><span class="token function">share</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&#39;Example Page&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Data was shared successfully&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;Share failed:&#39;</span><span class="token punctuation">,</span> err<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="åˆ†äº«æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#åˆ†äº«æ–‡ä»¶" aria-hidden="true">#</a> åˆ†äº«æ–‡ä»¶</h3><p>è¿™ä¸ª API è¿˜å¯ä»¥åˆ†äº«æ–‡ä»¶ï¼Œå…ˆä½¿ç”¨<code>navigator.canShare()</code>æ–¹æ³•ï¼Œåˆ¤æ–­ä¸€ä¸‹ç›®æ ‡æ–‡ä»¶æ˜¯å¦å¯ä»¥åˆ†äº«ã€‚å› ä¸ºä¸æ˜¯æ‰€æœ‰æ–‡ä»¶éƒ½å…è®¸åˆ†äº«çš„ï¼Œç›®å‰å›¾åƒï¼Œè§†é¢‘ï¼ŒéŸ³é¢‘å’Œæ–‡æœ¬æ–‡ä»¶å¯ä»¥åˆ†äº«2ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>navigator<span class="token punctuation">.</span>canShare <span class="token operator">&amp;&amp;</span> navigator<span class="token punctuation">.</span><span class="token function">canShare</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">files</span><span class="token operator">:</span> filesArray <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>navigator.canShare()</code>æ–¹æ³•çš„å‚æ•°å¯¹è±¡ï¼Œå°±æ˜¯<code>navigator.share()</code>æ–¹æ³•çš„å‚æ•°å¯¹è±¡ã€‚è¿™é‡Œçš„å…³é”®æ˜¯<code>files</code>å±æ€§ï¼Œå®ƒçš„å€¼æ˜¯ä¸€ä¸ª<code>FileList</code>å®ä¾‹å¯¹è±¡ã€‚</p><p><code>navigator.canShare()</code>æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå¦‚æœä¸º<code>true</code>ï¼Œå°±å¯ä»¥ä½¿ç”¨<code>navigator.share()</code>æ–¹æ³•åˆ†äº«æ–‡ä»¶äº†ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>navigator<span class="token punctuation">.</span>canShare <span class="token operator">&amp;&amp;</span> navigator<span class="token punctuation">.</span><span class="token function">canShare</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">files</span><span class="token operator">:</span> filesArray <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    navigator<span class="token punctuation">.</span><span class="token function">share</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">files</span><span class="token operator">:</span> filesArray<span class="token punctuation">,</span>
        <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&#39;Vacation Pictures&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">&#39;Photos from September 27 to October 14.&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Share was successful.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Sharing failed&#39;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å‚è€ƒé“¾æ¥-11" tabindex="-1"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥-11" aria-hidden="true">#</a> å‚è€ƒé“¾æ¥</h3><ul><li><a href="https://css-tricks.com/how-to-use-the-web-share-api/" target="_blank" rel="noopener noreferrer">How to Use the Web Share API<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, Ayooluwa Isaiah</li><li><a href="https://wicg.github.io/web-share/" target="_blank" rel="noopener noreferrer">Web Share API - Level 1<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, W3C</li><li><a href="https://developers.google.com/web/updates/2016/09/navigator-share" target="_blank" rel="noopener noreferrer">Introducing the Web Share API<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, Paul Kinlan, Sam Thorogood</li><li><a href="https://web.dev/web-share/" target="_blank" rel="noopener noreferrer">Share like a native app with the Web Share API<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, Joe Medley</li></ul><h2 id="web-audio-api" tabindex="-1"><a class="header-anchor" href="#web-audio-api" aria-hidden="true">#</a> Web Audio API</h2><p>Web Audio API ç”¨äºæ“ä½œå£°éŸ³ã€‚è¿™ä¸ª API å¯ä»¥è®©ç½‘é¡µå‘å‡ºå£°éŸ³ã€‚</p><h3 id="åŸºæœ¬ç”¨æ³•-2" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ç”¨æ³•-2" aria-hidden="true">#</a> åŸºæœ¬ç”¨æ³•</h3><p>æµè§ˆå™¨åŸç”Ÿæä¾›<code>AudioContext</code>å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ç”¨äºç”Ÿæˆä¸€ä¸ªå£°éŸ³çš„ä¸Šä¸‹æ–‡ï¼Œä¸æ‰¬å£°å™¨ç›¸è¿ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> audioContext <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AudioContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ç„¶åï¼Œè·å–éŸ³æºæ–‡ä»¶ï¼Œå°†å…¶åœ¨å†…å­˜ä¸­è§£ç ï¼Œå°±å¯ä»¥æ’­æ”¾å£°éŸ³äº†ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AudioContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;sound.mp4&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> response<span class="token punctuation">.</span><span class="token function">arrayBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">arrayBuffer</span> <span class="token operator">=&gt;</span> context<span class="token punctuation">.</span><span class="token function">decodeAudioData</span><span class="token punctuation">(</span>arrayBuffer<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">audioBuffer</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ’­æ”¾å£°éŸ³</span>
        <span class="token keyword">const</span> source <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">createBufferSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        source<span class="token punctuation">.</span>buffer <span class="token operator">=</span> audioBuffer<span class="token punctuation">;</span>
        source<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>destination<span class="token punctuation">)</span><span class="token punctuation">;</span>
        source<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="context-createbuffer" tabindex="-1"><a class="header-anchor" href="#context-createbuffer" aria-hidden="true">#</a> context.createBuffer()</h3><p><code>context.createBuffer()</code>æ–¹æ³•ç”Ÿæˆä¸€ä¸ªå†…å­˜çš„æ“ä½œè§†å›¾ï¼Œç”¨äºå­˜æ”¾æ•°æ®ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> buffer <span class="token operator">=</span> audioContext<span class="token punctuation">.</span><span class="token function">createBuffer</span><span class="token punctuation">(</span>channels<span class="token punctuation">,</span> signalLength<span class="token punctuation">,</span> sampleRate<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>createBuffer</code>æ–¹æ³•æ¥å—ä¸‰ä¸ªå‚æ•°ã€‚</p><ul><li>channelsï¼šæ•´æ•°ï¼Œè¡¨ç¤ºå£°é“ã€‚åˆ›å»ºå•å£°é“çš„å£°éŸ³ï¼Œè¯¥å€¼ä¸º 1ã€‚</li><li>signalLengthï¼šæ•´æ•°ï¼Œè¡¨ç¤ºå£°éŸ³æ•°ç»„çš„é•¿åº¦ã€‚</li><li>sampleRateï¼šæµ®ç‚¹æ•°ï¼Œè¡¨ç¤ºå–æ ·ç‡ï¼Œå³ä¸€ç§’å–æ ·å¤šå°‘æ¬¡ã€‚</li></ul><p><code>signalLength</code>å’Œ<code>sampleRate</code>è¿™ä¸¤ä¸ªå‚æ•°å†³å®šäº†å£°éŸ³çš„é•¿åº¦ã€‚æ¯”å¦‚ï¼Œå¦‚æœå–æ ·ç‡æ˜¯<code>1/3000</code>ï¼ˆæ¯ç§’å–æ ·3000æ¬¡ï¼‰ï¼Œå£°éŸ³æ•°ç»„é•¿åº¦æ˜¯6000ï¼Œé‚£ä¹ˆæ’­æ”¾çš„å£°éŸ³æ˜¯2ç§’é•¿åº¦ã€‚</p><p>æ¥ç€ï¼Œä½¿ç”¨<code>buffer.getChannelData</code>æ–¹æ³•å–å‡ºä¸€ä¸ªå£°é“ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> data <span class="token operator">=</span> buffer<span class="token punctuation">.</span><span class="token function">getChannelData</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>buffer.getChannelData</code>çš„å‚æ•°<code>0</code>è¡¨ç¤ºå–å‡ºç¬¬ä¸€ä¸ªå£°é“ã€‚</p><p>ä¸‹ä¸€æ­¥ï¼Œå°†å£°éŸ³æ•°ç»„æ”¾å…¥è¿™ä¸ªå£°é“ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> data <span class="token operator">=</span> buffer<span class="token punctuation">.</span><span class="token function">getChannelData</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment">// singal æ˜¯ä¸€ä¸ªå£°éŸ³æ•°ç»„</span>
<span class="token comment">// singalLengal æ˜¯è¯¥æ•°ç»„çš„é•¿åº¦</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> signalLength<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> signal<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æœ€åï¼Œä½¿ç”¨<code>context.createBufferSource</code>æ–¹æ³•ç”Ÿæˆä¸€ä¸ªå£°éŸ³èŠ‚ç‚¹ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// ç”Ÿæˆä¸€ä¸ªå£°éŸ³èŠ‚ç‚¹</span>
<span class="token keyword">const</span> node <span class="token operator">=</span> audioContext<span class="token punctuation">.</span><span class="token function">createBufferSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// å°†å£°éŸ³æ•°ç»„çš„å†…å­˜å¯¹è±¡ï¼Œæ”¾å…¥è¿™ä¸ªèŠ‚ç‚¹</span>
node<span class="token punctuation">.</span>buffer <span class="token operator">=</span> buffer<span class="token punctuation">;</span>
<span class="token comment">// å°†å£°éŸ³ä¸Šä¸‹æ–‡ä¸èŠ‚ç‚¹è¿æ¥</span>
node<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>audioContext<span class="token punctuation">.</span>destination<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// å¼€å§‹æ’­æ”¾å£°éŸ³</span>
node<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span>audioContext<span class="token punctuation">.</span>currentTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ’­æ”¾ä¸€æ¬¡åå°±å°†åœæ­¢æ’­æ”¾ã€‚å¦‚æœéœ€è¦å¾ªç¯æ’­æ”¾ï¼Œå¯ä»¥å°†èŠ‚ç‚¹å¯¹è±¡çš„<code>looping</code>å±æ€§è®¾ä¸º<code>true</code>ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>node<span class="token punctuation">.</span>looping <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="è¿‡æ»¤å™¨" tabindex="-1"><a class="header-anchor" href="#è¿‡æ»¤å™¨" aria-hidden="true">#</a> è¿‡æ»¤å™¨</h3><p>Web Audio API åŸç”Ÿæä¾›äº†ä¸€äº›è¿‡æ»¤å™¨ï¼ˆfilterï¼‰ï¼Œç”¨æ¥å¤„ç†å£°éŸ³ã€‚</p><p>é¦–å…ˆï¼Œä½¿ç”¨<code>context.createBiquadFilter</code>æ–¹æ³•å»ºç«‹è¿‡æ»¤å™¨å®ä¾‹ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> filter <span class="token operator">=</span> audioContext<span class="token punctuation">.</span><span class="token function">createBiquadFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ç„¶åï¼Œé€šè¿‡<code>filter.type</code>å±æ€§æŒ‡å®šè¿‡æ»¤å™¨çš„ç±»å‹ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>filter<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">&#39;lowpass&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ç›®å‰ï¼Œè¿‡æ»¤å™¨æœ‰ä»¥ä¸‹è¿™äº›ç±»å‹ã€‚</p><ul><li>lowpass</li><li>highpass</li><li>bandpass</li><li>lowshelf</li><li>highshelf</li><li>peaking</li><li>notch</li><li>allpass</li></ul><p>ç„¶åæŒ‡å®šè¿‡æ»¤å™¨çš„é¢‘ç‡ï¼ˆfrequencyï¼‰å±æ€§ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>filter<span class="token punctuation">.</span>frequency<span class="token punctuation">.</span>value <span class="token operator">=</span> frequency
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æœ€åï¼Œè¿‡æ»¤å™¨å®ä¾‹è¿æ¥èŠ‚ç‚¹å®ä¾‹ï¼Œå°±å¯ä»¥ç”Ÿæ•ˆäº†ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>sourceNode<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>filter<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="web-components" tabindex="-1"><a class="header-anchor" href="#web-components" aria-hidden="true">#</a> Web Components</h2><h3 id="æ¦‚è¿°-3" tabindex="-1"><a class="header-anchor" href="#æ¦‚è¿°-3" aria-hidden="true">#</a> æ¦‚è¿°</h3><p>å„ç§ç½‘ç«™å¾€å¾€éœ€è¦ä¸€äº›ç›¸åŒçš„æ¨¡å—ï¼Œæ¯”å¦‚æ—¥å†ã€è°ƒè‰²æ¿ç­‰ç­‰ï¼Œè¿™ç§æ¨¡å—å°±è¢«ç§°ä¸ºâ€œç»„ä»¶â€ï¼ˆcomponentï¼‰ã€‚Web Components å°±æ˜¯æµè§ˆå™¨åŸç”Ÿçš„ç»„ä»¶è§„èŒƒã€‚</p><p>é‡‡ç”¨ç»„ä»¶å¼€å‘ï¼Œæœ‰å¾ˆå¤šä¼˜ç‚¹ã€‚</p><p>ï¼ˆ1ï¼‰æœ‰åˆ©äºä»£ç å¤ç”¨ã€‚ç»„ä»¶æ˜¯æ¨¡å—åŒ–ç¼–ç¨‹æ€æƒ³çš„ä½“ç°ï¼Œå¯ä»¥è·¨å¹³å°ã€è·¨æ¡†æ¶ä½¿ç”¨ï¼Œæ„å»ºã€éƒ¨ç½²å’Œä¸å…¶ä»– UI å…ƒç´ äº’åŠ¨éƒ½æœ‰ç»Ÿä¸€åšæ³•ã€‚</p><p>ï¼ˆ2ï¼‰ä½¿ç”¨éå¸¸å®¹æ˜“ã€‚åŠ è½½æˆ–å¸è½½ç»„ä»¶ï¼Œåªè¦æ·»åŠ æˆ–åˆ é™¤ä¸€è¡Œä»£ç å°±å¯ä»¥äº†ã€‚</p><p>ï¼ˆ3ï¼‰å¼€å‘å’Œå®šåˆ¶å¾ˆæ–¹ä¾¿ã€‚ç»„ä»¶å¼€å‘ä¸éœ€è¦ä½¿ç”¨æ¡†æ¶ï¼Œåªè¦ç”¨åŸç”Ÿçš„è¯­æ³•å°±å¯ä»¥äº†ã€‚å¼€å‘å¥½çš„ç»„ä»¶å¾€å¾€ç•™å‡ºæ¥å£ï¼Œä¾›ä½¿ç”¨è€…è®¾ç½®å¸¸è§å±æ€§ï¼Œæ¯”å¦‚ä¸Šé¢ä»£ç çš„<code>heading</code>å±æ€§ï¼Œå°±æ˜¯ç”¨æ¥è®¾ç½®å¯¹è¯æ¡†çš„æ ‡é¢˜ã€‚</p><p>ï¼ˆ4ï¼‰ç»„ä»¶æä¾›äº† HTMLã€CSSã€JavaScript å°è£…çš„æ–¹æ³•ï¼Œå®ç°äº†ä¸åŒä¸€é¡µé¢ä¸Šå…¶ä»–ä»£ç çš„éš”ç¦»ã€‚</p><p>æœªæ¥çš„ç½‘ç«™å¼€å‘ï¼Œå¯ä»¥åƒæ­ç§¯æœ¨ä¸€æ ·ï¼ŒæŠŠç»„ä»¶åˆåœ¨ä¸€èµ·ï¼Œå°±ç»„æˆäº†ä¸€ä¸ªç½‘ç«™ã€‚è¿™ç§å‰æ™¯æ˜¯éå¸¸è¯±äººçš„ã€‚</p><p>Web Components ä¸æ˜¯å•ä¸€çš„è§„èŒƒï¼Œè€Œæ˜¯ä¸€ç³»åˆ—çš„æŠ€æœ¯ç»„æˆï¼Œä»¥ä¸‹æ˜¯å®ƒçš„å››ä¸ªæ„æˆã€‚</p><ul><li>Custom Elements</li><li>Template</li><li>Shadow DOM</li><li>HTML Import</li></ul><p>ä½¿ç”¨æ—¶ï¼Œå¹¶ä¸ä¸€å®šä¸Šé¢å››ç§ API éƒ½è¦ç”¨åˆ°ã€‚å…¶ä¸­ï¼ŒCustom Element å’Œ Shadow DOM æ¯”è¾ƒé‡è¦ï¼ŒTemplate å’Œ HTML Import åªèµ·åˆ°è¾…åŠ©ä½œç”¨ã€‚</p><h3 id="custom-element" tabindex="-1"><a class="header-anchor" href="#custom-element" aria-hidden="true">#</a> Custom Element</h3><h4 id="ç®€ä»‹-4" tabindex="-1"><a class="header-anchor" href="#ç®€ä»‹-4" aria-hidden="true">#</a> ç®€ä»‹</h4><p>HTML æ ‡å‡†å®šä¹‰çš„ç½‘é¡µå…ƒç´ ï¼Œæœ‰æ—¶å¹¶ä¸ç¬¦åˆæˆ‘ä»¬çš„éœ€è¦ï¼Œè¿™æ—¶æµè§ˆå™¨å…è®¸ç”¨æˆ·è‡ªå®šä¹‰ç½‘é¡µå…ƒç´ ï¼Œè¿™å°±å«åš Custom Elementã€‚ç®€å•è¯´ï¼Œå®ƒå°±æ˜¯ç”¨æˆ·è‡ªå®šä¹‰çš„ç½‘é¡µå…ƒç´ ï¼Œæ˜¯ Web components æŠ€æœ¯çš„æ ¸å¿ƒã€‚</p><p>ä¸¾ä¾‹æ¥è¯´ï¼Œä½ å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªå«åš<code>&lt;my-element&gt;</code>çš„ç½‘é¡µå…ƒç´ ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-element</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-element</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ³¨æ„ï¼Œè‡ªå®šä¹‰ç½‘é¡µå…ƒç´ çš„æ ‡ç­¾åå¿…é¡»å«æœ‰è¿å­—ç¬¦<code>-</code>ï¼Œä¸€ä¸ªæˆ–å¤šä¸ªè¿å­—ç¬¦éƒ½å¯ä»¥ã€‚è¿™æ˜¯å› ä¸ºæµè§ˆå™¨å†…ç½®çš„çš„ HTML å…ƒç´ æ ‡ç­¾åï¼Œéƒ½ä¸å«æœ‰è¿å­—ç¬¦ï¼Œè¿™æ ·å¯ä»¥åšåˆ°æœ‰æ•ˆåŒºåˆ†ã€‚</p><p>ä¸‹é¢çš„ä»£ç å…ˆå®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰å…ƒç´ çš„ç±»ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MyElement</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLElement</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">attachShadow</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;open&#39;</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>shadowRoot<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
      &lt;style&gt;
        /* scoped styles */
      &lt;/style&gt;
      &lt;slot&gt;&lt;/slot&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token function">observedAttributes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Return list of attributes to watch.</span>
    <span class="token punctuation">}</span>

    <span class="token function">attributeChangedCallback</span><span class="token punctuation">(</span> <span class="token parameter">name<span class="token punctuation">,</span> oldValue<span class="token punctuation">,</span> newValue</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Run functionality when one of these attributes is changed.</span>
    <span class="token punctuation">}</span>

    <span class="token function">connectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Run functionality when an instance of this element is inserted into the DOM.</span>
    <span class="token punctuation">}</span>

    <span class="token function">disconnectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Run functionality when an instance of this element is removed from the DOM.</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç æœ‰å‡ ä¸ªæ³¨æ„ç‚¹ã€‚</p><ul><li>è‡ªå®šä¹‰å…ƒç´ ç±»çš„åŸºç±»æ˜¯<code>HTMLElement</code>ã€‚å½“ç„¶ä¹Ÿå¯ä»¥æ ¹æ®éœ€è¦ï¼ŒåŸºäº<code>HTMLElement</code>çš„å­ç±»ï¼Œæ¯”å¦‚<code>HTMLButtonElement</code>ã€‚</li><li>æ„é€ å‡½æ•°å†…éƒ¨å®šä¹‰äº† Shadow DOMã€‚æ‰€è°“<code>Shadow DOM</code>æŒ‡çš„æ˜¯ï¼Œè¿™éƒ¨åˆ†çš„ HTML ä»£ç å’Œæ ·å¼ï¼Œä¸ç›´æ¥æš´éœ²ç»™ç”¨æˆ·ã€‚</li><li>ç±»å¯ä»¥å®šä¹‰ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œæ¯”å¦‚<code>connectedCallback()</code>ã€‚</li></ul><p>ç„¶åï¼Œ<code>window.customElements.define()</code>æ–¹æ³•ï¼Œç”¨æ¥ç™»è®°è‡ªå®šä¹‰å…ƒç´ ä¸è¿™ä¸ªç±»ä¹‹é—´çš„æ˜ å°„ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>window<span class="token punctuation">.</span>customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">&#39;my-element&#39;</span><span class="token punctuation">,</span> MyElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ç™»è®°ä»¥åï¼Œé¡µé¢ä¸Šçš„æ¯ä¸€ä¸ª<code>&lt;my-element&gt;</code>å…ƒç´ éƒ½æ˜¯ä¸€ä¸ª<code>MyElement</code>ç±»çš„å®ä¾‹ã€‚åªè¦æµè§ˆå™¨è§£æåˆ°<code>&lt;my-element&gt;</code>å…ƒç´ ï¼Œå°±ä¼šè¿è¡Œ<code>MyElement</code>çš„æ„é€ å‡½æ•°ã€‚</p><p>æ³¨æ„ï¼Œå¦‚æœæ²¡æœ‰ç™»è®°å°±ä½¿ç”¨ Custom Elementï¼Œæµè§ˆå™¨ä¼šè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªä¸è®¤è¯†çš„å…ƒç´ ï¼Œä¼šå½“åšç©ºçš„ div å…ƒç´ å¤„ç†ã€‚</p><p><code>window.customElements.define()</code>æ–¹æ³•å®šä¹‰äº† Custom Element ä»¥åï¼Œå¯ä»¥ä½¿ç”¨<code>window.customeElements.get()</code>æ–¹æ³•è·å–è¯¥å…ƒç´ çš„æ„é€ æ–¹æ³•ã€‚è¿™ä½¿å¾—é™¤äº†ç›´æ¥æ’å…¥ HTML ç½‘é¡µï¼ŒCustom Element ä¹Ÿèƒ½ä½¿ç”¨è„šæœ¬æ’å…¥ç½‘é¡µã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>window<span class="token punctuation">.</span>customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span>
    <span class="token string">&#39;my-element&#39;</span><span class="token punctuation">,</span>
    <span class="token keyword">class</span> <span class="token class-name">extends</span> HTMLElement <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> el <span class="token operator">=</span> window<span class="token punctuation">.</span>customElements<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;my-element&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> myElement <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">el</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>myElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœä½ æƒ³æ‰©å±•ç°æœ‰çš„ HTML å…ƒç´ ï¼ˆæ¯”å¦‚<code>&lt;button&gt;</code>ï¼‰ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">GreetingElement</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLButtonElement</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ç™»è®°çš„æ—¶å€™ï¼Œéœ€è¦æä¾›æ‰©å±•çš„å…ƒç´ ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">&#39;hey-there&#39;</span><span class="token punctuation">,</span> GreetingElement<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token string">&#39;button&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä½¿ç”¨çš„æ—¶å€™ï¼Œä¸ºå…ƒç´ åŠ ä¸Š<code>is</code>å±æ€§å°±å¯ä»¥äº†ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hey-there<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>World<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Howdy<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="ç”Ÿå‘½å‘¨æœŸæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#ç”Ÿå‘½å‘¨æœŸæ–¹æ³•" aria-hidden="true">#</a> ç”Ÿå‘½å‘¨æœŸæ–¹æ³•</h4><p>Custom Element æä¾›ä¸€äº›ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MyElement</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLElement</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">connectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// here the element has been inserted into the DOM</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>connectedCallback()</code>æ–¹æ³•å°±æ˜¯<code>MyElement</code>å…ƒç´ çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚æ¯æ¬¡ï¼Œè¯¥å…ƒç´ æ’å…¥ DOMï¼Œå°±ä¼šè‡ªåŠ¨æ‰§è¡Œè¯¥æ–¹æ³•ã€‚</p><ul><li><code>connectedCallback()</code>ï¼šæ’å…¥ DOM æ—¶è°ƒç”¨ã€‚è¿™å¯èƒ½ä¸æ­¢ä¸€æ¬¡å‘ç”Ÿï¼Œæ¯”å¦‚å…ƒç´ è¢«ç§»é™¤ååˆé‡æ–°æ·»åŠ ã€‚ç±»çš„è®¾ç½®åº”è¯¥å°½é‡æ”¾åˆ°è¿™ä¸ªæ–¹æ³•é‡Œé¢æ‰§è¡Œï¼Œå› ä¸ºè¿™æ—¶å„ç§å±æ€§å’Œå­å…ƒç´ éƒ½å¯ç”¨ã€‚</li><li><code>disconnectedCallback()</code>ï¼šç§»å‡º DOM æ—¶æ‰§è¡Œã€‚</li><li><code>attributeChangedCallback(attrName, oldVal, newVal)</code>ï¼šæ·»åŠ ã€åˆ é™¤ã€æ›´æ–°æˆ–æ›¿æ¢å±æ€§æ—¶è°ƒç”¨ã€‚å…ƒç´ åˆ›å»ºæˆ–å‡çº§æ—¶ï¼Œä¹Ÿä¼šè°ƒç”¨ã€‚æ³¨æ„ï¼šåªæœ‰åŠ å…¥<code>observedAttributes</code>çš„å±æ€§æ‰ä¼šæ‰§è¡Œè¿™ä¸ªæ–¹æ³•ã€‚</li><li><code>adoptedCallback()</code>ï¼šè‡ªå®šä¹‰å…ƒç´ ç§»åŠ¨åˆ°æ–°çš„ document æ—¶è°ƒç”¨ï¼Œæ¯”å¦‚æ‰§è¡Œ<code>document.adoptNode(element)</code>æ—¶ã€‚</li></ul><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">GreetingElement</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLElement</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_name <span class="token operator">=</span> <span class="token string">&#39;Stranger&#39;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">connectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>_name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">attributeChangedCallback</span><span class="token punctuation">(</span><span class="token parameter">attrName<span class="token punctuation">,</span> oldValue<span class="token punctuation">,</span> newValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>attrName <span class="token operator">===</span> <span class="token string">&#39;name&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>newValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_name <span class="token operator">=</span> newValue<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>_name <span class="token operator">=</span> <span class="token string">&#39;Stranger&#39;</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
GreetingElement<span class="token punctuation">.</span>observedAttributes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">&#39;hey-there&#39;</span><span class="token punctuation">,</span> GreetingElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>GreetingElement.observedAttributes</code>å±æ€§ç”¨æ¥æŒ‡å®šç™½åå•é‡Œé¢çš„å±æ€§ï¼Œä¸Šä¾‹æ˜¯<code>name</code>å±æ€§ã€‚åªè¦è¿™ä¸ªå±æ€§çš„å€¼å‘ç”Ÿå˜åŒ–ï¼Œå°±ä¼šè‡ªåŠ¨è°ƒç”¨<code>attributeChangedCallback</code>æ–¹æ³•ã€‚</p><p>ä½¿ç”¨ä¸Šé¢è¿™ä¸ªç±»çš„æ–¹æ³•å¦‚ä¸‹ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hey-there</span><span class="token punctuation">&gt;</span></span>Greeting<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>hey-there</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hey-there</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Potch<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Personalized Greeting<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>hey-there</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><code>attributeChangedCallback</code>æ–¹æ³•ä¸»è¦ç”¨äºå¤–éƒ¨ä¼ å…¥çš„å±æ€§ï¼Œå°±åƒä¸Šé¢ä¾‹å­ä¸­<code>name=&quot;Potch&quot;</code>ã€‚</p><p>ç”Ÿå‘½å‘¨æœŸæ–¹æ³•è°ƒç”¨çš„é¡ºåºå¦‚ä¸‹ï¼š<code>constructor</code> -&gt; <code>attributeChangedCallback</code> -&gt; <code>connectedCallback</code>ï¼Œå³<code>attributeChangedCallback</code>æ—©äº<code>connectedCallback</code>æ‰§è¡Œã€‚è¿™æ˜¯å› ä¸º<code>attributeChangedCallback</code>ç›¸å½“äºè°ƒæ•´é…ç½®ï¼Œåº”è¯¥åœ¨æ’å…¥ DOM ä¹‹å‰å®Œæˆã€‚</p><p>ä¸‹é¢çš„ä¾‹å­èƒ½å¤Ÿæ›´æ˜æ˜¾åœ°çœ‹å‡ºè¿™ä¸€ç‚¹ï¼Œåœ¨æ’å…¥ DOM å‰ä¿®æ”¹ Custome Element çš„é¢œè‰²ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MyElement</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLElement</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>container <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>shadowRoot<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;##container&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">attributeChangedCallback</span><span class="token punctuation">(</span><span class="token parameter">attr<span class="token punctuation">,</span> oldVal<span class="token punctuation">,</span> newVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>attr <span class="token operator">===</span> <span class="token string">&#39;disabled&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">hasAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;disabled&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>container<span class="token punctuation">.</span>style<span class="token punctuation">.</span>background <span class="token operator">=</span> <span class="token string">&#39;##808080&#39;</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>container<span class="token punctuation">.</span>style<span class="token punctuation">.</span>background <span class="token operator">=</span> <span class="token string">&#39;##ffffff&#39;</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="è‡ªå®šä¹‰å±æ€§å’Œæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰å±æ€§å’Œæ–¹æ³•" aria-hidden="true">#</a> è‡ªå®šä¹‰å±æ€§å’Œæ–¹æ³•</h4><p>Custom Element å…è®¸è‡ªå®šä¹‰å±æ€§æˆ–æ–¹æ³•ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MyElement</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLElement</span> <span class="token punctuation">{</span>
<span class="token operator">...</span>

    <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// do something in this method</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>doSomething()</code>å°±æ˜¯<code>MyElement</code>çš„è‡ªå®šä¹‰æ–¹æ³•ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;my-element&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
element<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>è‡ªå®šä¹‰å±æ€§å¯ä»¥ä½¿ç”¨ JavaScript class çš„æ‰€æœ‰è¯­æ³•ï¼Œå› æ­¤ä¹Ÿå¯ä»¥è®¾ç½®å–å€¼å™¨å’Œèµ‹å€¼å™¨ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MyElement</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLElement</span> <span class="token punctuation">{</span>
<span class="token operator">...</span>

    <span class="token keyword">set</span> <span class="token function">disabled</span><span class="token punctuation">(</span><span class="token parameter">isDisabled</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>isDisabled<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;disabled&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">removeAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;disabled&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">get</span> <span class="token function">disabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">hasAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;disabled&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­çš„å–å€¼å™¨å’Œèµ‹å€¼å™¨ï¼Œå¯ç”¨äº<code>&lt;my-input name=&quot;name&quot; disabled&gt;</code>è¿™æ ·çš„ç”¨æ³•ã€‚</p><h4 id="window-customelements-whendefined" tabindex="-1"><a class="header-anchor" href="#window-customelements-whendefined" aria-hidden="true">#</a> window.customElements.whenDefined()</h4><p><code>window.customElements.whenDefined()</code>æ–¹æ³•åœ¨ä¸€ä¸ª Custom Element è¢«<code>customElements.define()</code>æ–¹æ³•å®šä¹‰ä»¥åæ‰§è¡Œï¼Œç”¨äºâ€œå‡çº§â€ä¸€ä¸ªå…ƒç´ ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>window<span class="token punctuation">.</span>customElements<span class="token punctuation">.</span><span class="token function">whenDefined</span><span class="token punctuation">(</span><span class="token string">&#39;my-element&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// my-element is now defined</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœæŸä¸ªå±æ€§å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œéœ€è¦åšå‡ºååº”ï¼Œå¯ä»¥å°†å®ƒæ”¾å…¥<code>observedAttributes</code>æ•°ç»„ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MyElement</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLElement</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token function">observedAttributes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">&#39;disabled&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> shadowRoot <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">attachShadow</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;open&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        shadowRoot<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
      &lt;style&gt;
        .disabled {
          opacity: 0.4;
        }
      &lt;/style&gt;

      &lt;div id=&quot;container&quot;&gt;&lt;/div&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>container <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">shadowRoot</span><span class="token punctuation">(</span><span class="token string">&#39;##container&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">attributeChangedCallback</span><span class="token punctuation">(</span><span class="token parameter">attr<span class="token punctuation">,</span> oldVal<span class="token punctuation">,</span> newVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>attr <span class="token operator">===</span> <span class="token string">&#39;disabled&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>disabled<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>container<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&#39;disabled&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>container<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">&#39;disabled&#39;</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å›è°ƒå‡½æ•°" tabindex="-1"><a class="header-anchor" href="#å›è°ƒå‡½æ•°" aria-hidden="true">#</a> å›è°ƒå‡½æ•°</h4><p>è‡ªå®šä¹‰å…ƒç´ çš„åŸå‹æœ‰ä¸€äº›å±æ€§ï¼Œç”¨æ¥æŒ‡å®šå›è°ƒå‡½æ•°ï¼Œåœ¨ç‰¹å®šäº‹ä»¶å‘ç”Ÿæ—¶è§¦å‘ã€‚</p><ul><li><strong>createdCallback</strong>ï¼šå®ä¾‹ç”Ÿæˆæ—¶è§¦å‘</li><li><strong>attachedCallback</strong>ï¼šå®ä¾‹æ’å…¥HTMLæ–‡æ¡£æ—¶è§¦å‘</li><li><strong>detachedCallback</strong>ï¼šå®ä¾‹ä»HTMLæ–‡æ¡£ç§»é™¤æ—¶è§¦å‘</li><li><strong>attributeChangedCallback(attrName, oldVal, newVal)</strong>ï¼šå®ä¾‹çš„å±æ€§å‘ç”Ÿæ”¹å˜æ—¶ï¼ˆæ·»åŠ ã€ç§»é™¤ã€æ›´æ–°ï¼‰è§¦å‘</li></ul><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> proto <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">HTMLElement</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>

proto<span class="token punctuation">.</span><span class="token function-variable function">createdCallback</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;created&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&#39;This is a my-demo element!&#39;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

proto<span class="token punctuation">.</span><span class="token function-variable function">attachedCallback</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;attached&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> XFoo <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">registerElement</span><span class="token punctuation">(</span><span class="token string">&#39;x-foo&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">prototype</span><span class="token operator">:</span> proto<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ©ç”¨å›è°ƒå‡½æ•°ï¼Œå¯ä»¥æ–¹ä¾¿åœ°åœ¨è‡ªå®šä¹‰å…ƒç´ ä¸­æ’å…¥HTMLè¯­å¥ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> XFooProto <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">HTMLElement</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>

XFooProto<span class="token punctuation">.</span><span class="token function-variable function">createdCallback</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&quot;&lt;b&gt;I&#39;m an x-foo-with-markup!&lt;/b&gt;&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> XFoo <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">registerElement</span><span class="token punctuation">(</span><span class="token string">&#39;x-foo-with-markup&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token literal-property property">prototype</span><span class="token operator">:</span> XFooProto<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç å®šä¹‰äº†createdCallbackå›è°ƒå‡½æ•°ï¼Œç”Ÿæˆå®ä¾‹æ—¶ï¼Œè¯¥å‡½æ•°è¿è¡Œï¼Œæ’å…¥å¦‚ä¸‹çš„HTMLè¯­å¥ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>x-foo-with-markup</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span>I&#39;m an x-foo-with-markup!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>x-foo-with-markup</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="custom-element-çš„å­å…ƒç´ " tabindex="-1"><a class="header-anchor" href="#custom-element-çš„å­å…ƒç´ " aria-hidden="true">#</a> Custom Element çš„å­å…ƒç´ </h4><p>ç”¨æˆ·ä½¿ç”¨ Custom Element æ—¶å€™ï¼Œå¯ä»¥åœ¨å†…éƒ¨æ”¾ç½®å­å…ƒç´ ã€‚Custom Element æä¾›<code>&lt;slot&gt;</code>ç”¨æ¥å¼•ç”¨å†…éƒ¨å†…å®¹ã€‚</p><p>ä¸‹é¢çš„<code>&lt;image-gallery&gt;</code>æ˜¯ä¸€ä¸ª Custom Elementã€‚ç”¨æˆ·åœ¨é‡Œé¢æ”¾ç½®äº†å­å…ƒç´ ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image-gallery</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>foo.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bar.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image-gallery</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>&lt;image-gallery&gt;</code>å†…éƒ¨çš„æ¨¡æ¿å¦‚ä¸‹ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>images<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æœ€ç»ˆåˆæˆçš„ä»£ç å¦‚ä¸‹ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>images<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>foo.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bar.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="template-æ ‡ç­¾" tabindex="-1"><a class="header-anchor" href="#template-æ ‡ç­¾" aria-hidden="true">#</a> <code>&lt;template&gt;</code>æ ‡ç­¾</h3><h4 id="åŸºæœ¬ç”¨æ³•-3" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ç”¨æ³•-3" aria-hidden="true">#</a> åŸºæœ¬ç”¨æ³•</h4><p><code>&lt;template&gt;</code>æ ‡ç­¾è¡¨ç¤ºç»„ä»¶çš„ HTML ä»£ç æ¨¡æ¿ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>This won&#39;t display!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;this won&#39;t alert!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>&lt;template&gt;</code>å†…éƒ¨å°±æ˜¯æ­£å¸¸çš„ HTML ä»£ç ï¼Œæµè§ˆå™¨ä¸ä¼šå°†è¿™äº›ä»£ç åŠ å…¥ DOMã€‚</p><p>ä¸‹é¢çš„ä»£ç ä¼šå°†æ¨¡æ¿å†…éƒ¨çš„ä»£ç æ’å…¥ DOMã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">let</span> template <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;template&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>template<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼Œæ¨¡æ¿å†…éƒ¨çš„ä»£ç åªèƒ½æ’å…¥ä¸€æ¬¡ï¼Œå¦‚æœç¬¬äºŒæ¬¡æ‰§è¡Œä¸Šé¢çš„ä»£ç å°±ä¼šæŠ¥é”™ã€‚</p><p>å¦‚æœéœ€è¦å¤šæ¬¡æ’å…¥æ¨¡æ¿ï¼Œå¯ä»¥å¤åˆ¶<code>&lt;template&gt;</code>å†…éƒ¨ä»£ç ï¼Œç„¶åå†æ’å…¥ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>template<span class="token punctuation">.</span>content<span class="token punctuation">.</span><span class="token function">cloneNode</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>cloneNode()</code>æ–¹æ³•çš„å‚æ•°<code>true</code>è¡¨ç¤ºå¤åˆ¶åŒ…å«æ‰€æœ‰å­èŠ‚ç‚¹ã€‚</p><p>æ¥å—<code>&lt;template&gt;</code>æ’å…¥çš„å…ƒç´ ï¼Œå«åšå®¿ä¸»å…ƒç´ ï¼ˆhostï¼‰ã€‚åœ¨<code>&lt;template&gt;</code>ä¹‹ä¸­ï¼Œå¯ä»¥å¯¹å®¿ä¸»å…ƒç´ è®¾ç½®æ ·å¼ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
        <span class="token selector">:host</span> <span class="token punctuation">{</span>
            <span class="token property">background</span><span class="token punctuation">:</span> ##f8f8f8<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token selector">:host(:hover)</span> <span class="token punctuation">{</span>
            <span class="token property">background</span><span class="token punctuation">:</span> ##ccc<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="document-importnode" tabindex="-1"><a class="header-anchor" href="#document-importnode" aria-hidden="true">#</a> document.importNode()</h4><p>document.importNodeæ–¹æ³•ç”¨äºå…‹éš†å¤–éƒ¨æ–‡æ¡£çš„DOMèŠ‚ç‚¹ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> iframe <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">&quot;iframe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> oldNode <span class="token operator">=</span> iframe<span class="token punctuation">.</span>contentWindow<span class="token punctuation">.</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;myNode&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> newNode <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">importNode</span><span class="token punctuation">(</span>oldNode<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;container&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>newNode<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä¾‹å­æ˜¯å°†iframeçª—å£ä¹‹ä¸­çš„èŠ‚ç‚¹oldNodeï¼Œå…‹éš†è¿›å…¥å½“å‰æ–‡æ¡£ã€‚</p><p>æ³¨æ„ï¼Œå…‹éš†èŠ‚ç‚¹ä¹‹åï¼Œè¿˜å¿…é¡»ç”¨appendChildæ–¹æ³•å°†å…¶åŠ å…¥å½“å‰æ–‡æ¡£ï¼Œå¦åˆ™ä¸ä¼šæ˜¾ç¤ºã€‚æ¢ä¸ªè§’åº¦è¯´ï¼Œè¿™æ„å‘³ç€æ’å…¥å¤–éƒ¨æ–‡æ¡£èŠ‚ç‚¹ä¹‹å‰ï¼Œå¿…é¡»ç”¨document.importNodeæ–¹æ³•å…ˆå°†è¿™ä¸ªèŠ‚ç‚¹å‡†å¤‡å¥½ã€‚</p><p>document.importNodeæ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¤–éƒ¨æ–‡æ¡£çš„DOMèŠ‚ç‚¹ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦è¿åŒå­èŠ‚ç‚¹ä¸€èµ·å…‹éš†ï¼Œé»˜è®¤ä¸ºfalseã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¿…é¡»æ˜¾å¼åœ°å°†ç¬¬äºŒä¸ªå‚æ•°è®¾ä¸ºtrueã€‚</p><h3 id="shadow-dom" tabindex="-1"><a class="header-anchor" href="#shadow-dom" aria-hidden="true">#</a> Shadow DOM</h3><p>æ‰€è°“ Shadow DOM æŒ‡çš„æ˜¯ï¼Œæµè§ˆå™¨å°†æ¨¡æ¿ã€æ ·å¼è¡¨ã€å±æ€§ã€JavaScript ç ç­‰ï¼Œå°è£…æˆä¸€ä¸ªç‹¬ç«‹çš„ DOM å…ƒç´ ã€‚å¤–éƒ¨çš„è®¾ç½®æ— æ³•å½±å“åˆ°å…¶å†…éƒ¨ï¼Œè€Œå†…éƒ¨çš„è®¾ç½®ä¹Ÿä¸ä¼šå½±å“åˆ°å¤–éƒ¨ï¼Œä¸æµè§ˆå™¨å¤„ç†åŸç”Ÿç½‘é¡µå…ƒç´ ï¼ˆæ¯”å¦‚<code>&lt;video&gt;</code>å…ƒç´ ï¼‰çš„æ–¹å¼å¾ˆåƒã€‚</p><p>Shadow DOM æœ€å¤§çš„å¥½å¤„æœ‰ä¸¤ä¸ªï¼Œä¸€æ˜¯å¯ä»¥å‘ç”¨æˆ·éšè—ç»†èŠ‚ï¼Œç›´æ¥æä¾›ç»„ä»¶ï¼ŒäºŒæ˜¯å¯ä»¥å°è£…å†…éƒ¨æ ·å¼è¡¨ï¼Œä¸ä¼šå½±å“åˆ°å¤–éƒ¨ã€‚</p><p>Custom Element å†…éƒ¨æœ‰ä¸€ä¸ª Shadow Rootã€‚å®ƒå°±æ˜¯æ¥å…¥å¤–éƒ¨ DOM çš„æ ¹å…ƒç´ ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// attachShadow() creates a shadow root.</span>
<span class="token keyword">let</span> shadow <span class="token operator">=</span> div<span class="token punctuation">.</span><span class="token function">attachShadow</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;open&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> inner <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;b&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
inner<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span><span class="token string">&#39;Hiding in the shadows&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// shadow root supports the normal appendChild method.</span>
shadow<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>inner<span class="token punctuation">)</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;b&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// empty</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>&lt;div&gt;</code>åŒ…å«<code>&lt;b&gt;</code>ï¼Œä½†æ˜¯ DOM æ–¹æ³•æ— æ³•çœ‹åˆ°å®ƒï¼Œè€Œä¸”é¡µé¢çš„æ ·å¼ä¹Ÿå½±å“ä¸åˆ°å®ƒã€‚</p><p><code>mode: &#39;open&#39;</code>è¡¨ç¤ºå¼€å‘è€…å·¥å…·é‡Œé¢ï¼Œå¯ä»¥çœ‹åˆ° Custom HTML å†…éƒ¨çš„ DOMï¼Œå¹¶ä¸ä¹‹äº’åŠ¨ã€‚<code>mode: closed</code>å°†ä¸å…è®¸ Custom Element çš„ä½¿ç”¨è€…ä¸å†…éƒ¨ä»£ç äº’åŠ¨ã€‚</p><p>Shadow root å†…éƒ¨é€šè¿‡æŒ‡å®š<code>innerHTML</code>å±æ€§æˆ–ä½¿ç”¨<code>&lt;template&gt;</code>å…ƒç´ ï¼ŒæŒ‡å®š HTML ä»£ç ã€‚</p><p>Shadow DOM å†…éƒ¨å¯ä»¥é€šè¿‡å‘æ ¹æ·»åŠ <code>&lt;style&gt;</code>ï¼ˆæˆ–<code>&lt;link&gt;</code>ï¼‰æ¥è®¾ç½®æ ·å¼ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">let</span> style <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;style&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
style<span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token string">&#39;b { font-weight: bolder; color: red; }&#39;</span><span class="token punctuation">;</span>
shadowRoot<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>style<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> inner <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;b&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
inner<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&quot;I&#39;m bolder in the shadows&quot;</span><span class="token punctuation">;</span>
shadowRoot<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>inner<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç æ·»åŠ çš„æ ·å¼ï¼Œåªä¼šå½±å“ Shadow DOM å†…çš„å…ƒç´ ã€‚</p><p>Custom Element çš„ CSS æ ·å¼å†…éƒ¨ï¼Œ<code>:root</code>è¡¨ç¤ºè¿™ä¸ªæ ¹å…ƒç´ ã€‚æ¯”å¦‚ï¼ŒCustom Element é»˜è®¤æ˜¯è¡Œå†…å…ƒç´ ï¼Œä¸‹é¢ä»£ç å¯ä»¥æ”¹æˆå—çº§å…ƒç´ ã€‚</p><div class="language-css line-numbers-mode" data-ext="css"><pre class="language-css"><code><span class="token selector">:host</span> <span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">:host([disabled])</span> <span class="token punctuation">{</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 0.5<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼Œå¤–éƒ¨æ ·å¼ä¼šè¦†ç›–æ‰<code>:host</code>çš„è®¾ç½®ï¼Œæ¯”å¦‚ä¸‹é¢çš„æ ·å¼ä¼šè¦†ç›–<code>:host</code>ã€‚</p><div class="language-css line-numbers-mode" data-ext="css"><pre class="language-css"><code><span class="token selector">my-element</span> <span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ©ç”¨ CSS çš„è‡ªå®šä¹‰å±æ€§ï¼Œå¯ä»¥ä¸º Custom Element å¯ä»¥è¢«è¦†ç›–çš„é»˜è®¤æ ·å¼ã€‚ä¸‹é¢æ˜¯å¤–éƒ¨æ ·å¼ï¼Œ<code>my-element</code>æ˜¯ Custom Elementã€‚</p><div class="language-css line-numbers-mode" data-ext="css"><pre class="language-css"><code><span class="token selector">my-element</span> <span class="token punctuation">{</span>
    <span class="token property">--background-color</span><span class="token punctuation">:</span> ##ff0000<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åï¼Œå†…éƒ¨å¯ä»¥æŒ‡å®šé»˜è®¤æ ·å¼ï¼Œç”¨äºç”¨æˆ·æ²¡æœ‰æŒ‡å®šé¢œè‰²çš„æƒ…å†µã€‚</p><div class="language-css line-numbers-mode" data-ext="css"><pre class="language-css"><code><span class="token selector">:host</span> <span class="token punctuation">{</span>
    <span class="token property">--background-color</span><span class="token punctuation">:</span> ##ffffff<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">##container</span> <span class="token punctuation">{</span>
     <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--background-color<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸‹é¢çš„ä¾‹å­æ˜¯ä¸º Shadow DOM åŠ ä¸Šç‹¬ç«‹çš„æ¨¡æ¿ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>nameTag<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>å¼ ä¸‰<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>nameTagTemplate<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
        <span class="token selector">.outer</span> <span class="token punctuation">{</span>
            <span class="token property">border</span><span class="token punctuation">:</span> 2px solid brown<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>outer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>boilerplate<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            Hi! My name is
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            Bob
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç æ˜¯ä¸€ä¸ª<code>div</code>å…ƒç´ å’Œæ¨¡æ¿ã€‚æ¥ä¸‹æ¥ï¼Œå°±æ˜¯è¦æŠŠæ¨¡æ¿åº”ç”¨åˆ°<code>div</code>å…ƒç´ ä¸Šã€‚</p><h3 id="html-import" tabindex="-1"><a class="header-anchor" href="#html-import" aria-hidden="true">#</a> HTML Import</h3><h4 id="åŸºæœ¬æ“ä½œ" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ“ä½œ" aria-hidden="true">#</a> åŸºæœ¬æ“ä½œ</h4><p>é•¿ä¹…ä»¥æ¥ï¼Œç½‘é¡µå¯ä»¥åŠ è½½å¤–éƒ¨çš„æ ·å¼è¡¨ã€è„šæœ¬ã€å›¾ç‰‡ã€å¤šåª’ä½“ï¼Œå´æ— æ³•æ–¹ä¾¿åœ°åŠ è½½å…¶ä»–ç½‘é¡µï¼Œiframeå’Œajaxéƒ½åªèƒ½æä¾›éƒ¨åˆ†çš„è§£å†³æ–¹æ¡ˆï¼Œä¸”æœ‰å¾ˆå¤§çš„å±€é™ã€‚HTML Importå°±æ˜¯ä¸ºäº†è§£å†³åŠ è½½å¤–éƒ¨ç½‘é¡µè¿™ä¸ªé—®é¢˜ï¼Œè€Œæå‡ºæ¥çš„ã€‚</p><p>ä¸‹é¢ä»£ç ç”¨äºæµ‹è¯•å½“å‰æµè§ˆå™¨æ˜¯å¦æ”¯æŒHTML Importã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">supportsImports</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&#39;import&#39;</span> <span class="token keyword">in</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;link&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">supportsImports</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ”¯æŒ</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// ä¸æ”¯æŒ</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>HTML Importç”¨äºå°†å¤–éƒ¨çš„HTMLæ–‡æ¡£åŠ è½½è¿›å½“å‰æ–‡æ¡£ã€‚æˆ‘ä»¬å¯ä»¥å°†ç»„ä»¶çš„HTMLã€CSSã€JavaScriptå°è£…åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œï¼Œç„¶åä½¿ç”¨ä¸‹é¢çš„ä»£ç æ’å…¥éœ€è¦ä½¿ç”¨è¯¥ç»„ä»¶çš„ç½‘é¡µã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>import<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dialog.html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç åœ¨ç½‘é¡µä¸­æ’å…¥ä¸€ä¸ªå¯¹è¯æ¡†ç»„ä»¶ï¼Œè¯¥ç»„å»ºå°è£…åœ¨<code>dialog.html</code>æ–‡ä»¶ã€‚æ³¨æ„ï¼Œdialog.htmlæ–‡ä»¶ä¸­çš„æ ·å¼å’ŒJavaScriptè„šæœ¬ï¼Œéƒ½å¯¹æ‰€æ’å…¥çš„æ•´ä¸ªç½‘é¡µæœ‰æ•ˆã€‚</p><p>å‡å®šAç½‘é¡µé€šè¿‡HTML ImportåŠ è½½äº†Bç½‘é¡µï¼Œå³Bæ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œé‚£ä¹ˆBç½‘é¡µçš„æ ·å¼è¡¨å’Œè„šæœ¬ï¼Œå¯¹Aç½‘é¡µä¹Ÿæœ‰æ•ˆï¼ˆå‡†ç¡®å¾—è¯´ï¼Œåªæœ‰styleæ ‡ç­¾ä¸­çš„æ ·å¼å¯¹Aç½‘é¡µæœ‰æ•ˆï¼Œlinkæ ‡ç­¾åŠ è½½çš„æ ·å¼è¡¨å¯¹Aç½‘é¡µæ— æ•ˆï¼‰ã€‚æ‰€ä»¥å¯ä»¥æŠŠå¤šä¸ªæ ·å¼è¡¨å’Œè„šæœ¬ï¼Œéƒ½æ”¾åœ¨Bç½‘é¡µä¸­ï¼Œéƒ½ä»é‚£é‡ŒåŠ è½½ã€‚è¿™å¯¹å¤§å‹çš„æ¡†æ¶ï¼Œæ˜¯å¾ˆæ–¹ä¾¿çš„åŠ è½½æ–¹æ³•ã€‚</p><p>å¦‚æœBä¸Aä¸åœ¨åŒä¸€ä¸ªåŸŸï¼Œé‚£ä¹ˆAæ‰€åœ¨çš„åŸŸå¿…é¡»æ‰“å¼€CORSã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token comment">&lt;!-- example.comå¿…é¡»æ‰“å¼€CORS --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>import<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://example.com/elements.html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é™¤äº†ç”¨linkæ ‡ç­¾ï¼Œä¹Ÿå¯ä»¥ç”¨JavaScriptè°ƒç”¨linkå…ƒç´ ï¼Œå®ŒæˆHTML Importã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> link <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;link&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
link<span class="token punctuation">.</span>rel <span class="token operator">=</span> <span class="token string">&#39;import&#39;</span><span class="token punctuation">;</span>
link<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">&#39;file.html&#39;</span>
link<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
link<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>HTML ImportåŠ è½½æˆåŠŸæ—¶ï¼Œä¼šåœ¨linkå…ƒç´ ä¸Šè§¦å‘loadäº‹ä»¶ï¼ŒåŠ è½½å¤±è´¥æ—¶ï¼ˆæ¯”å¦‚404é”™è¯¯ï¼‰ä¼šè§¦å‘erroräº‹ä»¶ï¼Œå¯ä»¥å¯¹è¿™ä¸¤ä¸ªäº‹ä»¶æŒ‡å®šå›è°ƒå‡½æ•°ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">async</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">function</span> <span class="token function">handleLoad</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Loaded import: &#39;</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>href<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">handleError</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Error loading import: &#39;</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>href<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>import<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file.html<span class="token punctuation">&quot;</span></span>
      <span class="token special-attr"><span class="token attr-name">onload</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript"><span class="token function">handleLoad</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span> <span class="token special-attr"><span class="token attr-name">onerror</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript"><span class="token function">handleError</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼ŒhandleLoadå’ŒhandleErrorå‡½æ•°çš„å®šä¹‰ï¼Œå¿…é¡»åœ¨linkå…ƒç´ çš„å‰é¢ã€‚å› ä¸ºæµè§ˆå™¨å…ƒç´ é‡åˆ°linkå…ƒç´ æ—¶ï¼Œç«‹åˆ»è§£æå¹¶åŠ è½½å¤–éƒ¨ç½‘é¡µï¼ˆåŒæ­¥æ“ä½œï¼‰ï¼Œå¦‚æœè¿™æ—¶æ²¡æœ‰å¯¹è¿™ä¸¤ä¸ªå‡½æ•°å®šä¹‰ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p><p>HTML Importæ˜¯åŒæ­¥åŠ è½½ï¼Œä¼šé˜»å¡å½“å‰ç½‘é¡µçš„æ¸²æŸ“ï¼Œè¿™ä¸»è¦æ˜¯ä¸ºäº†æ ·å¼è¡¨çš„è€ƒè™‘ï¼Œå› ä¸ºå¤–éƒ¨ç½‘é¡µçš„æ ·å¼è¡¨å¯¹å½“å‰ç½‘é¡µä¹Ÿæœ‰æ•ˆã€‚å¦‚æœæƒ³é¿å…è¿™ä¸€ç‚¹ï¼Œå¯ä»¥ä¸ºlinkå…ƒç´ åŠ ä¸Šasyncå±æ€§ã€‚å½“ç„¶ï¼Œè¿™ä¹Ÿæ„å‘³ç€ï¼Œå¦‚æœå¤–éƒ¨ç½‘é¡µå®šä¹‰äº†ç»„ä»¶ï¼Œå°±ä¸èƒ½ç«‹å³ä½¿ç”¨äº†ï¼Œå¿…é¡»ç­‰HTML Importå®Œæˆï¼Œæ‰èƒ½ä½¿ç”¨ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>import<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/path/to/import_that_takes_5secs.html<span class="token punctuation">&quot;</span></span> <span class="token attr-name">async</span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½†æ˜¯ï¼ŒHTML Importä¸ä¼šé˜»å¡å½“å‰ç½‘é¡µçš„è§£æå’Œè„šæœ¬æ‰§è¡Œï¼ˆå³é˜»å¡æ¸²æŸ“ï¼‰ã€‚è¿™æ„å‘³ç€åœ¨åŠ è½½çš„åŒæ—¶ï¼Œä¸»é¡µé¢çš„è„šæœ¬ä¼šç»§ç»­æ‰§è¡Œã€‚</p><p>æœ€åï¼ŒHTML Importæ”¯æŒå¤šé‡åŠ è½½ï¼Œå³è¢«åŠ è½½çš„ç½‘é¡µåŒæ—¶åˆåŠ è½½å…¶ä»–ç½‘é¡µã€‚å¦‚æœè¿™äº›ç½‘é¡µéƒ½é‡å¤åŠ è½½åŒä¸€ä¸ªå¤–éƒ¨è„šæœ¬ï¼Œæµè§ˆå™¨åªä¼šæŠ“å–å¹¶æ‰§è¡Œä¸€æ¬¡è¯¥è„šæœ¬ã€‚æ¯”å¦‚ï¼ŒAç½‘é¡µåŠ è½½äº†Bç½‘é¡µï¼Œå®ƒä»¬å„è‡ªéƒ½éœ€è¦åŠ è½½jQueryï¼Œæµè§ˆå™¨åªä¼šåŠ è½½ä¸€æ¬¡jQueryã€‚</p><h4 id="è„šæœ¬çš„æ‰§è¡Œ" tabindex="-1"><a class="header-anchor" href="#è„šæœ¬çš„æ‰§è¡Œ" aria-hidden="true">#</a> è„šæœ¬çš„æ‰§è¡Œ</h4><p>å¤–éƒ¨ç½‘é¡µçš„å†…å®¹ï¼Œå¹¶ä¸ä¼šè‡ªåŠ¨æ˜¾ç¤ºåœ¨å½“å‰ç½‘é¡µä¸­ï¼Œå®ƒåªæ˜¯å‚¨å­˜åœ¨æµè§ˆå™¨ä¸­ï¼Œç­‰åˆ°è¢«è°ƒç”¨çš„æ—¶å€™æ‰åŠ è½½è¿›å…¥å½“å‰ç½‘é¡µã€‚ä¸ºäº†åŠ è½½ç½‘é¡µç½‘é¡µï¼Œå¿…é¡»ç”¨DOMæ“ä½œè·å–åŠ è½½çš„å†…å®¹ã€‚å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯ä½¿ç”¨linkå…ƒç´ çš„importå±æ€§ï¼Œæ¥è·å–åŠ è½½çš„å†…å®¹ã€‚è¿™ä¸€ç‚¹ä¸iframeå®Œå…¨ä¸åŒã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> content <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;link[rel=&quot;import&quot;]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>import<span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>å‘ç”Ÿä»¥ä¸‹æƒ…å†µæ—¶ï¼Œlink.importå±æ€§ä¸ºnullã€‚</p><ul><li>æµè§ˆå™¨ä¸æ”¯æŒHTML Import</li><li>linkå…ƒç´ æ²¡æœ‰å£°æ˜<code>rel=&quot;import&quot;</code></li><li>linkå…ƒç´ æ²¡æœ‰è¢«åŠ å…¥DOM</li><li>linkå…ƒç´ å·²ç»ä»DOMä¸­ç§»é™¤</li><li>å¯¹æ–¹åŸŸåæ²¡æœ‰æ‰“å¼€CORS</li></ul><p>ä¸‹é¢ä»£ç ç”¨äºä»åŠ è½½çš„å¤–éƒ¨ç½‘é¡µé€‰å–idä¸ºtemplateçš„å…ƒç´ ï¼Œç„¶åå°†å…¶å…‹éš†ååŠ å…¥å½“å‰ç½‘é¡µçš„DOMã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> el <span class="token operator">=</span> linkElement<span class="token punctuation">.</span>import<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;##template&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>el<span class="token punctuation">.</span><span class="token function">cloneNode</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“å‰ç½‘é¡µå¯ä»¥è·å–å¤–éƒ¨ç½‘é¡µï¼Œåè¿‡æ¥ä¹Ÿä¸€æ ·ï¼Œå¤–éƒ¨ç½‘é¡µä¸­çš„è„šæœ¬ï¼Œä¸ä»…å¯ä»¥è·å–æœ¬èº«çš„DOMï¼Œè¿˜å¯ä»¥è·å–linkå…ƒç´ æ‰€åœ¨çš„å½“å‰ç½‘é¡µçš„DOMã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// ä»¥ä¸‹ä»£ç ä½äºè¢«åŠ è½½ï¼ˆimportï¼‰çš„å¤–éƒ¨ç½‘é¡µ</span>

<span class="token comment">// importDocæŒ‡å‘è¢«åŠ è½½çš„DOM</span>
<span class="token keyword">var</span> importDoc <span class="token operator">=</span> document<span class="token punctuation">.</span>currentScript<span class="token punctuation">.</span>ownerDocument<span class="token punctuation">;</span>

<span class="token comment">// mainDocæŒ‡å‘ä¸»æ–‡æ¡£çš„DOM</span>
<span class="token keyword">var</span> mainDoc <span class="token operator">=</span> document<span class="token punctuation">;</span>

<span class="token comment">// å°†å­é¡µé¢çš„æ ·å¼è¡¨æ·»åŠ ä¸»æ–‡æ¡£</span>
<span class="token keyword">var</span> styles <span class="token operator">=</span> importDoc<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;link[rel=&quot;stylesheet&quot;]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mainDoc<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>styles<span class="token punctuation">.</span><span class="token function">cloneNode</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç å°†æ‰€åŠ è½½çš„å¤–éƒ¨ç½‘é¡µçš„æ ·å¼è¡¨ï¼Œæ·»åŠ è¿›å½“å‰ç½‘é¡µã€‚</p><p>è¢«åŠ è½½çš„å¤–éƒ¨ç½‘é¡µçš„è„šæœ¬æ˜¯ç›´æ¥åœ¨å½“å‰ç½‘é¡µçš„ä¸Šä¸‹æ–‡æ‰§è¡Œï¼Œå› ä¸ºå®ƒçš„<code>window.document</code>æŒ‡çš„æ˜¯å½“å‰ç½‘é¡µçš„documentï¼Œè€Œä¸”å®ƒå®šä¹‰çš„å‡½æ•°å¯ä»¥è¢«å½“å‰ç½‘é¡µçš„è„šæœ¬ç›´æ¥å¼•ç”¨ã€‚</p><h4 id="web-componentçš„å°è£…" tabindex="-1"><a class="header-anchor" href="#web-componentçš„å°è£…" aria-hidden="true">#</a> Web Componentçš„å°è£…</h4><p>å¯¹äºWeb Componentæ¥è¯´ï¼ŒHTML Importçš„ä¸€ä¸ªé‡è¦åº”ç”¨æ˜¯åœ¨æ‰€åŠ è½½çš„ç½‘é¡µä¸­ï¼Œè‡ªåŠ¨ç™»è®°Custom Elementã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token comment">// å®šä¹‰å¹¶ç™»è®°&lt;say-hi&gt;</span>
    <span class="token keyword">var</span> proto <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">HTMLElement</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>

    proto<span class="token punctuation">.</span><span class="token function-variable function">createdCallback</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&#39;Hello, &lt;b&gt;&#39;</span> <span class="token operator">+</span>
                <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">&#39;?&#39;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;&lt;/b&gt;&#39;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    document<span class="token punctuation">.</span><span class="token function">registerElement</span><span class="token punctuation">(</span><span class="token string">&#39;say-hi&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">prototype</span><span class="token operator">:</span> proto<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>t<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
        <span class="token selector">::content &gt; *</span> <span class="token punctuation">{</span>
            <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>I&#39;m a shadow-element using Shadow DOM!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>content</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>content</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> importDoc <span class="token operator">=</span> document<span class="token punctuation">.</span>currentScript<span class="token punctuation">.</span>ownerDocument<span class="token punctuation">;</span> <span class="token comment">//æŒ‡å‘è¢«åŠ è½½çš„ç½‘é¡µ</span>

        <span class="token comment">// å®šä¹‰å¹¶ç™»è®°&lt;shadow-element&gt;</span>
        <span class="token keyword">var</span> proto2 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">HTMLElement</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>

        proto2<span class="token punctuation">.</span><span class="token function-variable function">createdCallback</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> template <span class="token operator">=</span> importDoc<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;##t&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> clone <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">importNode</span><span class="token punctuation">(</span>template<span class="token punctuation">.</span>content<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> root <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createShadowRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            root<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>clone<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        document<span class="token punctuation">.</span><span class="token function">registerElement</span><span class="token punctuation">(</span><span class="token string">&#39;shadow-element&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">prototype</span><span class="token operator">:</span> proto2<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç å®šä¹‰å¹¶ç™»è®°äº†ä¸¤ä¸ªå…ƒç´ ï¼š&lt;say-hi&gt;å’Œ&lt;shadow-element&gt;ã€‚åœ¨ä¸»é¡µé¢ä½¿ç”¨è¿™ä¸¤ä¸ªå…ƒç´ ï¼Œéå¸¸ç®€å•ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>import<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>elements.html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>say-hi</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Eric<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>say-hi</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>shadow-element</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>( I&#39;m in the light dom )<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>shadow-element</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸éš¾æƒ³åˆ°ï¼Œè¿™æ„å‘³ç€HTML Importä½¿å¾—Web Componentå˜å¾—å¯åˆ†äº«äº†ï¼Œå…¶ä»–äººåªè¦æ‹·è´<code>elements.html</code>ï¼Œå°±å¯ä»¥åœ¨è‡ªå·±çš„é¡µé¢ä¸­ä½¿ç”¨äº†ã€‚</p><h3 id="polymer-js" tabindex="-1"><a class="header-anchor" href="#polymer-js" aria-hidden="true">#</a> Polymer.js</h3><p>Web Componentsæ˜¯éå¸¸æ–°çš„æŠ€æœ¯ï¼Œä¸ºäº†è®©è€å¼æµè§ˆå™¨ä¹Ÿèƒ½ä½¿ç”¨ï¼ŒGoogleæ¨å‡ºäº†ä¸€ä¸ªå‡½æ•°åº“<a href="http://www.polymer-project.org/" target="_blank" rel="noopener noreferrer">Polymer.js<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ã€‚è¿™ä¸ªåº“ä¸ä»…å¯ä»¥å¸®åŠ©å¼€å‘è€…ï¼Œå®šä¹‰è‡ªå·±çš„ç½‘é¡µå…ƒç´ ï¼Œè¿˜æä¾›è®¸å¤šé¢„å…ˆåˆ¶ä½œå¥½çš„ç»„ä»¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚</p><h4 id="ç›´æ¥ä½¿ç”¨çš„ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#ç›´æ¥ä½¿ç”¨çš„ç»„ä»¶" aria-hidden="true">#</a> ç›´æ¥ä½¿ç”¨çš„ç»„ä»¶</h4><p>Polymer.jsæä¾›çš„ç»„ä»¶ï¼Œå¯ä»¥ç›´æ¥æ’å…¥ç½‘é¡µï¼Œæ¯”å¦‚ä¸‹é¢çš„google-mapã€‚ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>components/platform/platform.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>import<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>google-map.html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>google-map</span> <span class="token attr-name">lat</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>37.790<span class="token punctuation">&quot;</span></span> <span class="token attr-name">long</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>-122.390<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>google-map</span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å†æ¯”å¦‚ï¼Œåœ¨ç½‘é¡µä¸­æ’å…¥ä¸€ä¸ªæ—¶é’Ÿï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ä¸‹é¢çš„æ ‡ç­¾ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>polymer-ui-clock</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>polymer-ui-clock</span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>è‡ªå®šä¹‰æ ‡ç­¾ä¸å…¶ä»–æ ‡ç­¾çš„ç”¨æ³•å®Œå…¨ç›¸åŒï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨CSSæŒ‡å®šå®ƒçš„æ ·å¼ã€‚</p><div class="language-css line-numbers-mode" data-ext="css"><pre class="language-css"><code><span class="token selector">polymer-ui-clock</span> <span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 320px<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 320px<span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
    <span class="token property">background</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span><span class="token string url">&quot;../assets/glass.png&quot;</span><span class="token punctuation">)</span></span> no-repeat<span class="token punctuation">;</span>
    <span class="token property">background-size</span><span class="token punctuation">:</span> cover<span class="token punctuation">;</span>
    <span class="token property">border</span><span class="token punctuation">:</span> 4px solid <span class="token function">rgba</span><span class="token punctuation">(</span>32<span class="token punctuation">,</span> 32<span class="token punctuation">,</span> 32<span class="token punctuation">,</span> 0.3<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å®‰è£…-1" tabindex="-1"><a class="header-anchor" href="#å®‰è£…-1" aria-hidden="true">#</a> å®‰è£…</h4><p>å¦‚æœä½¿ç”¨bowerå®‰è£…ï¼Œè‡³å°‘éœ€è¦å®‰è£…platformå’Œcore componentsè¿™ä¸¤ä¸ªæ ¸å¿ƒéƒ¨åˆ†ã€‚</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>bower <span class="token function">install</span> <span class="token parameter variable">--save</span> Polymer/platform
bower <span class="token function">install</span> <span class="token parameter variable">--save</span> Polymer/polymer

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½ è¿˜å¯ä»¥å®‰è£…æ‰€æœ‰é¢„å…ˆå®šä¹‰çš„ç•Œé¢ç»„ä»¶ã€‚</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>bower <span class="token function">install</span> Polymer/core-elements
bower <span class="token function">install</span> Polymer/polymer-ui-elements

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿˜å¯ä»¥åªå®‰è£…å•ä¸ªç»„ä»¶ã€‚</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>bower <span class="token function">install</span> Polymer/polymer-ui-accordion

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ—¶ï¼Œç»„ä»¶æ ¹ç›®å½•ä¸‹çš„bower.jsonï¼Œä¼šæŒ‡æ˜è¯¥ç»„ä»¶çš„ä¾èµ–çš„æ¨¡å—ï¼Œè¿™äº›æ¨¡å—ä¼šè¢«è‡ªåŠ¨å®‰è£…ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    <span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;polymer-ui-accordion&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;private&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;polymer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Polymer/polymer##0.2.0&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;polymer-selector&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Polymer/polymer-selector##0.2.0&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;polymer-ui-collapsible&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Polymer/polymer-ui-collapsible##0.2.0&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.2.0&quot;</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="è‡ªå®šä¹‰ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰ç»„ä»¶" aria-hidden="true">#</a> è‡ªå®šä¹‰ç»„ä»¶</h4><p>ä¸‹é¢æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„è‡ªå®šä¹‰ç»„ä»¶çš„ä¾‹å­ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>import<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../bower_components/polymer/polymer.html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>polymer-element</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>lorem-element<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Lorem ipsum<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>polymer-element</span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç å®šä¹‰äº†lorem-elementç»„ä»¶ã€‚å®ƒåˆ†æˆä¸‰ä¸ªéƒ¨åˆ†ã€‚</p><p><strong>ï¼ˆ1ï¼‰importå‘½ä»¤</strong></p><p>importå‘½ä»¤è¡¨ç¤ºè½½å…¥æ ¸å¿ƒæ¨¡å—</p><p><strong>ï¼ˆ2ï¼‰polymer-elementæ ‡ç­¾</strong></p><p>polymer-elementæ ‡ç­¾å®šä¹‰äº†ç»„ä»¶çš„åç§°ï¼ˆæ³¨æ„ï¼Œç»„ä»¶åç§°ä¸­å¿…é¡»åŒ…å«è¿å­—ç¬¦ï¼‰ã€‚å®ƒè¿˜å¯ä»¥ä½¿ç”¨extendså±æ€§ï¼Œè¡¨ç¤ºç»„ä»¶åŸºäºæŸç§ç½‘é¡µå…ƒç´ ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>polymer-element</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>w3c-disclosure<span class="token punctuation">&quot;</span></span> <span class="token attr-name">extends</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ï¼ˆ3ï¼‰templateæ ‡ç­¾</strong></p><p>templateæ ‡ç­¾å®šä¹‰äº†ç½‘é¡µå…ƒç´ çš„æ¨¡æ¿ã€‚</p><h4 id="ç»„ä»¶çš„ä½¿ç”¨æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#ç»„ä»¶çš„ä½¿ç”¨æ–¹æ³•" aria-hidden="true">#</a> ç»„ä»¶çš„ä½¿ç”¨æ–¹æ³•</h4><p>åœ¨è°ƒç”¨ç»„ä»¶çš„ç½‘é¡µä¸­ï¼Œé¦–å…ˆåŠ è½½polymer.jsåº“å’Œç»„ä»¶æ–‡ä»¶ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>components/platform/platform.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>import<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>w3c-disclosure.html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åï¼Œåˆ†æˆä¸¤ç§æƒ…å†µã€‚å¦‚æœç»„ä»¶ä¸åŸºäºä»»ä½•ç°æœ‰çš„HTMLç½‘é¡µå…ƒç´ ï¼ˆå³å®šä¹‰çš„æ—¶å€™æ²¡æœ‰ä½¿ç”¨extendså±æ€§ï¼‰ï¼Œåˆ™å¯ä»¥ç›´æ¥ä½¿ç”¨ç»„ä»¶ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>lorem-element</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>lorem-element</span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ—¶ç½‘é¡µä¸Šå°±ä¼šæ˜¾ç¤ºä¸€è¡Œå­—â€œLorem ipsumâ€ã€‚</p><p>å¦‚æœç»„ä»¶æ˜¯åŸºäºï¼ˆextendsï¼‰ç°æœ‰çš„ç½‘é¡µå…ƒç´ ï¼Œåˆ™å¿…é¡»åœ¨è¯¥ç§å…ƒç´ ä¸Šä½¿ç”¨iså±æ€§æŒ‡å®šç»„ä»¶ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&lt;button is=&quot;w3c-disclosure&quot;&gt;Expand section 1&lt;/button&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å‚è€ƒé“¾æ¥-12" tabindex="-1"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥-12" aria-hidden="true">#</a> å‚è€ƒé“¾æ¥</h3><ul><li><a href="https://hacks.mozilla.org/2018/11/the-power-of-web-components/" target="_blank" rel="noopener noreferrer">The Power of Web Components<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, Potch</li><li>Todd Motto, <a href="http://toddmotto.com/web-components-concepts-shadow-dom-imports-templates-custom-elements/" target="_blank" rel="noopener noreferrer">Web Components and concepts, ShadowDOM, imports, templates, custom elements<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Dominic Cooney, <a href="http://www.html5rocks.com/en/tutorials/webcomponents/shadowdom/" target="_blank" rel="noopener noreferrer">Shadow DOM 101<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Eric Bidelman, <a href="http://www.html5rocks.com/en/tutorials/webcomponents/template/" target="_blank" rel="noopener noreferrer">HTML&#39;s New Template Tag<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Rey Bango, <a href="http://code.tutsplus.com/tutorials/using-polymer-to-create-web-components--cms-20475" target="_blank" rel="noopener noreferrer">Using Polymer to Create Web Components<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>CÃ©dric TrÃ©visan, Building an Accessible Disclosure Button â€“ using Web Components](<a href="http://blog.paciellogroup.com/2014/06/accessible-disclosure-button-using-web-components/" target="_blank" rel="noopener noreferrer">http://blog.paciellogroup.com/2014/06/accessible-disclosure-button-using-web-components/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>)</li><li>Eric Bidelman, <a href="http://www.html5rocks.com/en/tutorials/webcomponents/customelements/" target="_blank" rel="noopener noreferrer">Custom Elements: defining new elements in HTML<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Eric Bidelman, <a href="http://www.html5rocks.com/en/tutorials/webcomponents/imports/" target="_blank" rel="noopener noreferrer">HTML Imports<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>TJ VanToll, <a href="http://developer.telerik.com/featured/web-components-ready-production/" target="_blank" rel="noopener noreferrer">Why Web Components Are Ready For Production<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Chris Bateman, <a href="http://cbateman.com/blog/a-no-nonsense-guide-to-web-components-part-1-the-specs/" target="_blank" rel="noopener noreferrer">A No-Nonsense Guide to Web Components, Part 1: The Specs<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://blog.usejournal.com/web-components-will-replace-your-frontend-framework-3b17a580831c" target="_blank" rel="noopener noreferrer">Web Components will replace your frontend framework<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, Danny Moerkerke</li><li><a href="https://developers.google.com/web/fundamentals/web-components/customelements##extend" target="_blank" rel="noopener noreferrer">Custom Elements v1: Reusable Web Components<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, Eric Bidelman</li></ul><h2 id="websocket" tabindex="-1"><a class="header-anchor" href="#websocket" aria-hidden="true">#</a> WebSocket</h2><p>WebSocket æ˜¯ä¸€ç§ç½‘ç»œé€šä¿¡åè®®ï¼Œå¾ˆå¤šé«˜çº§åŠŸèƒ½éƒ½éœ€è¦å®ƒã€‚</p><p>åˆæ¬¡æ¥è§¦ WebSocket çš„äººï¼Œéƒ½ä¼šé—®åŒæ ·çš„é—®é¢˜ï¼šæˆ‘ä»¬å·²ç»æœ‰äº† HTTP åè®®ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦å¦ä¸€ä¸ªåè®®ï¼Ÿå®ƒèƒ½å¸¦æ¥ä»€ä¹ˆå¥½å¤„ï¼Ÿ</p><p>ç­”æ¡ˆå¾ˆç®€å•ï¼Œå› ä¸º HTTP åè®®æœ‰ä¸€ä¸ªç¼ºé™·ï¼šé€šä¿¡åªèƒ½ç”±å®¢æˆ·ç«¯å‘èµ·ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œæˆ‘ä»¬æƒ³äº†è§£ä»Šå¤©çš„å¤©æ°”ï¼Œåªèƒ½æ˜¯å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼ŒæœåŠ¡å™¨è¿”å›æŸ¥è¯¢ç»“æœã€‚HTTP åè®®åšä¸åˆ°æœåŠ¡å™¨ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€ä¿¡æ¯ã€‚HTTP åè®®çš„è¿™ç§å•å‘è¯·æ±‚çš„ç‰¹ç‚¹ï¼Œæ³¨å®šäº†å¦‚æœæœåŠ¡å™¨æœ‰è¿ç»­çš„çŠ¶æ€å˜åŒ–ï¼Œå®¢æˆ·ç«¯è¦è·çŸ¥å°±éå¸¸éº»çƒ¦ã€‚æˆ‘ä»¬åªèƒ½ä½¿ç”¨â€œè½®è¯¢â€ï¼šæ¯éš”ä¸€æ®µæ—¶å€™ï¼Œå°±å‘å‡ºä¸€ä¸ªè¯¢é—®ï¼Œäº†è§£æœåŠ¡å™¨æœ‰æ²¡æœ‰æ–°çš„ä¿¡æ¯ã€‚æœ€å…¸å‹çš„åœºæ™¯å°±æ˜¯èŠå¤©å®¤ã€‚</p><p>è½®è¯¢çš„æ•ˆç‡ä½ï¼Œéå¸¸æµªè´¹èµ„æºï¼ˆå› ä¸ºå¿…é¡»ä¸åœè¿æ¥ï¼Œæˆ–è€… HTTP è¿æ¥å§‹ç»ˆæ‰“å¼€ï¼‰ã€‚å› æ­¤ï¼Œå·¥ç¨‹å¸ˆä»¬ä¸€ç›´åœ¨æ€è€ƒï¼Œæœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹æ³•ã€‚WebSocket å°±æ˜¯è¿™æ ·å‘æ˜çš„ã€‚</p><h3 id="ç®€ä»‹-5" tabindex="-1"><a class="header-anchor" href="#ç®€ä»‹-5" aria-hidden="true">#</a> ç®€ä»‹</h3><p>WebSocket åè®®åœ¨2008å¹´è¯ç”Ÿï¼Œ2011å¹´æˆä¸ºå›½é™…æ ‡å‡†ã€‚æ‰€æœ‰æµè§ˆå™¨éƒ½å·²ç»æ”¯æŒäº†ã€‚</p><p>å®ƒçš„æœ€å¤§ç‰¹ç‚¹å°±æ˜¯ï¼ŒæœåŠ¡å™¨å¯ä»¥ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€ä¿¡æ¯ï¼Œå®¢æˆ·ç«¯ä¹Ÿå¯ä»¥ä¸»åŠ¨å‘æœåŠ¡å™¨å‘é€ä¿¡æ¯ï¼Œæ˜¯çœŸæ­£çš„åŒå‘å¹³ç­‰å¯¹è¯ï¼Œå±äºæœåŠ¡å™¨æ¨é€æŠ€æœ¯çš„ä¸€ç§ã€‚WebSocket å…è®¸æœåŠ¡å™¨ç«¯ä¸å®¢æˆ·ç«¯è¿›è¡Œå…¨åŒå·¥ï¼ˆfull-duplexï¼‰çš„é€šä¿¡ã€‚ä¸¾ä¾‹æ¥è¯´ï¼ŒHTTP åè®®æœ‰ç‚¹åƒå‘ç”µå­é‚®ä»¶ï¼Œå‘å‡ºåå¿…é¡»ç­‰å¾…å¯¹æ–¹å›ä¿¡ï¼›WebSocket åˆ™æ˜¯åƒæ‰“ç”µè¯ï¼ŒæœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯å¯ä»¥åŒæ—¶å‘å¯¹æ–¹å‘é€æ•°æ®ï¼Œå®ƒä»¬ä¹‹é—´å­˜ç€ä¸€æ¡æŒç»­æ‰“å¼€çš„æ•°æ®é€šé“ã€‚</p><p>å…¶ä»–ç‰¹ç‚¹åŒ…æ‹¬ï¼š</p><p>ï¼ˆ1ï¼‰å»ºç«‹åœ¨ TCP åè®®ä¹‹ä¸Šï¼ŒæœåŠ¡å™¨ç«¯çš„å®ç°æ¯”è¾ƒå®¹æ˜“ã€‚</p><p>ï¼ˆ2ï¼‰ä¸ HTTP åè®®æœ‰ç€è‰¯å¥½çš„å…¼å®¹æ€§ã€‚é»˜è®¤ç«¯å£ä¹Ÿæ˜¯80å’Œ443ï¼Œå¹¶ä¸”æ¡æ‰‹é˜¶æ®µé‡‡ç”¨ HTTP åè®®ï¼Œå› æ­¤æ¡æ‰‹æ—¶ä¸å®¹æ˜“å±è”½ï¼Œèƒ½é€šè¿‡å„ç§ HTTP ä»£ç†æœåŠ¡å™¨ã€‚</p><p>ï¼ˆ3ï¼‰æ•°æ®æ ¼å¼æ¯”è¾ƒè½»é‡ï¼Œæ€§èƒ½å¼€é”€å°ï¼Œé€šä¿¡é«˜æ•ˆã€‚</p><p>ï¼ˆ4ï¼‰å¯ä»¥å‘é€æ–‡æœ¬ï¼Œä¹Ÿå¯ä»¥å‘é€äºŒè¿›åˆ¶æ•°æ®ã€‚</p><p>ï¼ˆ5ï¼‰æ²¡æœ‰åŒæºé™åˆ¶ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä¸ä»»æ„æœåŠ¡å™¨é€šä¿¡ï¼Œå®Œå…¨å¯ä»¥å–ä»£ Ajaxã€‚</p><p>ï¼ˆ6ï¼‰åè®®æ ‡è¯†ç¬¦æ˜¯<code>ws</code>ï¼ˆå¦‚æœåŠ å¯†ï¼Œåˆ™ä¸º<code>wss</code>ï¼Œå¯¹åº” HTTPS åè®®ï¼‰ï¼ŒæœåŠ¡å™¨ç½‘å€å°±æ˜¯ URLã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code>ws://example.com:80/some/path
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="websocket-æ¡æ‰‹" tabindex="-1"><a class="header-anchor" href="#websocket-æ¡æ‰‹" aria-hidden="true">#</a> WebSocket æ¡æ‰‹</h3><p>æµè§ˆå™¨å‘å‡ºçš„ WebSocket æ¡æ‰‹è¯·æ±‚ç±»ä¼¼äºä¸‹é¢çš„æ ·å­ï¼š</p><div class="language-http line-numbers-mode" data-ext="http"><pre class="language-http"><code><span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">/</span> <span class="token http-version property">HTTP/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">Upgrade</span></span>
<span class="token header"><span class="token header-name keyword">Upgrade</span><span class="token punctuation">:</span> <span class="token header-value">websocket</span></span>
<span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">example.com</span></span>
<span class="token header"><span class="token header-name keyword">Origin</span><span class="token punctuation">:</span> <span class="token header-value">null</span></span>
<span class="token header"><span class="token header-name keyword">Sec-WebSocket-Key</span><span class="token punctuation">:</span> <span class="token header-value">sN9cRrP/n9NdMgdcy2VJFQ==</span></span>
<span class="token header"><span class="token header-name keyword">Sec-WebSocket-Version</span><span class="token punctuation">:</span> <span class="token header-value">13</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„å¤´ä¿¡æ¯ä¹‹ä¸­ï¼Œæœ‰ä¸€ä¸ª HTTP å¤´æ˜¯<code>Upgrade</code>ã€‚HTTP1.1 åè®®è§„å®šï¼Œ<code>Upgrade</code>å­—æ®µè¡¨ç¤ºå°†é€šä¿¡åè®®ä»<code>HTTP/1.1</code>è½¬å‘è¯¥å­—æ®µæŒ‡å®šçš„åè®®ã€‚<code>Connection</code>å­—æ®µè¡¨ç¤ºæµè§ˆå™¨é€šçŸ¥æœåŠ¡å™¨ï¼Œå¦‚æœå¯ä»¥çš„è¯ï¼Œå°±å‡çº§åˆ° WebSocket åè®®ã€‚<code>Origin</code>å­—æ®µç”¨äºæä¾›è¯·æ±‚å‘å‡ºçš„åŸŸåï¼Œä¾›æœåŠ¡å™¨éªŒè¯æ˜¯å¦è®¸å¯çš„èŒƒå›´å†…ï¼ˆæœåŠ¡å™¨ä¹Ÿå¯ä»¥ä¸éªŒè¯ï¼‰ã€‚<code>Sec-WebSocket-Key</code>åˆ™æ˜¯ç”¨äºæ¡æ‰‹åè®®çš„å¯†é’¥ï¼Œæ˜¯ Base64 ç¼–ç çš„16å­—èŠ‚éšæœºå­—ç¬¦ä¸²ã€‚</p><p>æœåŠ¡å™¨çš„ WebSocket å›åº”å¦‚ä¸‹ã€‚</p><div class="language-http line-numbers-mode" data-ext="http"><pre class="language-http"><code><span class="token response-status"><span class="token http-version property">HTTP/1.1</span> <span class="token status-code number">101</span> <span class="token reason-phrase string">Switching Protocols</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">Upgrade</span></span>
<span class="token header"><span class="token header-name keyword">Upgrade</span><span class="token punctuation">:</span> <span class="token header-value">websocket</span></span>
<span class="token header"><span class="token header-name keyword">Sec-WebSocket-Accept</span><span class="token punctuation">:</span> <span class="token header-value">fFBooB7FAkLlXgRSz0BT3v4hq5s=</span></span>
<span class="token header"><span class="token header-name keyword">Sec-WebSocket-Origin</span><span class="token punctuation">:</span> <span class="token header-value">null</span></span>
<span class="token header"><span class="token header-name keyword">Sec-WebSocket-Location</span><span class="token punctuation">:</span> <span class="token header-value">ws://example.com/</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä»£ç ä¸­ï¼ŒæœåŠ¡å™¨åŒæ ·ç”¨<code>Connection</code>å­—æ®µé€šçŸ¥æµè§ˆå™¨ï¼Œéœ€è¦æ”¹å˜åè®®ã€‚<code>Sec-WebSocket-Accept</code>å­—æ®µæ˜¯æœåŠ¡å™¨åœ¨æµè§ˆå™¨æä¾›çš„<code>Sec-WebSocket-Key</code>å­—ç¬¦ä¸²åé¢ï¼Œæ·»åŠ  <a href="http://tools.ietf.org/html/rfc6455" target="_blank" rel="noopener noreferrer">RFC6456<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> æ ‡å‡†è§„å®šçš„â€œ258EAFA5-E914-47DA-95CA-C5AB0DC85B11â€å­—ç¬¦ä¸²ï¼Œç„¶åå†å– SHA-1 çš„å“ˆå¸Œå€¼ã€‚æµè§ˆå™¨å°†å¯¹è¿™ä¸ªå€¼è¿›è¡ŒéªŒè¯ï¼Œä»¥è¯æ˜ç¡®å®æ˜¯ç›®æ ‡æœåŠ¡å™¨å›åº”äº† WebSocket è¯·æ±‚ã€‚<code>Sec-WebSocket-Location</code>å­—æ®µè¡¨ç¤ºè¿›è¡Œé€šä¿¡çš„ WebSocket ç½‘å€ã€‚</p><p>å®Œæˆæ¡æ‰‹ä»¥åï¼ŒWebSocket åè®®å°±åœ¨ TCP åè®®ä¹‹ä¸Šï¼Œå¼€å§‹ä¼ é€æ•°æ®ã€‚</p><h3 id="å®¢æˆ·ç«¯çš„ç®€å•ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å®¢æˆ·ç«¯çš„ç®€å•ç¤ºä¾‹" aria-hidden="true">#</a> å®¢æˆ·ç«¯çš„ç®€å•ç¤ºä¾‹</h3><p>WebSocket çš„ç”¨æ³•ç›¸å½“ç®€å•ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç½‘é¡µè„šæœ¬çš„ä¾‹å­ï¼ŒåŸºæœ¬ä¸Šä¸€çœ¼å°±èƒ½æ˜ç™½ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> ws <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">&#39;wss://echo.websocket.org&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ws<span class="token punctuation">.</span><span class="token function-variable function">onopen</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Connection open ...&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ws<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&#39;Hello WebSockets!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

ws<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Received Message: &#39;</span> <span class="token operator">+</span> evt<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ws<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

ws<span class="token punctuation">.</span><span class="token function-variable function">onclose</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Connection closed.&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®¢æˆ·ç«¯-api-1" tabindex="-1"><a class="header-anchor" href="#å®¢æˆ·ç«¯-api-1" aria-hidden="true">#</a> å®¢æˆ·ç«¯ API</h3><p>æµè§ˆå™¨å¯¹ WebSocket åè®®çš„å¤„ç†ï¼Œæ— éå°±æ˜¯ä¸‰ä»¶äº‹ã€‚</p><ul><li>å»ºç«‹è¿æ¥å’Œæ–­å¼€è¿æ¥</li><li>å‘é€æ•°æ®å’Œæ¥æ”¶æ•°æ®</li><li>å¤„ç†é”™è¯¯</li></ul><h4 id="æ„é€ å‡½æ•°-websocket" tabindex="-1"><a class="header-anchor" href="#æ„é€ å‡½æ•°-websocket" aria-hidden="true">#</a> æ„é€ å‡½æ•° WebSocket</h4><p><code>WebSocket</code>å¯¹è±¡ä½œä¸ºä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œç”¨äºæ–°å»º<code>WebSocket</code>å®ä¾‹ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> ws <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">&#39;ws://localhost:8080&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ‰§è¡Œä¸Šé¢è¯­å¥ä¹‹åï¼Œå®¢æˆ·ç«¯å°±ä¼šä¸æœåŠ¡å™¨è¿›è¡Œè¿æ¥ã€‚</p><h4 id="websocket-readystate" tabindex="-1"><a class="header-anchor" href="#websocket-readystate" aria-hidden="true">#</a> webSocket.readyState</h4><p><code>readyState</code>å±æ€§è¿”å›å®ä¾‹å¯¹è±¡çš„å½“å‰çŠ¶æ€ï¼Œå…±æœ‰å››ç§ã€‚</p><ul><li>CONNECTINGï¼šå€¼ä¸º0ï¼Œè¡¨ç¤ºæ­£åœ¨è¿æ¥ã€‚</li><li>OPENï¼šå€¼ä¸º1ï¼Œè¡¨ç¤ºè¿æ¥æˆåŠŸï¼Œå¯ä»¥é€šä¿¡äº†ã€‚</li><li>CLOSINGï¼šå€¼ä¸º2ï¼Œè¡¨ç¤ºè¿æ¥æ­£åœ¨å…³é—­ã€‚</li><li>CLOSEDï¼šå€¼ä¸º3ï¼Œè¡¨ç¤ºè¿æ¥å·²ç»å…³é—­ï¼Œæˆ–è€…æ‰“å¼€è¿æ¥å¤±è´¥ã€‚</li></ul><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">switch</span> <span class="token punctuation">(</span>ws<span class="token punctuation">.</span>readyState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> WebSocket<span class="token punctuation">.</span><span class="token constant">CONNECTING</span><span class="token operator">:</span>
        <span class="token comment">// do something</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> WebSocket<span class="token punctuation">.</span><span class="token constant">OPEN</span><span class="token operator">:</span>
        <span class="token comment">// do something</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> WebSocket<span class="token punctuation">.</span><span class="token constant">CLOSING</span><span class="token operator">:</span>
        <span class="token comment">// do something</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> WebSocket<span class="token punctuation">.</span><span class="token constant">CLOSED</span><span class="token operator">:</span>
        <span class="token comment">// do something</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
        <span class="token comment">// this never happens</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="websocket-onopen" tabindex="-1"><a class="header-anchor" href="#websocket-onopen" aria-hidden="true">#</a> webSocket.onopen</h4><p>å®ä¾‹å¯¹è±¡çš„<code>onopen</code>å±æ€§ï¼Œç”¨äºæŒ‡å®šè¿æ¥æˆåŠŸåçš„å›è°ƒå‡½æ•°ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>ws<span class="token punctuation">.</span><span class="token function-variable function">onopen</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ws<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&#39;Hello Server!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœè¦æŒ‡å®šå¤šä¸ªå›è°ƒå‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨<code>addEventListener</code>æ–¹æ³•ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>ws<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;open&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ws<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&#39;Hello Server!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="websocket-onclose" tabindex="-1"><a class="header-anchor" href="#websocket-onclose" aria-hidden="true">#</a> webSocket.onclose</h4><p>å®ä¾‹å¯¹è±¡çš„<code>onclose</code>å±æ€§ï¼Œç”¨äºæŒ‡å®šè¿æ¥å…³é—­åçš„å›è°ƒå‡½æ•°ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>ws<span class="token punctuation">.</span><span class="token function-variable function">onclose</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> code <span class="token operator">=</span> event<span class="token punctuation">.</span>code<span class="token punctuation">;</span>
    <span class="token keyword">var</span> reason <span class="token operator">=</span> event<span class="token punctuation">.</span>reason<span class="token punctuation">;</span>
    <span class="token keyword">var</span> wasClean <span class="token operator">=</span> event<span class="token punctuation">.</span>wasClean<span class="token punctuation">;</span>
    <span class="token comment">// handle close event</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

ws<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;close&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> code <span class="token operator">=</span> event<span class="token punctuation">.</span>code<span class="token punctuation">;</span>
    <span class="token keyword">var</span> reason <span class="token operator">=</span> event<span class="token punctuation">.</span>reason<span class="token punctuation">;</span>
    <span class="token keyword">var</span> wasClean <span class="token operator">=</span> event<span class="token punctuation">.</span>wasClean<span class="token punctuation">;</span>
    <span class="token comment">// handle close event</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="websocket-onmessage" tabindex="-1"><a class="header-anchor" href="#websocket-onmessage" aria-hidden="true">#</a> webSocket.onmessage</h4><p>å®ä¾‹å¯¹è±¡çš„<code>onmessage</code>å±æ€§ï¼Œç”¨äºæŒ‡å®šæ”¶åˆ°æœåŠ¡å™¨æ•°æ®åçš„å›è°ƒå‡½æ•°ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>ws<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> data <span class="token operator">=</span> event<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
    <span class="token comment">// å¤„ç†æ•°æ®</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

ws<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> data <span class="token operator">=</span> event<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
    <span class="token comment">// å¤„ç†æ•°æ®</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼ŒæœåŠ¡å™¨æ•°æ®å¯èƒ½æ˜¯æ–‡æœ¬ï¼Œä¹Ÿå¯èƒ½æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼ˆ<code>blob</code>å¯¹è±¡æˆ–<code>Arraybuffer</code>å¯¹è±¡ï¼‰ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>ws<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>typeOf event<span class="token punctuation">.</span>data <span class="token operator">===</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Received data string&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>data <span class="token keyword">instanceof</span> <span class="token class-name">ArrayBuffer</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> buffer <span class="token operator">=</span> event<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Received arraybuffer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é™¤äº†åŠ¨æ€åˆ¤æ–­æ”¶åˆ°çš„æ•°æ®ç±»å‹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>binaryType</code>å±æ€§ï¼Œæ˜¾å¼æŒ‡å®šæ”¶åˆ°çš„äºŒè¿›åˆ¶æ•°æ®ç±»å‹ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// æ”¶åˆ°çš„æ˜¯ blob æ•°æ®</span>
ws<span class="token punctuation">.</span>binaryType <span class="token operator">=</span> <span class="token string">&quot;blob&quot;</span><span class="token punctuation">;</span>
ws<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>data<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// æ”¶åˆ°çš„æ˜¯ ArrayBuffer æ•°æ®</span>
ws<span class="token punctuation">.</span>binaryType <span class="token operator">=</span> <span class="token string">&quot;arraybuffer&quot;</span><span class="token punctuation">;</span>
ws<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>data<span class="token punctuation">.</span>byteLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="websocket-send" tabindex="-1"><a class="header-anchor" href="#websocket-send" aria-hidden="true">#</a> webSocket.send()</h4><p>å®ä¾‹å¯¹è±¡çš„<code>send()</code>æ–¹æ³•ç”¨äºå‘æœåŠ¡å™¨å‘é€æ•°æ®ã€‚</p><p>å‘é€æ–‡æœ¬çš„ä¾‹å­ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>ws<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&#39;your message&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å‘é€ Blob å¯¹è±¡çš„ä¾‹å­ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> file <span class="token operator">=</span> document
    <span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;input[type=&quot;file&quot;]&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
ws<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å‘é€ ArrayBuffer å¯¹è±¡çš„ä¾‹å­ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// Sending canvas ImageData as ArrayBuffer</span>
<span class="token keyword">var</span> img <span class="token operator">=</span> canvas_context<span class="token punctuation">.</span><span class="token function">getImageData</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">320</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> binary <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>img<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> img<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    binary<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> img<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
ws<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>binary<span class="token punctuation">.</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="websocket-bufferedamount" tabindex="-1"><a class="header-anchor" href="#websocket-bufferedamount" aria-hidden="true">#</a> webSocket.bufferedAmount</h4><p>å®ä¾‹å¯¹è±¡çš„<code>bufferedAmount</code>å±æ€§ï¼Œè¡¨ç¤ºè¿˜æœ‰å¤šå°‘å­—èŠ‚çš„äºŒè¿›åˆ¶æ•°æ®æ²¡æœ‰å‘é€å‡ºå»ã€‚å®ƒå¯ä»¥ç”¨æ¥åˆ¤æ–­å‘é€æ˜¯å¦ç»“æŸã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayBuffer</span><span class="token punctuation">(</span><span class="token number">10000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
socket<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>socket<span class="token punctuation">.</span>bufferedAmount <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å‘é€å®Œæ¯•</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// å‘é€è¿˜æ²¡ç»“æŸ</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="websocket-onerror" tabindex="-1"><a class="header-anchor" href="#websocket-onerror" aria-hidden="true">#</a> webSocket.onerror</h4><p>å®ä¾‹å¯¹è±¡çš„<code>onerror</code>å±æ€§ï¼Œç”¨äºæŒ‡å®šæŠ¥é”™æ—¶çš„å›è°ƒå‡½æ•°ã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>socket<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// handle error event</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

socket<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// handle error event</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="websocket-æœåŠ¡å™¨" tabindex="-1"><a class="header-anchor" href="#websocket-æœåŠ¡å™¨" aria-hidden="true">#</a> WebSocket æœåŠ¡å™¨</h3><p>WebSocket åè®®éœ€è¦æœåŠ¡å™¨æ”¯æŒã€‚å„ç§æœåŠ¡å™¨çš„å®ç°ï¼Œå¯ä»¥æŸ¥çœ‹ç»´åŸºç™¾ç§‘çš„<a href="https://en.wikipedia.org/wiki/Comparison_of_WebSocket_implementations" target="_blank" rel="noopener noreferrer">åˆ—è¡¨<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ã€‚</p><p>å¸¸ç”¨çš„ Node å®ç°æœ‰ä»¥ä¸‹ä¸‰ç§ã€‚</p><ul><li><a href="https://github.com/uWebSockets/uWebSockets" target="_blank" rel="noopener noreferrer">ÂµWebSockets<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="http://socket.io/" target="_blank" rel="noopener noreferrer">Socket.IO<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://github.com/theturtle32/WebSocket-Node" target="_blank" rel="noopener noreferrer">WebSocket-Node<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><p>å…·ä½“çš„ç”¨æ³•è¯·æŸ¥çœ‹å®ƒä»¬çš„æ–‡æ¡£ï¼Œæœ¬æ•™ç¨‹ä¸è¯¦ç»†ä»‹ç»äº†ã€‚</p><h3 id="å‚è€ƒé“¾æ¥-13" tabindex="-1"><a class="header-anchor" href="#å‚è€ƒé“¾æ¥-13" aria-hidden="true">#</a> å‚è€ƒé“¾æ¥</h3><ul><li>Ryan Stewart, <a href="http://www.adobe.com/devnet/html5/articles/real-time-data-exchange-in-html5-with-websockets.html" target="_blank" rel="noopener noreferrer">Real-time data exchange in HTML5 with WebSockets<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Malte Ubl &amp; Eiji Kitamuraï¼Œ<a href="https://www.html5rocks.com/en/tutorials/websockets/basics/" target="_blank" rel="noopener noreferrer">Introducing WebSockets: Bringing Sockets to the Web<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Jack Lawson, <a href="http://buildnewgames.com/websockets/" target="_blank" rel="noopener noreferrer">WebSockets: A Guide<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Michael W., <a href="http://codular.com/node-web-sockets" target="_blank" rel="noopener noreferrer">Starting with Node and Web Sockets<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Jesse Cravens, <a href="http://tech.pro/tutorial/1167/introduction-to-websockets" target="_blank" rel="noopener noreferrer">Introduction to WebSockets<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Matt West, <a href="http://blog.teamtreehouse.com/an-introduction-to-websockets" target="_blank" rel="noopener noreferrer">An Introduction to WebSockets<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Maciej SopyÅ‚o, <a href="http://net.tutsplus.com/tutorials/javascript-ajax/node-js-better-performance-with-socket-io-and-dot/" target="_blank" rel="noopener noreferrer">Node.js: Better Performance With Socket.IO and doT<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Jos Dirksen, <a href="http://www.smartjava.org/content/capture-canvas-and-webgl-output-video-using-websockets" target="_blank" rel="noopener noreferrer">Capture Canvas and WebGL output as video using websockets<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Fionn Kellehe, <a href="https://nodesource.com/blog/understanding-socketio" target="_blank" rel="noopener noreferrer">Understanding Socket.IO<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="http://cjihrig.com/blog/how-to-use-websockets/" target="_blank" rel="noopener noreferrer">How to Use WebSockets<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://www.tutorialspoint.com/websockets/websockets_send_receive_messages.htm" target="_blank" rel="noopener noreferrer">WebSockets - Send &amp; Receive Messages<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://gitee.com/lizifan233/mydocs/edit/master/src/codenotes/front_end/WebApi.md" rel="noopener noreferrer" target="_blank" aria-label="åœ¨ã€Giteeã€‘ä¸Šç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ã€Giteeã€‘ä¸Šç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><!----></footer><nav class="page-nav"><a href="/codenotes/front_end/HTML.html" class="nav-link prev" aria-label="HTML"><div class="hint"><span class="arrow left"></span>ä¸Šä¸€é¡µ</div><div class="link"><span class="icon iconfont icon-code"></span>HTML</div></a><a href="/codenotes/front_end/ts.html" class="nav-link next" aria-label="ä¸€æ–‡ææ‡‚TypeScript"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow right"></span></div><div class="link">ä¸€æ–‡ææ‡‚TypeScript<span class="icon iconfont icon-code"></span></div></a></nav><div class="waline-wrapper" darkmode="false" style="display:block;"><div data-waline provider="Waline"><!--v-if--><div class="wl-comment"><!--v-if--><div class="wl-panel"><div class="wl-header item3"><!--[--><div class="wl-header-item"><label for="wl-nick">æ˜µç§°</label><input id="wl-nick" class="wl-input wl-nick" name="nick" type="text" value></div><div class="wl-header-item"><label for="wl-mail">é‚®ç®±</label><input id="wl-mail" class="wl-input wl-mail" name="mail" type="email" value></div><div class="wl-header-item"><label for="wl-link">ç½‘å€</label><input id="wl-link" class="wl-input wl-link" name="link" type="text" value></div><!--]--></div><textarea id="wl-edit" class="wl-editor" placeholder="è¯·ç•™è¨€ã€‚(å¡«å†™é‚®ç®±å¯åœ¨è¢«å›å¤æ—¶æ”¶åˆ°é‚®ä»¶æé†’)"></textarea><div class="wl-preview" style="display:none;"><hr><h4>é¢„è§ˆ:</h4><!-- eslint-disable-next-line vue/no-v-html --><div class="wl-content"></div></div><div class="wl-footer"><div class="wl-actions"><a href="https://guides.github.com/features/mastering-markdown/" title="Markdown Guide" aria-label="Markdown is supported" class="wl-action" target="_blank" rel="noreferrer"><svg width="16" height="16" ariaHidden="true"><path d="M14.85 3H1.15C.52 3 0 3.52 0 4.15v7.69C0 12.48.52 13 1.15 13h13.69c.64 0 1.15-.52 1.15-1.15v-7.7C16 3.52 15.48 3 14.85 3zM9 11H7V8L5.5 9.92 4 8v3H2V5h2l1.5 2L7 5h2v6zm2.99.5L9.5 8H11V5h2v3h1.5l-2.51 3.5z" fill="currentColor"></path></svg></a><button class="wl-action" title="è¡¨æƒ…" style="display:none;"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M563.2 463.3 677 540c1.7 1.2 3.7 1.8 5.8 1.8.7 0 1.4-.1 2-.2 2.7-.5 5.1-2.1 6.6-4.4l25.3-37.8c1.5-2.3 2.1-5.1 1.6-7.8s-2.1-5.1-4.4-6.6l-73.6-49.1 73.6-49.1c2.3-1.5 3.9-3.9 4.4-6.6.5-2.7 0-5.5-1.6-7.8l-25.3-37.8a10.1 10.1 0 0 0-6.6-4.4c-.7-.1-1.3-.2-2-.2-2.1 0-4.1.6-5.8 1.8l-113.8 76.6c-9.2 6.2-14.7 16.4-14.7 27.5.1 11 5.5 21.3 14.7 27.4zM387 348.8h-45.5c-5.7 0-10.4 4.7-10.4 10.4v153.3c0 5.7 4.7 10.4 10.4 10.4H387c5.7 0 10.4-4.7 10.4-10.4V359.2c0-5.7-4.7-10.4-10.4-10.4zm333.8 241.3-41-20a10.3 10.3 0 0 0-8.1-.5c-2.6.9-4.8 2.9-5.9 5.4-30.1 64.9-93.1 109.1-164.4 115.2-5.7.5-9.9 5.5-9.5 11.2l3.9 45.5c.5 5.3 5 9.5 10.3 9.5h.9c94.8-8 178.5-66.5 218.6-152.7 2.4-5 .3-11.2-4.8-13.6zm186-186.1c-11.9-42-30.5-81.4-55.2-117.1-24.1-34.9-53.5-65.6-87.5-91.2-33.9-25.6-71.5-45.5-111.6-59.2-41.2-14-84.1-21.1-127.8-21.1h-1.2c-75.4 0-148.8 21.4-212.5 61.7-63.7 40.3-114.3 97.6-146.5 165.8-32.2 68.1-44.3 143.6-35.1 218.4 9.3 74.8 39.4 145 87.3 203.3.1.2.3.3.4.5l36.2 38.4c1.1 1.2 2.5 2.1 3.9 2.6 73.3 66.7 168.2 103.5 267.5 103.5 73.3 0 145.2-20.3 207.7-58.7 37.3-22.9 70.3-51.5 98.1-85 27.1-32.7 48.7-69.5 64.2-109.1 15.5-39.7 24.4-81.3 26.6-123.8 2.4-43.6-2.5-87-14.5-129zm-60.5 181.1c-8.3 37-22.8 72-43 104-19.7 31.1-44.3 58.6-73.1 81.7-28.8 23.1-61 41-95.7 53.4-35.6 12.7-72.9 19.1-110.9 19.1-82.6 0-161.7-30.6-222.8-86.2l-34.1-35.8c-23.9-29.3-42.4-62.2-55.1-97.7-12.4-34.7-18.8-71-19.2-107.9-.4-36.9 5.4-73.3 17.1-108.2 12-35.8 30-69.2 53.4-99.1 31.7-40.4 71.1-72 117.2-94.1 44.5-21.3 94-32.6 143.4-32.6 49.3 0 97 10.8 141.8 32 34.3 16.3 65.3 38.1 92 64.8 26.1 26 47.5 56 63.6 89.2 16.2 33.2 26.6 68.5 31 105.1 4.6 37.5 2.7 75.3-5.6 112.3z" fill="currentColor"></path></svg></button><button class="wl-action" title="è¡¨æƒ…åŒ…"><svg width="24" height="24" fill="currentcolor" viewBox="0 0 24 24"><path style="transform: translateY(0.5px)" d="M18.968 10.5H15.968V11.484H17.984V12.984H15.968V15H14.468V9H18.968V10.5V10.5ZM8.984 9C9.26533 9 9.49967 9.09367 9.687 9.281C9.87433 9.46833 9.968 9.70267 9.968 9.984V10.5H6.499V13.5H8.468V12H9.968V14.016C9.968 14.2973 9.87433 14.5317 9.687 14.719C9.49967 14.9063 9.26533 15 8.984 15H5.984C5.70267 15 5.46833 14.9063 5.281 14.719C5.09367 14.5317 5 14.2973 5 14.016V9.985C5 9.70367 5.09367 9.46933 5.281 9.282C5.46833 9.09467 5.70267 9.001 5.984 9.001H8.984V9ZM11.468 9H12.968V15H11.468V9V9Z"></path><path d="M18.5 3H5.75C3.6875 3 2 4.6875 2 6.75V18C2 20.0625 3.6875 21.75 5.75 21.75H18.5C20.5625 21.75 22.25 20.0625 22.25 18V6.75C22.25 4.6875 20.5625 3 18.5 3ZM20.75 18C20.75 19.2375 19.7375 20.25 18.5 20.25H5.75C4.5125 20.25 3.5 19.2375 3.5 18V6.75C3.5 5.5125 4.5125 4.5 5.75 4.5H18.5C19.7375 4.5 20.75 5.5125 20.75 6.75V18Z"></path></svg></button><input id="wl-image-upload" class="upload" type="file" accept=".png,.jpg,.jpeg,.webp,.bmp,.gif"><label for="wl-image-upload" class="wl-action" title="ä¸Šä¼ å›¾ç‰‡"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M784 112H240c-88 0-160 72-160 160v480c0 88 72 160 160 160h544c88 0 160-72 160-160V272c0-88-72-160-160-160zm96 640c0 52.8-43.2 96-96 96H240c-52.8 0-96-43.2-96-96V272c0-52.8 43.2-96 96-96h544c52.8 0 96 43.2 96 96v480z" fill="currentColor"></path><path d="M352 480c52.8 0 96-43.2 96-96s-43.2-96-96-96-96 43.2-96 96 43.2 96 96 96zm0-128c17.6 0 32 14.4 32 32s-14.4 32-32 32-32-14.4-32-32 14.4-32 32-32zm462.4 379.2-3.2-3.2-177.6-177.6c-25.6-25.6-65.6-25.6-91.2 0l-80 80-36.8-36.8c-25.6-25.6-65.6-25.6-91.2 0L200 728c-4.8 6.4-8 14.4-8 24 0 17.6 14.4 32 32 32 9.6 0 16-3.2 22.4-9.6L380.8 640l134.4 134.4c6.4 6.4 14.4 9.6 24 9.6 17.6 0 32-14.4 32-32 0-9.6-4.8-17.6-9.6-24l-52.8-52.8 80-80L769.6 776c6.4 4.8 12.8 8 20.8 8 17.6 0 32-14.4 32-32 0-8-3.2-16-8-20.8z" fill="currentColor"></path></svg></label><button class="wl-action" title="é¢„è§ˆ"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M710.816 654.301c70.323-96.639 61.084-230.578-23.705-314.843-46.098-46.098-107.183-71.109-172.28-71.109-65.008 0-126.092 25.444-172.28 71.109-45.227 46.098-70.756 107.183-70.756 172.106 0 64.923 25.444 126.007 71.194 172.106 46.099 46.098 107.184 71.109 172.28 71.109 51.414 0 100.648-16.212 142.824-47.404l126.53 126.006c7.058 7.06 16.297 10.979 26.406 10.979 10.105 0 19.343-3.919 26.402-10.979 14.467-14.467 14.467-38.172 0-52.723L710.816 654.301zm-315.107-23.265c-65.88-65.88-65.88-172.54 0-238.42 32.069-32.07 74.245-49.149 119.471-49.149 45.227 0 87.407 17.603 119.472 49.149 65.88 65.879 65.88 172.539 0 238.42-63.612 63.178-175.242 63.178-238.943 0zm0 0" fill="currentColor"></path><path d="M703.319 121.603H321.03c-109.8 0-199.469 89.146-199.469 199.38v382.034c0 109.796 89.236 199.38 199.469 199.38h207.397c20.653 0 37.384-16.645 37.384-37.299 0-20.649-16.731-37.296-37.384-37.296H321.03c-68.582 0-124.352-55.77-124.352-124.267V321.421c0-68.496 55.77-124.267 124.352-124.267h382.289c68.582 0 124.352 55.771 124.352 124.267V524.72c0 20.654 16.736 37.299 37.385 37.299 20.654 0 37.384-16.645 37.384-37.299V320.549c-.085-109.8-89.321-198.946-199.121-198.946zm0 0" fill="currentColor"></path></svg></button></div><div class="wl-info"><div class="wl-text-number">0 <!--v-if--> Â å­—</div><button class="wl-btn">ç™»å½•</button><button class="wl-btn primary" title="Cmd|Ctrl + Enter"><!--[-->æäº¤<!--]--></button></div><div class="wl-gif-popup"><input type="text" placeholder="æœç´¢è¡¨æƒ…åŒ…"><div class="wl-gallery" style="gap:6px;"><!--[--><!--]--></div><div class="wl-loading"><svg width="30" height="30" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><circle cx="50" cy="50" fill="none" stroke="currentColor" strokeWidth="4" r="40" stroke-dasharray="85 30"><animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="1s" values="0 50 50;360 50 50" keyTimes="0;1"></animateTransform></circle></svg></div></div><div class="wl-emoji-popup"><!--[--><!--]--><!--v-if--></div></div></div><!--v-if--></div><div class="wl-meta-head"><div class="wl-count"><!--v-if--> è¯„è®º</div><ul class="wl-sort"><!--[--><li class="active">æŒ‰æ­£åº</li><li class="">æŒ‰å€’åº</li><li class="">æŒ‰çƒ­åº¦</li><!--]--></ul></div><div class="wl-cards"><!--[--><!--]--></div><!--[--><div class="wl-loading"><svg width="30" height="30" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><circle cx="50" cy="50" fill="none" stroke="currentColor" strokeWidth="4" r="40" stroke-dasharray="85 30"><animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="1s" values="0 50 50;360 50 50" keyTimes="0;1"></animateTransform></circle></svg></div><!--]--><!-- Copyright Information --><div class="wl-power"> Powered by <a href="https://github.com/walinejs/waline" target="_blank" rel="noreferrer"> Waline </a> v2.14.1</div></div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">å°uã®å­¦ä¹ ç¬”è®°</div><div class="copyright">Copyright Â© 2023 Xiaou</div></footer><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app.c5b3201b.js" defer></script>
  </body>
</html>
